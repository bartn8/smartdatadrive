/*

 This is a generated file. DO NOT EDIT.

 Copyright (C) 2010-2015 KO GmbH <copyright@kogmbh.com>

 @licstart
 This file is the compiled version of the WebODF library.

 WebODF is free software: you can redistribute it and/or modify it
 under the terms of the GNU Affero General Public License (GNU AGPL)
 as published by the Free Software Foundation, either version 3 of
 the License, or (at your option) any later version.

 WebODF is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU Affero General Public License for more details.

 You should have received a copy of the GNU Affero General Public License
 along with WebODF.  If not, see <http://www.gnu.org/licenses/>.
 @licend

 @source: http://www.webodf.org/
 @source: https://github.com/kogmbh/WebODF/
*/
var webodf_version="0.5.10-10-g788820e";function Runtime(){}Runtime.prototype.BrowserRuntime$getVariable=function(g){};Runtime.prototype.BrowserRuntime$toJson=function(g){};Runtime.prototype.BrowserRuntime$fromJson=function(g){};Runtime.prototype.byteArrayFromString=function(g,h){};Runtime.prototype.BrowserRuntime$byteArrayToString=function(g,h){};Runtime.prototype.BrowserRuntime$read=function(g,h,c,b){};Runtime.prototype.BrowserRuntime$readFile=function(g,h,c){};
Runtime.prototype.BrowserRuntime$readFileSync=function(g,h){};Runtime.prototype.BrowserRuntime$loadXML=function(g,h){};Runtime.prototype.BrowserRuntime$writeFile=function(g,h,c){};Runtime.prototype.deleteFile=function(g,h){};Runtime.prototype.log=function(g,h){};Runtime.prototype.BrowserRuntime$setTimeout=function(g,h){};Runtime.prototype.BrowserRuntime$clearTimeout=function(g){};Runtime.prototype.libraryPaths=function(){};Runtime.prototype.currentDirectory=function(){};
Runtime.prototype.setCurrentDirectory=function(g){};Runtime.prototype.type=function(){};Runtime.prototype.BrowserRuntime$getDOMImplementation=function(){};Runtime.prototype.parseXML=function(g){};Runtime.prototype.BrowserRuntime$exit=function(g){};Runtime.prototype.getWindow=function(){};Runtime.prototype.BrowserRuntime$requestAnimationFrame=function(g){};Runtime.prototype.BrowserRuntime$cancelAnimationFrame=function(g){};Runtime.prototype.BrowserRuntime$assert=function(g,h){};
var IS_COMPILED_CODE=!0;
Runtime.function__this_Runtime____$byteArrayToString=function(g,h){function c(b){var c="",p,q=b.length;for(p=0;p<q;p+=1)c+=String.fromCharCode(b[p]&255);return c}function b(b){var c="",p,q=b.length,e=[],l,a,d,n;for(p=3<=q&&239===b[0]&&187===b[1]&&191===b[2]?3:0;p<q;p+=1)l=b[p],128>l?e.push(l):(p+=1,a=b[p],194<=l&&224>l?e.push((l&31)<<6|a&63):(p+=1,d=b[p],224<=l&&240>l?e.push((l&15)<<12|(a&63)<<6|d&63):(p+=1,n=b[p],240<=l&&245>l&&(l=(l&7)<<18|(a&63)<<12|(d&63)<<6|n&63,l-=65536,e.push((l>>10)+55296,
(l&1023)+56320))))),1E3<=e.length&&(c+=String.fromCharCode.apply(null,e),e.length=0);return c+String.fromCharCode.apply(null,e)}var f;"utf8"===h?f=b(g):("binary"!==h&&this.log("Unsupported encoding: "+h),f=c(g));return f};Runtime.function__this_Runtime____$getVariable=function(g){try{return eval(g)}catch(h){}};Runtime.function__this_Runtime____$toJson=function(g){return JSON.stringify(g)};Runtime.function__this_Runtime____$fromJson=function(g){return JSON.parse(g)};
Runtime.getFunctionName=function(g){return void 0===g.name?(g=/function\s+(\w+)/.exec(g))&&g[1]:g.name};Runtime.function__this_Runtime____$assert=function(g,h){if(!g)throw this.log("alert","ASSERTION FAILED:\n"+h),Error(h);};
function BrowserRuntime(){function g(b){var e=b.length,l,a,d=0;for(l=0;l<e;l+=1)a=b.charCodeAt(l),d+=1+(128<a)+(2048<a),55040<a&&57344>a&&(d+=1,l+=1);return d}function h(b,e,l){var a=b.length,d,n;e=new Uint8Array(new ArrayBuffer(e));l?(e[0]=239,e[1]=187,e[2]=191,n=3):n=0;for(l=0;l<a;l+=1)d=b.charCodeAt(l),128>d?(e[n]=d,n+=1):2048>d?(e[n]=192|d>>>6,e[n+1]=128|d&63,n+=2):55040>=d||57344<=d?(e[n]=224|d>>>12&15,e[n+1]=128|d>>>6&63,e[n+2]=128|d&63,n+=3):(l+=1,d=(d-55296<<10|b.charCodeAt(l)-56320)+65536,
e[n]=240|d>>>18&7,e[n+1]=128|d>>>12&63,e[n+2]=128|d>>>6&63,e[n+3]=128|d&63,n+=4);return e}function c(b){var e=b.length,l=new Uint8Array(new ArrayBuffer(e)),a;for(a=0;a<e;a+=1)l[a]=b.charCodeAt(a)&255;return l}function b(b,e){var l;void 0!==e?l=b:e=b;console.log(e);"alert"===l&&alert(e)}function f(b,e,l){if(l.status||l.responseText)if(200!==l.status&&l.status)l={err:l.responseText||l.statusText,data:null};else{if(l.response&&"string"!==typeof l.response)"binary"===e?(l=l.response,l=new Uint8Array(l)):
l=String(l.response);else if("binary"===e)if(null!==l.responseBody&&"undefined"!==String(typeof VBArray)){l=(new VBArray(l.responseBody)).toArray();var a=l.length;e=new Uint8Array(new ArrayBuffer(a));for(b=0;b<a;b+=1)e[b]=l[b];l=e}else{(b=l.getResponseHeader("Content-Length"))&&(b=parseInt(b,10));if(b&&b!==l.responseText.length)a:{a=l.responseText;e=!1;var d=g(a);if("number"===typeof b){if(b!==d&&b!==d+3){a=void 0;break a}e=d+3===b;d=b}a=h(a,d,e)}a||(a=c(l.responseText));l=a}else l=l.responseText;
l={err:null,data:l}}else l={err:"File "+b+" is empty.",data:null};return l}function m(b,e,l){var a=new XMLHttpRequest;a.open("GET",b,l);a.overrideMimeType&&("binary"!==e?a.overrideMimeType("text/plain; charset="+e):a.overrideMimeType("text/plain; charset=x-user-defined"));return a}function r(b,e,l){var a=m(b,e,!0);a.onreadystatechange=function(){var d;4===a.readyState&&(d=f(b,e,a),l(d.err,d.data))};try{a.send(null)}catch(d){l(d.message,null)}}var p=this;this.byteArrayFromString=function(b,e){var l;
"utf8"===e?l=h(b,g(b),!1):("binary"!==e&&p.log("unknown encoding: "+e),l=c(b));return l};this.BrowserRuntime$byteArrayToString=Runtime.function__this_Runtime____$byteArrayToString;this.BrowserRuntime$getVariable=Runtime.function__this_Runtime____$getVariable;this.BrowserRuntime$fromJson=Runtime.function__this_Runtime____$fromJson;this.BrowserRuntime$toJson=Runtime.function__this_Runtime____$toJson;this.BrowserRuntime$readFile=r;this.BrowserRuntime$read=function(b,e,l,a){r(b,"binary",function(d,n){var k=
null;if(n){if("string"===typeof n)throw"This should not happen.";k=n.subarray(e,e+l)}a(d,k)})};this.BrowserRuntime$readFileSync=function(b,e){var l=m(b,e,!1),a;try{l.send(null);a=f(b,e,l);if(a.err)throw a.err;if(null===a.data)throw"No data read from "+b+".";}catch(d){throw d;}return a.data};this.BrowserRuntime$writeFile=function(b,e,l){var a=new XMLHttpRequest,d;a.open("PUT",b,!0);a.onreadystatechange=function(){4===a.readyState&&(a.status||a.responseText?200<=a.status&&300>a.status||!a.status?l(null):
l("Status "+String(a.status)+": "+a.responseText||a.statusText):l("File "+b+" is empty."))};e.buffer&&!a.sendAsBinary?d=e.buffer:d=p.BrowserRuntime$byteArrayToString(e,"binary");try{a.sendAsBinary?a.sendAsBinary(d):a.send(d)}catch(n){p.log("HUH? "+n+" "+e),l(n.message)}};this.deleteFile=function(b,e){var l=new XMLHttpRequest;l.open("DELETE",b,!0);l.onreadystatechange=function(){4===l.readyState&&(200>l.status&&300<=l.status?e(l.responseText):e(null))};l.send(null)};this.BrowserRuntime$loadXML=function(b,
e){var l=new XMLHttpRequest;l.open("GET",b,!0);l.overrideMimeType&&l.overrideMimeType("text/xml");l.onreadystatechange=function(){4===l.readyState&&(l.status||l.responseText?200!==l.status&&l.status?e(l.responseText,null):e(null,l.responseXML):e("File "+b+" is empty.",null))};try{l.send(null)}catch(a){e(a.message,null)}};this.log=b;this.enableAlerts=!0;this.BrowserRuntime$assert=Runtime.function__this_Runtime____$assert;this.BrowserRuntime$setTimeout=function(b,e){return setTimeout(function(){b()},
e)};this.BrowserRuntime$clearTimeout=function(b){clearTimeout(b)};this.libraryPaths=function(){return["lib"]};this.setCurrentDirectory=function(){};this.currentDirectory=function(){return""};this.type=function(){return"BrowserRuntime"};this.BrowserRuntime$getDOMImplementation=function(){return window.document.implementation};this.parseXML=function(b){return(new DOMParser).parseFromString(b,"text/xml")};this.BrowserRuntime$exit=function(c){b("Calling exit with code "+String(c)+", but exit() is not implemented.")};
this.getWindow=function(){return window};this.BrowserRuntime$requestAnimationFrame=function(b){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame;if(e)e.bind(window),b=e(b);else return setTimeout(b,15);return b};this.BrowserRuntime$cancelAnimationFrame=function(b){var e=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame;e?(e.bind(window),e(b)):
clearTimeout(b)}}
function NodeJSRuntime(){function g(b){var e=b.length,l,a=new Uint8Array(new ArrayBuffer(e));for(l=0;l<e;l+=1)a[l]=b[l];return a}function h(c,e,l){function a(a,n){if(a)return l(a,null);if(!n)return l("No data for "+c+".",null);if("string"===typeof n)return l(a,n);l(a,g(n))}c=f.resolve(m,c);"binary"!==e?b.readFile(c,e,a):b.readFile(c,null,a)}var c=this,b=require("fs"),f=require("path"),m="",r,p;this.byteArrayFromString=function(b,e){var l=new Buffer(b,e),a,d=l.length,n=new Uint8Array(new ArrayBuffer(d));for(a=
0;a<d;a+=1)n[a]=l[a];return n};this.BrowserRuntime$byteArrayToString=Runtime.function__this_Runtime____$byteArrayToString;this.BrowserRuntime$getVariable=Runtime.function__this_Runtime____$getVariable;this.BrowserRuntime$fromJson=Runtime.function__this_Runtime____$fromJson;this.BrowserRuntime$toJson=Runtime.function__this_Runtime____$toJson;this.BrowserRuntime$readFile=h;this.BrowserRuntime$loadXML=function(b,e){h(b,"utf-8",function(l,a){if(l)return e(l,null);if(!a)return e("No data for "+b+".",null);
e(null,c.parseXML(a))})};this.BrowserRuntime$writeFile=function(c,e,l){e=new Buffer(e);c=f.resolve(m,c);b.writeFile(c,e,"binary",function(a){l(a||null)})};this.deleteFile=function(c,e){c=f.resolve(m,c);b.unlink(c,e)};this.BrowserRuntime$read=function(c,e,l,a){c=f.resolve(m,c);b.open(c,"r+",666,function(d,n){if(d)a(d,null);else{var k=new Buffer(l);b.read(n,k,0,l,e,function(d){b.close(n);a(d,g(k))})}})};this.BrowserRuntime$readFileSync=function(c,e){var l,a=b.readFileSync(c,"binary"===e?null:e);if(null===
a)throw"File "+c+" could not be read.";"binary"===e?l=g(a):l=a;return l};this.log=function(b,e){var l;void 0!==e?l=b:e=b;"alert"===l&&process.stderr.write("\n!!!!! ALERT !!!!!\n");process.stderr.write(e+"\n");"alert"===l&&process.stderr.write("!!!!! ALERT !!!!!\n")};this.BrowserRuntime$assert=Runtime.function__this_Runtime____$assert;this.BrowserRuntime$setTimeout=function(b,e){return setTimeout(function(){b()},e)};this.BrowserRuntime$clearTimeout=function(b){clearTimeout(b)};this.libraryPaths=function(){return[__dirname]};
this.setCurrentDirectory=function(b){m=b};this.currentDirectory=function(){return m};this.type=function(){return"NodeJSRuntime"};this.BrowserRuntime$getDOMImplementation=function(){return p};this.parseXML=function(b){return r.parseFromString(b,"text/xml")};this.BrowserRuntime$exit=process.exit;this.getWindow=function(){return null};this.BrowserRuntime$requestAnimationFrame=function(b){return setTimeout(b,15)};this.BrowserRuntime$cancelAnimationFrame=function(b){clearTimeout(b)};r=new (require("xmldom").DOMParser);
p=c.parseXML("<a/>").implementation}
function RhinoRuntime(){var g=this,h={},c=h.javax.xml.parsers.DocumentBuilderFactory.newInstance(),b,f,m="";c.setValidating(!1);c.setNamespaceAware(!0);c.setExpandEntityReferences(!1);c.setSchema(null);f=h.org.xml.sax.EntityResolver({resolveEntity:function(b,c){var f=new h.java.io.FileReader(c);return new h.org.xml.sax.InputSource(f)}});b=c.newDocumentBuilder();b.setEntityResolver(f);this.byteArrayFromString=function(b,c){var f,e=b.length,l=new Uint8Array(new ArrayBuffer(e));for(f=0;f<e;f+=1)l[f]=
b.charCodeAt(f)&255;return l};this.BrowserRuntime$byteArrayToString=Runtime.function__this_Runtime____$byteArrayToString;this.BrowserRuntime$getVariable=Runtime.function__this_Runtime____$getVariable;this.BrowserRuntime$fromJson=Runtime.function__this_Runtime____$fromJson;this.BrowserRuntime$toJson=Runtime.function__this_Runtime____$toJson;this.BrowserRuntime$loadXML=function(c,f){var m=new h.java.io.File(c),e=null;try{e=b.parse(m)}catch(l){return print(l),f(l,null)}f(null,e)};this.BrowserRuntime$readFile=
function(b,c,f){m&&(b=m+"/"+b);var e=new h.java.io.File(b),l="binary"===c?"latin1":c;e.isFile()?((b=readFile(b,l))&&"binary"===c&&(b=g.byteArrayFromString(b,"binary")),f(null,b)):f(b+" is not a file.",null)};this.BrowserRuntime$writeFile=function(b,c,f){m&&(b=m+"/"+b);b=new h.java.io.FileOutputStream(b);var e,l=c.length;for(e=0;e<l;e+=1)b.write(c[e]);b.close();f(null)};this.deleteFile=function(b,c){m&&(b=m+"/"+b);var f=new h.java.io.File(b),e=new h.java.io.File(b+Math.random());f.rename(e)?(e.deleteOnExit(),
c(null)):c("Could not delete "+b)};this.BrowserRuntime$read=function(b,c,f,e){m&&(b=m+"/"+b);var l;l=b;var a="binary";(new h.java.io.File(l)).isFile()?("binary"===a&&(a="latin1"),l=readFile(l,a)):l=null;l?e(null,this.byteArrayFromString(l.substring(c,c+f),"binary")):e("Cannot read "+b,null)};this.BrowserRuntime$readFileSync=function(b,c){if(!c)return"";var f=readFile(b,c);if(null===f)throw"File could not be read.";return f};this.log=function(b,c){var f;void 0!==c?f=b:c=b;"alert"===f&&print("\n!!!!! ALERT !!!!!");
print(c);"alert"===f&&print("!!!!! ALERT !!!!!")};this.BrowserRuntime$assert=Runtime.function__this_Runtime____$assert;this.BrowserRuntime$setTimeout=function(b){b();return 0};this.BrowserRuntime$clearTimeout=function(){};this.libraryPaths=function(){return["lib"]};this.setCurrentDirectory=function(b){m=b};this.currentDirectory=function(){return m};this.type=function(){return"RhinoRuntime"};this.BrowserRuntime$getDOMImplementation=function(){return b.getDOMImplementation()};this.parseXML=function(c){c=
new h.java.io.StringReader(c);c=new h.org.xml.sax.InputSource(c);return b.parse(c)};this.BrowserRuntime$exit=quit;this.getWindow=function(){return null};this.BrowserRuntime$requestAnimationFrame=function(b){b();return 0};this.BrowserRuntime$cancelAnimationFrame=function(){}}Runtime.function__this_Runtime____$create=function(){var g;"undefined"!==String(typeof window)?g=new BrowserRuntime:"undefined"!==String(typeof require)?g=new NodeJSRuntime:g=new RhinoRuntime;return g};
var runtime=Runtime.function__this_Runtime____$create(),core={},gui={},xmldom={},odf={},ops={},webodf={};(function(){webodf.Version="undefined"!==String(typeof webodf_version)?webodf_version:"From Source"})();
(function(){function g(b,c,f){var e=b+"/manifest.json",l,a;runtime.log("Loading manifest: "+e);try{l=runtime.BrowserRuntime$readFileSync(e,"utf-8")}catch(d){if(f)runtime.log("No loadable manifest found.");else throw console.log(String(d)),d;return}f=JSON.parse(l);for(a in f)f.hasOwnProperty(a)&&(c[a]={dir:b,deps:f[a]})}function h(b,c,f){function e(n){if(!d[n]&&!f(n)){if(a[n])throw"Circular dependency detected for "+n+".";a[n]=!0;if(!c[n])throw"Missing dependency information for class "+n+".";var k=
c[n],b=k.deps,m,g=b.length;for(m=0;m<g;m+=1)e(b[m]);a[n]=!1;d[n]=!0;l.push(k.dir+"/"+n.replace(".","/")+".js")}}var l=[],a={},d={};b.forEach(e);return l}function c(b){var c,f;for(c=0;c<b.length;c+=1)f=runtime.BrowserRuntime$readFileSync(b[c],"utf-8"),f+="\n//# sourceURL="+b[c],eval(f)}function b(b){b=b.split(".");var c,f=m,e=b.length;for(c=0;c<e;c+=1){if(!f.hasOwnProperty(b[c]))return!1;f=f[b[c]]}return!0}var f,m={core:core,gui:gui,xmldom:xmldom,odf:odf,ops:ops};runtime.loadClasses=function(m,p){if(IS_COMPILED_CODE||
!m.length)return p&&p();var q;if(!(q=f)){q=[];var e=runtime.libraryPaths(),l;runtime.currentDirectory()&&-1===e.indexOf(runtime.currentDirectory())&&g(runtime.currentDirectory(),q,!0);for(l=0;l<e.length;l+=1)g(e[l],q)}f=q;m=h(m,f,b);if(!m.length)return p&&p();if("BrowserRuntime"===runtime.type()&&p){q=m;e=document.currentScript||document.documentElement.lastChild;l=document.createDocumentFragment();var a,d;for(d=0;d<q.length;d+=1)a=document.createElement("script"),a.type="text/javascript",a.charset=
"utf-8",a.async=!1,a.setAttribute("src",q[d]),l.appendChild(a);p&&(a.onload=p);e.parentNode.insertBefore(l,e)}else c(m),p&&p()};runtime.loadClass=function(b,c){runtime.loadClasses([b],c)}})();(function(){var g=function(g){return g};runtime.getTranslator=function(){return g};runtime.setTranslator=function(h){g=h};runtime.tr=function(h){var c=g(h);return c&&"string"===String(typeof c)?c:h}})();
(function(g){function h(c){if(c.length){var b=c[0];runtime.BrowserRuntime$readFile(b,"utf8",function(f,m){function g(){var b=eval(h);b&&runtime.BrowserRuntime$exit(b)}var p="",p=b.lastIndexOf("/"),h=m,p=-1!==p?b.substring(0,p):".";runtime.setCurrentDirectory(p);f?(runtime.log(f),runtime.BrowserRuntime$exit(1)):null===h?(runtime.log("No code found for "+b),runtime.BrowserRuntime$exit(1)):g.apply(null,c)})}}g=g?Array.prototype.slice.call(g):[];"NodeJSRuntime"===runtime.type()?h(process.argv.slice(2)):
"RhinoRuntime"===runtime.type()?h(g):h(g.slice(1))})("undefined"!==String(typeof arguments)&&arguments);(function(){core.Async=function(){return{forEach:function(g,h,c){function b(b){r!==m&&(b?(r=m,c(b)):(r+=1,r===m&&c(null)))}var f,m=g.length,r=0;for(f=0;f<m;f+=1)h(g[f],b)},destroyAll:function(g,h){function c(b,f){if(f)h(f);else if(b<g.length)g[b](function(f){c(b+1,f)});else h()}c(0,void 0)}}}()})();
function makeBase64(){function g(a){var d,n=a.length,k=new Uint8Array(new ArrayBuffer(n));for(d=0;d<n;d+=1)k[d]=a.charCodeAt(d)&255;return k}function h(a){var d,n="",k,b=a.length-2;for(k=0;k<b;k+=3)d=a[k]<<16|a[k+1]<<8|a[k+2],n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>>18],n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>>12&63],n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>>6&63],n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d&
63];k===b+1?(d=a[k]<<4,n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>>6],n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d&63],n+="=="):k===b&&(d=a[k]<<10|a[k+1]<<2,n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>>12],n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>>6&63],n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d&63],n+="=");return n}function c(a){a=a.replace(/[^A-Za-z0-9+\/]+/g,
"");var d=a.length,n=new Uint8Array(new ArrayBuffer(3*d)),b=a.length%4,c=0,l,e;for(l=0;l<d;l+=4)e=(k[a.charAt(l)]||0)<<18|(k[a.charAt(l+1)]||0)<<12|(k[a.charAt(l+2)]||0)<<6|(k[a.charAt(l+3)]||0),n[c]=e>>16,n[c+1]=e>>8&255,n[c+2]=e&255,c+=3;d=3*d-[0,0,2,1][b];return n.subarray(0,d)}function b(a){var d,n,k=a.length,b=0,c=new Uint8Array(new ArrayBuffer(3*k));for(d=0;d<k;d+=1)n=a[d],128>n?c[b++]=n:(2048>n?c[b++]=192|n>>>6:(c[b++]=224|n>>>12&15,c[b++]=128|n>>>6&63),c[b++]=128|n&63);return c.subarray(0,
b)}function f(a){var d,n,k,b,c=a.length,l=new Uint8Array(new ArrayBuffer(c)),e=0;for(d=0;d<c;d+=1)n=a[d],128>n?l[e++]=n:(d+=1,k=a[d],224>n?l[e++]=(n&31)<<6|k&63:(d+=1,b=a[d],l[e++]=(n&15)<<12|(k&63)<<6|b&63));return l.subarray(0,e)}function m(a){return h(g(a))}function r(a){return String.fromCharCode.apply(String,c(a))}function p(a){return f(g(a))}function q(a){a=f(a);for(var d="",n=0;n<a.length;)d+=String.fromCharCode.apply(String,a.subarray(n,n+45E3)),n+=45E3;return d}function e(a,d,n){var k,b,
c,l="";for(c=d;c<n;c+=1)d=a.charCodeAt(c)&255,128>d?l+=String.fromCharCode(d):(c+=1,k=a.charCodeAt(c)&255,224>d?l+=String.fromCharCode((d&31)<<6|k&63):(c+=1,b=a.charCodeAt(c)&255,l+=String.fromCharCode((d&15)<<12|(k&63)<<6|b&63)));return l}function l(a,d){function n(){var c=b+1E5;c>a.length&&(c=a.length);k+=e(a,b,c);b=c;c=b===a.length;d(k,c)&&!c&&runtime.BrowserRuntime$setTimeout(n,0)}var k="",b=0;1E5>a.length?d(e(a,0,a.length),!0):("string"!==typeof a&&(a=a.slice()),n())}function a(a){return b(g(a))}
function d(a){return String.fromCharCode.apply(String,b(a))}function n(a){return String.fromCharCode.apply(String,b(g(a)))}var k=function(a){var d={},n,k;n=0;for(k=a.length;n<k;n+=1)d[a.charAt(n)]=n;return d}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),y,u,z=runtime.getWindow(),x,w;z&&z.btoa?(x=z.btoa,y=function(a){return x(n(a))}):(x=m,y=function(d){return h(a(d))});z&&z.atob?(w=z.atob,u=function(a){a=w(a);return e(a,0,a.length)}):(w=r,u=function(a){return q(c(a))});core.Base64=
function(){this.convertByteArrayToBase64=this.convertUTF8ArrayToBase64=h;this.convertBase64ToByteArray=this.convertBase64ToUTF8Array=c;this.convertUTF16ArrayToByteArray=this.convertUTF16ArrayToUTF8Array=b;this.convertByteArrayToUTF16Array=this.convertUTF8ArrayToUTF16Array=f;this.convertUTF8StringToBase64=m;this.convertBase64ToUTF8String=r;this.convertUTF8StringToUTF16Array=p;this.convertByteArrayToUTF16String=this.convertUTF8ArrayToUTF16String=q;this.convertUTF8StringToUTF16String=l;this.convertUTF16StringToByteArray=
this.convertUTF16StringToUTF8Array=a;this.convertUTF16ArrayToUTF8String=d;this.convertUTF16StringToUTF8String=n;this.convertUTF16StringToBase64=y;this.convertBase64ToUTF16String=u;this.fromBase64=r;this.toBase64=m;this.core_Base64$atob=w;this.core_Base64$btoa=x;this.utob=n;this.btou=l;this.encode=y;this.core_Base64$encodeURI=function(a){return y(a).replace(/[+\/]/g,function(a){return"+"===a?"-":"_"}).replace(/\\=+$/,"")};this.decode=function(a){return u(a.replace(/[\-_]/g,function(a){return"-"===
a?"+":"/"}))};return this};return core.Base64}core.Base64=makeBase64();core.CSSUnits=function(){var g=this,h={"in":1,cm:2.54,mm:25.4,pt:72,pc:12,px:96};this.convert=function(c,b,f){return c*h[f]/h[b]};this.convertMeasure=function(c,b){var f,m;c&&b&&(f=parseFloat(c),m=c.replace(f.toString(),""),f=g.convert(f,m,b));return f};this.getUnits=function(c){return c.substr(c.length-2,c.length)}};
(function(){function g(){var b,f,m,g,h,q,e,l,a;c||(f=(b=runtime.getWindow())&&b.document,q=f.documentElement,e=f.body,c={rangeBCRIgnoresElementBCR:!1,unscaledRangeClientRects:!1,elementBCRIgnoresBodyScroll:!1},f&&(g=f.createElement("div"),g.style.position="absolute",g.style.left="-99999px",g.style.transform="scale(2)",g.style["-webkit-transform"]="scale(2)",h=f.createElement("div"),g.appendChild(h),e.appendChild(g),b=f.createRange(),b.selectNode(h),c.rangeBCRIgnoresElementBCR=!b.getClientRects().length,
h.appendChild(f.createTextNode("Rect transform test")),f=h.getBoundingClientRect(),m=b.getBoundingClientRect(),c.unscaledRangeClientRects=2<Math.abs(f.height-m.height),g.style.transform="",g.style["-webkit-transform"]="",f=q.style.overflow,m=e.style.overflow,l=e.style.height,a=e.scrollTop,q.style.overflow="visible",e.style.overflow="visible",e.style.height="200%",e.scrollTop=e.scrollHeight,c.elementBCRIgnoresBodyScroll=b.getBoundingClientRect().top!==h.getBoundingClientRect().top,e.scrollTop=a,e.style.height=
l,e.style.overflow=m,q.style.overflow=f,b.detach(),e.removeChild(g),b=Object.keys(c).map(function(a){return a+":"+String(c[a])}).join(", "),runtime.log("Detected browser quirks - "+b)));return c}function h(b,c,m){for(b=b?b.firstElementChild:null;b;){if(b.localName===m&&b.namespaceURI===c)return b;b=b.nextElementSibling}return null}var c;core.DomUtilsImpl=function(){function b(a,d){for(var b=0,c;a.parentNode!==d;)runtime.BrowserRuntime$assert(!!a.parentNode,"parent is null"),a=a.parentNode;for(c=d.firstChild;c!==
a;)b+=1,c=c.nextSibling;return b}function c(a,d){return 0>=a.compareBoundaryPoints(Range.START_TO_START,d)&&0<=a.compareBoundaryPoints(Range.END_TO_END,d)}function m(a,d){return 0>=a.compareBoundaryPoints(Range.END_TO_START,d)&&0<=a.compareBoundaryPoints(Range.START_TO_END,d)}function r(a,d){var b=null;a.nodeType===Node.TEXT_NODE&&(a.length?(d.nodeType===Node.TEXT_NODE&&(a.appendData(d.data),d.parentNode.removeChild(d)),b=a):(a.parentNode.removeChild(a),d.nodeType===Node.TEXT_NODE&&(b=d)));return b}
function p(a){for(var d=a.parentNode;a.firstChild;)d.insertBefore(a.firstChild,a);d.removeChild(a);return d}function q(a,d){var b=a.parentNode,c=a.firstChild,l=d(a),e;if(l===NodeFilter.FILTER_SKIP)return b;for(;c;)e=c.nextSibling,q(c,d),c=e;b&&l===NodeFilter.FILTER_REJECT&&p(a);return b}function e(a,d){return a===d||!!(a.compareDocumentPosition(d)&Node.DOCUMENT_POSITION_CONTAINED_BY)}function l(a,d){return g().unscaledRangeClientRects?a:a/d}function a(d,b,c){Object.keys(b).forEach(function(l){var e=
l.split(":"),f=e[1],m=c(e[0]),e=b[l],g=typeof e;"object"===g?Object.keys(e).length&&(l=m?d.getElementsByTagNameNS(m,f)[0]||d.ownerDocument.createElementNS(m,l):d.getElementsByTagName(f)[0]||d.ownerDocument.createElement(l),d.appendChild(l),a(l,e,c)):m&&(runtime.BrowserRuntime$assert("number"===g||"string"===g,"attempting to map unsupported type '"+g+"' (key: "+l+")"),d.setAttributeNS(m,l,String(e)))})}var d=null;this.splitBoundaries=function(a){var d,c=[],l,e,f;if(a.startContainer.nodeType===Node.TEXT_NODE||
a.endContainer.nodeType===Node.TEXT_NODE){l=a.endContainer;e=a.endContainer.nodeType!==Node.TEXT_NODE?a.endOffset===a.endContainer.childNodes.length:!1;f=a.endOffset;d=a.endContainer;if(f<d.childNodes.length)for(d=d.childNodes.item(f),f=0;d.firstChild;)d=d.firstChild;else for(;d.lastChild;)d=d.lastChild,f=d.nodeType===Node.TEXT_NODE?d.textContent.length:d.childNodes.length;d===l&&(l=null);a.setEnd(d,f);f=a.endContainer;a.endOffset&&f.nodeType===Node.TEXT_NODE&&(d=f,a.endOffset!==d.length&&(c.push(d.splitText(a.endOffset)),
c.push(d)));f=a.startContainer;a.startOffset&&f.nodeType===Node.TEXT_NODE&&(d=f,a.startOffset!==d.length&&(f=d.splitText(a.startOffset),c.push(d),c.push(f),a.setStart(f,0)));if(l){for(f=a.endContainer;f.parentNode&&f.parentNode!==l;)f=f.parentNode;e=e?l.childNodes.length:b(f,l);a.setEnd(l,e)}}return c};this.containsRange=c;this.rangesIntersect=m;this.rangeIntersection=function(a,d){var b;m(a,d)&&(b=a.cloneRange(),-1===a.compareBoundaryPoints(Range.START_TO_START,d)&&b.setStart(d.startContainer,d.startOffset),
1===a.compareBoundaryPoints(Range.END_TO_END,d)&&b.setEnd(d.endContainer,d.endOffset));return b};this.getNodesInRange=function(a,d,b){var c=[],l=a.commonAncestorContainer,l=l.nodeType===Node.TEXT_NODE?l.parentNode:l;b=a.startContainer.ownerDocument.createTreeWalker(l,b,d,!1);var e,f;a.endContainer.childNodes[a.endOffset-1]?(e=a.endContainer.childNodes[a.endOffset-1],f=Node.DOCUMENT_POSITION_PRECEDING|Node.DOCUMENT_POSITION_CONTAINED_BY):(e=a.endContainer,f=Node.DOCUMENT_POSITION_PRECEDING);if(a.startContainer.childNodes[a.startOffset])a=
a.startContainer.childNodes[a.startOffset],b.currentNode=a;else{var m=a.startContainer;a.startOffset===(m.nodeType===Node.TEXT_NODE?m.length:m.childNodes.length)?(a=a.startContainer,b.currentNode=a,b.lastChild(),a=b.nextNode()):(a=a.startContainer,b.currentNode=a)}if(a){a=b.currentNode;if(a!==l)for(a=a.parentNode;a&&a!==l;)d(a)===NodeFilter.FILTER_REJECT&&(b.currentNode=a),a=a.parentNode;a=b.currentNode;switch(d(a)){case NodeFilter.FILTER_REJECT:for(a=b.nextSibling();!a&&b.parentNode();)a=b.nextSibling();
break;case NodeFilter.FILTER_SKIP:a=b.nextNode()}for(;a&&(!(d=e.compareDocumentPosition(a))||d&f);)c.push(a),a=b.nextNode()}return c};this.normalizeTextNodes=function(a){a&&a.nextSibling&&(a=r(a,a.nextSibling));a&&a.previousSibling&&r(a.previousSibling,a)};this.rangeContainsNode=function(a,d){var b=d.ownerDocument.createRange(),l=d.ownerDocument.createRange(),e;b.setStart(a.startContainer,a.startOffset);b.setEnd(a.endContainer,a.endOffset);l.selectNodeContents(d);e=c(b,l);b.detach();l.detach();return e};
this.mergeIntoParent=p;this.removeUnwantedNodes=q;this.removeAllChildNodes=function(a){for(;a.firstChild;)a.removeChild(a.firstChild)};this.core_DomUtilsImpl$getElementsByTagNameNS=function(a,d,b){var c=[];a=a.getElementsByTagNameNS(d,b);c.length=b=a.length;for(d=0;d<b;d+=1)c[d]=a.item(d);return c};this.core_DomUtilsImpl$getElementsByTagName=function(a,d){var b=[],c,l,e;c=a.getElementsByTagName(d);b.length=e=c.length;for(l=0;l<e;l+=1)b[l]=c.item(l);return b};this.core_DomUtilsImpl$containsNode=function(a,
d){return a===d||a.contains(d)};this.comparePoints=function(a,d,c,l){if(a===c)return l-d;var e=a.compareDocumentPosition(c);2===e?e=-1:4===e?e=1:10===e?(d=b(a,c),e=d<l?1:-1):(l=b(c,a),e=l<d?-1:1);return e};this.adaptRangeDifferenceToZoomLevel=l;this.translateRect=function(a,d,b){return{top:l(a.top-d.top,b),left:l(a.left-d.left,b),bottom:l(a.bottom-d.top,b),right:l(a.right-d.left,b),width:l(a.width,b),height:l(a.height,b)}};this.core_DomUtilsImpl$getBoundingClientRect=function(a){var b=a.ownerDocument,
c=g(),l=b.body;if((!1===c.unscaledRangeClientRects||c.rangeBCRIgnoresElementBCR)&&a.nodeType===Node.ELEMENT_NODE)return a=a.getBoundingClientRect(),c.elementBCRIgnoresBodyScroll?{left:a.left+l.scrollLeft,right:a.right+l.scrollLeft,top:a.top+l.scrollTop,bottom:a.bottom+l.scrollTop,width:a.width,height:a.height}:a;var e;d?e=d:d=e=b.createRange();c=e;c.selectNode(a);return c.getBoundingClientRect()};this.mapKeyValObjOntoNode=function(a,d,b){Object.keys(d).forEach(function(c){var l=c.split(":"),e=l[1],
l=b(l[0]),f=d[c];l?(e=a.getElementsByTagNameNS(l,e)[0],e||(e=a.ownerDocument.createElementNS(l,c),a.appendChild(e)),e.textContent=f):runtime.log("Key ignored: "+c)})};this.removeKeyElementsFromNode=function(a,d,b){d.forEach(function(d){var c=d.split(":"),k=c[1];(c=b(c[0]))?(k=a.getElementsByTagNameNS(c,k)[0])?k.parentNode.removeChild(k):runtime.log("Element for "+d+" not found."):runtime.log("Property Name ignored: "+d)})};this.getKeyValRepresentationOfNode=function(a,d){for(var b={},c=a.firstElementChild,
l;c;){if(l=d(c.namespaceURI))b[l+":"+c.localName]=c.textContent;c=c.nextElementSibling}return b};this.mapObjOntoNode=a;this.cloneEvent=function(a){var d=Object.create(null);Object.keys(a.constructor.prototype).forEach(function(b){d[b]=a[b]});d.prototype=a.constructor.prototype;return d};this.getDirectChild=h;(function(a){var d,b;if(b=runtime.getWindow())if(d=b.navigator.appVersion.toLowerCase(),b=-1===d.indexOf("chrome")&&(-1!==d.indexOf("applewebkit")||-1!==d.indexOf("safari")),d=-1!==d.indexOf("msie")||
-1!==d.indexOf("trident"),b||d)a.core_DomUtilsImpl$containsNode=e})(this)};core.DomUtils=new core.DomUtilsImpl})();
core.Cursor=function(g,h){function c(a){a.parentNode&&(p.push(a.previousSibling),p.push(a.nextSibling),a.parentNode.removeChild(a))}function b(a,d,b){if(d.nodeType===Node.TEXT_NODE){runtime.BrowserRuntime$assert(!!d,"putCursorIntoTextNode: invalid container");var c=d.parentNode;runtime.BrowserRuntime$assert(!!c,"putCursorIntoTextNode: container without parent");runtime.BrowserRuntime$assert(0<=b&&b<=d.length,"putCursorIntoTextNode: offset is out of bounds");b?(b!==d.length&&d.splitText(b),c.insertBefore(a,
d.nextSibling)):c.insertBefore(a,d)}else d.nodeType===Node.ELEMENT_NODE&&d.insertBefore(a,d.childNodes.item(b));p.push(a.previousSibling);p.push(a.nextSibling)}var f=g.createElementNS("urn:webodf:names:cursor","cursor"),m=g.createElementNS("urn:webodf:names:cursor","anchor"),r,p=[],q=g.createRange(),e,l=core.DomUtils;this.core_Cursor$getNode=function(){return f};this.core_Cursor$getAnchorNode=function(){return m.parentNode?m:f};this.core_Cursor$getSelectedRange=function(){e?(q.setStartBefore(f),q.collapse(!0)):
(q.setStartAfter(r?m:f),q.setEndBefore(r?f:m));return q};this.core_Cursor$setSelectedRange=function(a,d){q&&q!==a&&q.detach();q=a;r=!1!==d;(e=a.collapsed)?(c(m),c(f),b(f,a.startContainer,a.startOffset)):(c(m),c(f),b(r?f:m,a.endContainer,a.endOffset),b(r?m:f,a.startContainer,a.startOffset));p.forEach(l.normalizeTextNodes);p.length=0};this.hasForwardSelection=function(){return r};this.core_Cursor$remove=function(){c(f);p.forEach(l.normalizeTextNodes);p.length=0};f.setAttributeNS("urn:webodf:names:cursor",
"memberId",h);m.setAttributeNS("urn:webodf:names:cursor","memberId",h)};core.Destroyable=function(){};core.Destroyable.prototype.destroy=function(g){};core.EventSource=function(){};core.EventSource.prototype.core_EventNotifier$subscribe=function(g,h){};core.EventSource.prototype.unsubscribe=function(g,h){};
core.EventNotifier=function(g){function h(b){runtime.BrowserRuntime$assert(!c.hasOwnProperty(b),'Duplicated event ids: "'+b+'" registered more than once.');c[b]=[]}var c={};this.core_EventNotifier$emit=function(b,f){var m,g;runtime.BrowserRuntime$assert(c.hasOwnProperty(b),'unknown event fired "'+b+'"');g=c[b];for(m=0;m<g.length;m+=1)g[m](f)};this.core_EventNotifier$subscribe=function(b,f){runtime.BrowserRuntime$assert(c.hasOwnProperty(b),'tried to subscribe to unknown event "'+b+'"');c[b].push(f)};
this.unsubscribe=function(b,f){var m;runtime.BrowserRuntime$assert(c.hasOwnProperty(b),'tried to unsubscribe from unknown event "'+b+'"');m=c[b].indexOf(f);runtime.BrowserRuntime$assert(-1!==m,'tried to unsubscribe unknown callback from event "'+b+'"');-1!==m&&c[b].splice(m,1)};this.core_EventNotifier$register=h;g&&g.forEach(h)};
core.ScheduledTask=function(g,h,c){function b(){r&&(c(m),r=!1)}function f(){b();g.apply(void 0,p);p=null}var m,r=!1,p=[],q=!1;this.trigger=function(){runtime.BrowserRuntime$assert(!1===q,"Can't trigger destroyed ScheduledTask instance");p=Array.prototype.slice.call(arguments);r||(r=!0,m=h(f))};this.triggerImmediate=function(){runtime.BrowserRuntime$assert(!1===q,"Can't trigger destroyed ScheduledTask instance");p=Array.prototype.slice.call(arguments);f()};this.processRequests=function(){r&&f()};this.cancel=
b;this.restart=function(){runtime.BrowserRuntime$assert(!1===q,"Can't trigger destroyed ScheduledTask instance");b();r=!0;m=h(f)};this.destroy=function(c){b();q=!0;c()}};
(function(){var g;core.Task={};core.Task.SUPPRESS_MANUAL_PROCESSING=!1;core.Task.processTasks=function(){core.Task.SUPPRESS_MANUAL_PROCESSING||g.performRedraw()};core.Task.createRedrawTask=function(h){return new core.ScheduledTask(h,g.requestRedrawTask,g.cancelRedrawTask)};core.Task.createTimeoutTask=function(g,c){return new core.ScheduledTask(g,function(b){return runtime.BrowserRuntime$setTimeout(b,c)},runtime.BrowserRuntime$clearTimeout)};g=new function(){var g={};this.requestRedrawTask=function(c){var b=
runtime.BrowserRuntime$requestAnimationFrame(function(){c();delete g[b]});g[b]=c;return b};this.performRedraw=function(){Object.keys(g).forEach(function(c){g[c]();runtime.BrowserRuntime$cancelAnimationFrame(parseInt(c,10))});g={}};this.cancelRedrawTask=function(c){runtime.BrowserRuntime$cancelAnimationFrame(c);delete g[c]}}})();
core.EventSubscriptions=function(){function g(b,f,m){b.core_EventNotifier$subscribe(f,m);c.push({eventSource:b,eventid:f,callback:m})}function h(){var m=[];c.forEach(function(b){b.eventSource.unsubscribe(b.eventid,b.callback)});c.length=0;Object.keys(f).forEach(function(b){f[b].forEach(function(b){m.push(b.task.destroy)});delete f[b]});core.Async.destroyAll(m,function(){});b=new core.EventNotifier}var c=[],b=new core.EventNotifier,f={},m=0;this.addSubscription=g;this.addFrameSubscription=function(c,
h,q){var e,l,a,d;f.hasOwnProperty(h)||(f[h]=[]);a=f[h];for(d=0;d<a.length;d+=1)if(a[d].eventSource===c){e=a[d];break}e||(l="s"+m,m+=1,b.core_EventNotifier$register(l),e={frameEventId:l,eventSource:c,task:core.Task.createRedrawTask(function(){b.core_EventNotifier$emit(l,void 0)})},a.push(e),g(c,h,e.task.trigger));b.core_EventNotifier$subscribe(e.frameEventId,q)};this.unsubscribeAll=h;this.destroy=function(b){h();b()}};
core.LazyProperty=function(g){var h,c=!1;this.value=function(){c||(h=g(),c=!0);return h};this.core_LazyProperty$reset=function(){c=!1}};core.LoopWatchDog=function(g,h){var c=Date.now(),b=0;this.core_LoopWatchDog$check=function(){var f;if(g&&(f=Date.now(),f-c>g))throw runtime.log("alert","watchdog timeout"),"timeout!";if(0<h&&(b+=1,b>h))throw runtime.log("alert","watchdog loop overflow"),"loop overflow";}};
core.NodeFilterChain=function(g){var h=NodeFilter.FILTER_REJECT,c=NodeFilter.FILTER_ACCEPT;this.acceptNode=function(b){var f;for(f=0;f<g.length;f+=1)if(g[f].acceptNode(b)===h)return h;return c}};
core.PositionIterator=function(g,h,c,b){function f(){this.acceptNode=function(a){return!a||a.nodeType===n&&!a.length?u:y}}function m(a){this.acceptNode=function(d){return!d||d.nodeType===n&&!d.length?u:a.acceptNode(d)}}function r(){var d=l.currentNode,b=d.nodeType;a=b===n?d.length-1:b===k?1:0}function p(){if(l.previousSibling())r();else{if(!l.parentNode()||l.currentNode===g)return l.firstChild(),!1;a=0}return!0}function q(){var b=l.currentNode,c;c=d(b);if(b!==g)for(b=b.parentNode;b&&b!==g;)d(b)===
u&&(l.currentNode=b,c=u),b=b.parentNode;c===u?(a=l.currentNode.nodeType===n?b.length:1,b=e.nextPosition()):b=c===y?!0:e.nextPosition();b&&runtime.BrowserRuntime$assert(d(l.currentNode)===y,"moveToAcceptedNode did not result in walker being on an accepted node");return b}var e=this,l,a,d,n=Node.TEXT_NODE,k=Node.ELEMENT_NODE,y=NodeFilter.FILTER_ACCEPT,u=NodeFilter.FILTER_REJECT;this.nextPosition=function(){var d=l.currentNode,b=d.nodeType;if(d===g)return!1;if(a||b!==k)if(b===n&&a+1<d.length)a+=1;else if(l.nextSibling())a=
0;else if(l.parentNode())a=1;else return!1;else l.firstChild()||(a=1);return!0};this.previousPosition=function(){var d=!0,b=l.currentNode;a?b.nodeType===n?--a:l.lastChild()?r():b===g?d=!1:a=0:d=p();return d};this.previousNode=p;this.container=function(){var d=l.currentNode,b=d.nodeType;a||b===n||(d=d.parentNode);return d};this.rightNode=function(){var b=l.currentNode,c=b.nodeType;if(c===n&&a===b.length)for(b=b.nextSibling;b&&d(b)!==y;)b=b.nextSibling;else c===k&&1===a&&(b=null);return b};this.core_PositionIterator$leftNode=
function(){var b=l.currentNode;if(!a)for(b=b.previousSibling;b&&d(b)!==y;)b=b.previousSibling;else if(b.nodeType===k)for(b=b.lastChild;b&&d(b)!==y;)b=b.previousSibling;return b};this.getCurrentNode=function(){return l.currentNode};this.unfilteredDomOffset=function(){if(l.currentNode.nodeType===n)return a;for(var d=0,b=l.currentNode,b=1===a?b.lastChild:b.previousSibling;b;)d+=1,b=b.previousSibling;return d};this.getPreviousSibling=function(){var a=l.currentNode,d=l.previousSibling();l.currentNode=
a;return d};this.getNextSibling=function(){var a=l.currentNode,d=l.nextSibling();l.currentNode=a;return d};this.setPositionBeforeElement=function(d){runtime.BrowserRuntime$assert(!!d,"setPositionBeforeElement called without element");l.currentNode=d;a=0;return q()};this.setUnfilteredPosition=function(d,b){runtime.BrowserRuntime$assert(!!d,"PositionIterator.setUnfilteredPosition called without container");l.currentNode=d;d.nodeType===n?(a=b,runtime.BrowserRuntime$assert(b<=d.length,"Error in setPosition: "+
b+" > "+d.length),runtime.BrowserRuntime$assert(0<=b,"Error in setPosition: "+b+" < 0"),b===d.length&&(l.nextSibling()?a=0:l.parentNode()?a=1:runtime.BrowserRuntime$assert(!1,"Error in setUnfilteredPosition: position not valid."))):b<d.childNodes.length?(l.currentNode=d.childNodes.item(b),a=0):a=1;return q()};this.moveToEnd=function(){l.currentNode=g;a=1};this.moveToEndOfNode=function(d){d.nodeType===n?e.setUnfilteredPosition(d,d.length):(l.currentNode=d,a=1)};this.isBeforeNode=function(){return!a};
this.getNodeFilter=function(){return d};(function(){var k;c?k=new m(c):k=new f;d=k.acceptNode;d.acceptNode=d;h=h||NodeFilter.SHOW_ALL;runtime.BrowserRuntime$assert(g.nodeType!==Node.TEXT_NODE,"Internet Explorer doesn't allow tree walker roots to be text nodes");l=g.ownerDocument.createTreeWalker(g,h,d,b);a=0;l.firstChild()||(a=1)})()};core.PositionFilter=function(){};core.PositionFilter.FilterResult={FILTER_ACCEPT:1,FILTER_REJECT:2,FILTER_SKIP:3};core.PositionFilter.prototype.acceptPosition=function(g){};
core.PositionFilterChain=function(){var g=[],h=core.PositionFilter.FilterResult.FILTER_ACCEPT,c=core.PositionFilter.FilterResult.FILTER_REJECT;this.acceptPosition=function(b){var f;for(f=0;f<g.length;f+=1)if(g[f].acceptPosition(b)===c)return c;return h};this.core_PositionFilterChain$addFilter=function(b){g.push(b)}};core.StepDirection={PREVIOUS:1,NEXT:2};
core.StepIterator=function(g,h){function c(){a=null;n=d=void 0}function b(){void 0===n&&(n=g.acceptPosition(h)===e);return n}function f(a,d){c();return h.setUnfilteredPosition(a,d)}function m(){a||(a=h.container());return a}function r(){void 0===d&&(d=h.unfilteredDomOffset());return d}function p(){for(c();h.nextPosition();)if(c(),b())return!0;return!1}function q(){for(c();h.previousPosition();)if(c(),b())return!0;return!1}var e=core.PositionFilter.FilterResult.FILTER_ACCEPT,l=core.StepDirection.NEXT,
a,d,n;this.isStep=b;this.setPosition=f;this.container=m;this.offset=r;this.nextStep=p;this.previousStep=q;this.advanceStep=function(a){return a===l?p():q()};this.roundToClosestStep=function(){var a,d,c=b();c||(a=m(),d=r(),c=q(),c||(f(a,d),c=p()));return c};this.roundToPreviousStep=function(){var a=b();a||(a=q());return a};this.roundToNextStep=function(){var a=b();a||(a=p());return a};this.core_StepIterator$leftNode=function(){return h.core_PositionIterator$leftNode()};this.snapshot=function(){return new core.StepIterator.StepSnapshot(m(),
r())};this.core_StepIterator$restore=function(a){f(a.container,a.offset)}};core.StepIterator.StepSnapshot=function(g,h){this.container=g;this.offset=h};
core.Utils=function(){function g(h,c){if(c&&Array.isArray(c)){h=h||[];if(!Array.isArray(h))throw"Destination is not an array.";h=h.concat(c.map(function(b){return g(null,b)}))}else if(c&&"object"===typeof c){h=h||{};if("object"!==typeof h)throw"Destination is not an object.";Object.keys(c).forEach(function(b){h[b]=g(h[b],c[b])})}else h=c;return h}this.hashString=function(g){var c=0,b,f;b=0;for(f=g.length;b<f;b+=1)c=(c<<5)-c+g.charCodeAt(b),c|=0;return c};this.mergeObjects=function(h,c){Object.keys(c).forEach(function(b){h[b]=
g(h[b],c[b])});return h}};
core.Zip=function(g,h){function c(b,c){var a=p.file(b);a?c(null,a.asUint8Array()):c(b+" not found.",null)}function b(b,l){c(b,function(a,d){if(a||!d)return l(a,null);var b=runtime.BrowserRuntime$byteArrayToString(d,"utf8");l(null,b)})}function f(b,c){try{b(p.generate({type:"uint8array",compression:"STORE"}))}catch(a){c(a.message)}}function m(b,c){f(function(a){runtime.BrowserRuntime$writeFile(b,a,c)},c)}var r=this,p,q=new core.Base64;this.core_Zip$load=c;this.core_Zip$save=function(b,c,a,d){p.file(b,
c,{date:d,compression:a?"DEFLATE":"STORE"})};this.core_Zip$remove=function(b){var c=!!p.file(b);p.remove(b);return c};this.core_Zip$write=function(b){m(g,b)};this.writeAs=m;this.core_Zip$createByteArray=f;this.loadContentXmlAsFragments=function(c,l){b(c,function(a,d){if(a)return l.rootElementReady(a);l.rootElementReady(null,d,!0)})};this.loadAsString=b;this.loadAsDOM=function(c,l){b(c,function(a,d){if(a||null===d)l(a,null);else{var b=(new DOMParser).parseFromString(d,"text/xml");l(null,b)}})};this.loadAsDataURL=
function(b,l,a){c(b,function(d,b){if(d||!b)return a(d,null);var c=0,e;l||(l=80===b[1]&&78===b[2]&&71===b[3]?"image/png":255===b[0]&&216===b[1]&&255===b[2]?"image/jpeg":71===b[0]&&73===b[1]&&70===b[2]?"image/gif":"");for(e="data:"+l+";base64,";c<b.length;)e+=q.convertUTF8ArrayToBase64(b.subarray(c,Math.min(c+45E3,b.length))),c+=45E3;a(null,e)})};this.getEntries=function(){return Object.keys(p.files).map(function(b){return{filename:b,date:p.files[b].date}})};p=new externs.JSZip;h&&runtime.BrowserRuntime$readFile(g,
"binary",function(b,c){"string"===typeof c&&(b="file was read as a string. Should be Uint8Array.");if(!b&&c&&c.length)try{p.load(c,{checkCRC32:!1}),h(null,r)}catch(a){h(a.message,r)}else h("File '"+g+"' cannot be read. Err: "+(b||"[none]"),r)})};core.SimpleClientRect=null;gui.CommonConstraints={EDIT:{ANNOTATIONS:{ONLY_DELETE_OWN:"onlyDeleteOwn"},REVIEW_MODE:"reviewMode"}};
gui.SessionConstraints=function(){function g(b){h.hasOwnProperty(b)||(h[b]=!1,c.core_EventNotifier$register(b))}var h={},c=new core.EventNotifier;this.registerConstraint=g;this.gui_SessionConstraints$subscribe=function(b,f){g(b);c.core_EventNotifier$subscribe(b,f)};this.unsubscribe=function(b,f){c.unsubscribe(b,f)};this.setState=function(b,f){runtime.BrowserRuntime$assert(!0===h.hasOwnProperty(b),"No such constraint");h[b]!==f&&(h[b]=f,c.core_EventNotifier$emit(b,f))};this.getState=function(b){runtime.BrowserRuntime$assert(!0===
h.hasOwnProperty(b),"No such constraint");return h[b]}};gui.BlacklistNamespaceNodeFilter=function(g){var h={},c=NodeFilter.FILTER_REJECT,b=NodeFilter.FILTER_ACCEPT;this.acceptNode=function(f){return!f||h.hasOwnProperty(f.namespaceURI)?c:b};(function(){g.forEach(function(b){h[b]=!0})})()};
odf.Namespaces={namespaceMap:{config:"urn:oasis:names:tc:opendocument:xmlns:config:1.0",db:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",dc:"http://purl.org/dc/elements/1.1/",dr3d:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",draw:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",chart:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",fo:"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0",form:"urn:oasis:names:tc:opendocument:xmlns:form:1.0",math:"http://www.w3.org/1998/Math/MathML",
meta:"urn:oasis:names:tc:opendocument:xmlns:meta:1.0",number:"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0",office:"urn:oasis:names:tc:opendocument:xmlns:office:1.0",presentation:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",style:"urn:oasis:names:tc:opendocument:xmlns:style:1.0",svg:"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0",table:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",text:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",xforms:"http://www.w3.org/2002/xforms",
xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},prefixMap:{},configns:"urn:oasis:names:tc:opendocument:xmlns:config:1.0",dbns:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",dcns:"http://purl.org/dc/elements/1.1/",dr3dns:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",drawns:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",chartns:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",fons:"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0",formns:"urn:oasis:names:tc:opendocument:xmlns:form:1.0",
mathns:"http://www.w3.org/1998/Math/MathML",metans:"urn:oasis:names:tc:opendocument:xmlns:meta:1.0",numberns:"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0",officens:"urn:oasis:names:tc:opendocument:xmlns:office:1.0",presentationns:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",stylens:"urn:oasis:names:tc:opendocument:xmlns:style:1.0",svgns:"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0",tablens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",textns:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",
xformsns:"http://www.w3.org/2002/xforms",xlinkns:"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/XML/1998/namespace"};(function(){var g=odf.Namespaces.namespaceMap,h=odf.Namespaces.prefixMap,c;for(c in g)g.hasOwnProperty(c)&&(h[g[c]]=c)})();odf.Namespaces.forEachPrefix=function(g){var h=odf.Namespaces.namespaceMap,c;for(c in h)h.hasOwnProperty(c)&&g(c,h[c])};
odf.Namespaces.lookupNamespaceURI=function(g){var h=null;odf.Namespaces.namespaceMap.hasOwnProperty(g)&&(h=odf.Namespaces.namespaceMap[g]);return h};odf.Namespaces.lookupPrefix=function(g){var h=odf.Namespaces.prefixMap;return h.hasOwnProperty(g)?h[g]:null};odf.Namespaces.lookupNamespaceURI.lookupNamespaceURI=odf.Namespaces.lookupNamespaceURI;
(function(){odf.OdfSchemaImpl=function(){var g=[["config:config-item","uncategorized"],["form:item","object"],["form:option","uncategorized"],["math:math","field"],["meta:user-defined","uncategorized"],["number:currency-symbol","uncategorized"],["number:embedded-text","uncategorized"],["number:text","uncategorized"],["presentation:date-time-decl","uncategorized"],["presentation:footer-decl","uncategorized"],["presentation:header-decl","uncategorized"],["svg:desc","text"],["svg:title","text"],["table:desc",
"uncategorized"],["table:title","uncategorized"],["text:a","text"],["text:author-initials","field"],["text:author-name","field"],["text:bibliography-mark","field"],["text:bookmark-ref","field"],["text:chapter","field"],["text:character-count","field"],["text:conditional-text","field"],["text:creation-date","field"],["text:creation-time","field"],["text:creator","field"],["text:database-display","field"],["text:database-name","field"],["text:database-row-number","field"],["text:date","field"],["text:dde-connection",
"field"],["text:description","field"],["text:editing-cycles","field"],["text:editing-duration","field"],["text:execute-macro","uncategorized"],["text:expression","uncategorized"],["text:file-name","field"],["text:h","text"],["text:hidden-paragraph","text"],["text:hidden-text","text"],["text:image-count","field"],["text:index-entry-span","uncategorized"],["text:index-title-template","uncategorized"],["text:initial-creator","field"],["text:keywords","field"],["text:linenumbering-separator","style"],
["text:measure","uncategorized"],["text:meta","uncategorized"],["text:meta-field","uncategorized"],["text:modification-date","field"],["text:modification-time","field"],["text:note-citation","field"],["text:note-continuation-notice-backward","style"],["text:note-continuation-notice-forward","style"],["text:note-ref","field"],["text:object-count","field"],["text:p","text"],["text:page-continuation","uncategorized"],["text:page-count","field"],["text:page-number","field"],["text:page-variable-get",
"field"],["text:page-variable-set","field"],["text:paragraph-count","field"],["text:placeholder","field"],["text:print-date","field"],["text:print-time","field"],["text:printed-by","field"],["text:reference-ref","field"],["text:ruby-base","text"],["text:ruby-text","text"],["text:script","text"],["text:sender-city","field"],["text:sender-company","field"],["text:sender-country","field"],["text:sender-email","field"],["text:sender-fax","field"],["text:sender-firstname","field"],["text:sender-initials",
"field"],["text:sender-lastname","field"],["text:sender-phone-private","field"],["text:sender-phone-work","field"],["text:sender-position","field"],["text:sender-postal-code","field"],["text:sender-state-or-province","field"],["text:sender-street","field"],["text:sender-title","field"],["text:sequence","uncategorized"],["text:sequence-ref","uncategorized"],["text:sheet-name","uncategorized"],["text:span","text"],["text:subject","field"],["text:table-count","field"],["text:table-formula","deprecated"],
["text:template-name","uncategorized"],["text:text-input","field"],["text:time","field"],["text:title","field"],["text:user-defined","field"],["text:user-field-get","field"],["text:user-field-input","field"],["text:variable-get","field"],["text:variable-input","field"],["text:variable-set","field"],["text:word-count","field"],["xforms:model","uncategorized"]],h={};this.isTextContainer=function(c,b){return"text"===h[c+":"+b]};this.isField=function(c,b){return"field"===h[c+":"+b]};this.getFields=function(){return g.filter(function(c){return"field"===
c[1]}).map(function(c){return c[0]})};(function(){g.forEach(function(c){var b=c[1],f=c[0].split(":");c=f[0];var f=f[1],m=odf.Namespaces.lookupNamespaceURI(c);m?h[m+":"+f]=b:runtime.log("DEBUG: OdfSchema - unknown prefix '"+c+"'")})})()};odf.OdfSchema=new odf.OdfSchemaImpl})();
odf.OdfUtilsImpl=function(){function g(a){return"image"===(a&&a.localName)&&a.namespaceURI===P}function h(a){return!!a&&a.nodeType===Node.ELEMENT_NODE&&"frame"===a.localName&&a.namespaceURI===P&&"as-char"===a.getAttributeNS(M,"anchor-type")}function c(a){var d;(d="annotation"===(a&&a.localName)&&a.namespaceURI===odf.Namespaces.officens)||(d="div"===(a&&a.localName)&&"annotationWrapper"===a.className);return d}function b(a){return"a"===(a&&a.localName)&&a.namespaceURI===M}function f(a){var d=a&&a.localName;
return("p"===d||"h"===d)&&a.namespaceURI===M}function m(a,d){for(a&&void 0!==d&&!f(a)&&a.childNodes.item(d)&&(a=a.childNodes.item(d));a&&!f(a);)a=a.parentNode;return a}function r(a,d){for(;a&&a!==d;){if(a.namespaceURI===odf.Namespaces.officens&&"annotation"===a.localName)return a;a=a.parentNode}return null}function p(a){return/^[ \t\r\n]+$/.test(a)}function q(a){if(!a||a.nodeType!==Node.ELEMENT_NODE)return!1;var d=a.localName;return fa.isTextContainer(a.namespaceURI,d)||"span"===d&&"webodf-annotationHighlight"===
a.className}function e(a){return a&&a.nodeType===Node.ELEMENT_NODE?fa.isField(a.namespaceURI,a.localName):!1}function l(a){var d=a&&a.localName,b=!1;d&&(a=a.namespaceURI,a===M&&(b="s"===d||"tab"===d||"line-break"===d));return b}function a(a){return l(a)||e(a)||h(a)||c(a)}function d(a){var d=a&&a.localName,b=!1;d&&(a=a.namespaceURI,a===M&&(b="s"===d));return b}function n(a){return-1!==W.indexOf(a.namespaceURI)}function k(a){if(l(a)||e(a))return!1;if(q(a.parentNode)&&a.nodeType===Node.TEXT_NODE)return!a.textContent.length;
for(a=a.firstChild;a;){if(n(a)||!k(a))return!1;a=a.nextSibling}return!0}function y(a){for(;a.firstChild&&q(a);)a=a.firstChild;return a}function u(a){for(;a.lastChild&&q(a);)a=a.lastChild;return a}function z(a){for(;!f(a)&&!a.previousSibling;)a=a.parentNode;return f(a)?null:u(a.previousSibling)}function x(a){for(;!f(a)&&!a.nextSibling;)a=a.parentNode;return f(a)?null:y(a.nextSibling)}function w(b){for(var c=!1;b;)if(b.nodeType===Node.TEXT_NODE){if(b.length)return!p(b.data.substr(b.length-1,1));b=z(b)}else a(b)?
(c=!1===d(b),b=null):b=z(b);return c}function v(d){var b=!1,c;for(d=d&&y(d);d;){c=d.nodeType===Node.TEXT_NODE?d.length:0;if(0<c&&!p(d.data)){b=!0;break}if(a(d)){b=!0;break}d=x(d)}return b}function t(a,d){return p(a.data.substr(d))?!v(x(a)):!1}function D(d,b){var c=d.data,k;if(!p(c[b])||a(d.parentNode))return!1;0<b?p(c[b-1])||(k=!0):w(z(d))&&(k=!0);return!0===k?t(d,b)?!1:!0:!1}function J(a){return(a=/(-?[0-9]*[0-9][0-9]*(\.[0-9]*)?|0+\.[0-9]*[1-9][0-9]*|\.[0-9]*[1-9][0-9]*)((cm)|(mm)|(in)|(pt)|(pc)|(px)|(%))/.exec(a))?
{value:parseFloat(a[1]),unit:a[3]}:null}function A(a){return(a=J(a))&&(0>a.value||"%"===a.unit)?null:a}function L(a){return(a=J(a))&&"%"!==a.unit?null:a}function S(a){switch(a.namespaceURI){case odf.Namespaces.drawns:case odf.Namespaces.svgns:case odf.Namespaces.dr3dns:return!1;case odf.Namespaces.textns:switch(a.localName){case "note-body":case "ruby-text":return!1}break;case odf.Namespaces.officens:switch(a.localName){case "annotation":case "binary-data":case "event-listeners":return!1}break;default:switch(a.localName){case "cursor":case "editinfo":return!1}}return!0}
function K(a){return!(!m(a)||p(a.textContent)&&!D(a,0))}function R(a,d){for(;0<d.length&&!Y.rangeContainsNode(a,d[0]);)d.shift();for(;0<d.length&&!Y.rangeContainsNode(a,d[d.length-1]);)d.pop()}function B(d,b,k){var n;n=Y.getNodesInRange(d,function(d){var b=NodeFilter.FILTER_REJECT;if(l(d.parentNode)||e(d.parentNode)||c(d))b=NodeFilter.FILTER_REJECT;else if(d.nodeType===Node.TEXT_NODE){if(k||K(d))b=NodeFilter.FILTER_ACCEPT}else if(a(d))b=NodeFilter.FILTER_ACCEPT;else if(S(d)||q(d))b=NodeFilter.FILTER_SKIP;
return b},NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);b||R(d,n);return n}function V(a,d,b){for(;a;){if(b(a)){d[0]!==a&&d.unshift(a);break}if(c(a))break;a=a.parentNode}}function U(a,d){var b=a;if(d<b.childNodes.length-1)b=b.childNodes[d+1];else{for(;!b.nextSibling;)b=b.parentNode;b=b.nextSibling}for(;b.firstChild;)b=b.firstChild;return b}var M=odf.Namespaces.textns,P=odf.Namespaces.drawns,N=odf.Namespaces.xlinkns,Y=core.DomUtils,W=[odf.Namespaces.dbns,odf.Namespaces.dcns,odf.Namespaces.dr3dns,odf.Namespaces.drawns,
odf.Namespaces.chartns,odf.Namespaces.formns,odf.Namespaces.numberns,odf.Namespaces.officens,odf.Namespaces.presentationns,odf.Namespaces.stylens,odf.Namespaces.svgns,odf.Namespaces.tablens,odf.Namespaces.textns],fa=odf.OdfSchema;this.isImage=g;this.isCharacterFrame=h;this.isInlineRoot=c;this.isTextSpan=function(a){return"span"===(a&&a.localName)&&a.namespaceURI===M};this.isHyperlink=b;this.getHyperlinkTarget=function(a){return a.getAttributeNS(N,"href")||""};this.isParagraph=f;this.getParagraphElement=
m;this.getParentAnnotation=r;this.isWithinAnnotation=function(a,d){return!!r(a,d)};this.getAnnotationCreator=function(a){return a.getElementsByTagNameNS(odf.Namespaces.dcns,"creator")[0].textContent};this.isListItem=function(a){return"list-item"===(a&&a.localName)&&a.namespaceURI===M};this.isLineBreak=function(a){return"line-break"===(a&&a.localName)&&a.namespaceURI===M};this.isODFWhitespace=p;this.isGroupingElement=q;this.isFieldElement=e;this.isCharacterElement=l;this.isAnchoredAsCharacterElement=
a;this.isSpaceElement=d;this.isODFNode=n;this.hasNoODFContent=k;this.firstChild=y;this.lastChild=u;this.previousNode=z;this.nextNode=x;this.scanLeftForNonSpace=w;this.lookLeftForCharacter=function(d){var b,c=b=0;d.nodeType===Node.TEXT_NODE&&(c=d.length);0<c?(b=d.data,b=p(b.substr(c-1,1))?1===c?w(z(d))?2:0:p(b.substr(c-2,1))?0:2:1):a(d)&&(b=1);return b};this.lookRightForCharacter=function(d){var b=!1,c=0;d&&d.nodeType===Node.TEXT_NODE&&(c=d.length);0<c?b=!p(d.data.substr(0,1)):a(d)&&(b=!0);return b};
this.scanLeftForAnyCharacter=function(d){var b=!1,c;for(d=d&&u(d);d;){c=d.nodeType===Node.TEXT_NODE?d.length:0;if(0<c&&!p(d.data)){b=!0;break}if(a(d)){b=!0;break}d=z(d)}return b};this.scanRightForAnyCharacter=v;this.isTrailingWhitespace=t;this.isSignificantWhitespace=D;this.isDowngradableSpaceElement=function(a){return d(a)?w(z(a))&&v(x(a)):!1};this.odf_OdfUtilsImpl$parseLength=J;this.parseNonNegativeLength=A;this.parseFoFontSize=function(a){var d;d=(d=J(a))&&(0>=d.value||"%"===d.unit)?null:d;return d||
L(a)};this.parseFoLineHeight=function(a){return A(a)||L(a)};this.isTextContentContainingNode=S;this.getTextNodes=function(a,d){var b;b=Y.getNodesInRange(a,function(a){var d=NodeFilter.FILTER_REJECT;a.nodeType===Node.TEXT_NODE?K(a)&&(d=NodeFilter.FILTER_ACCEPT):S(a)&&(d=NodeFilter.FILTER_SKIP);return d},NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);d||R(a,b);return b};this.getTextElements=B;this.getParagraphElements=function(a){var d;d=Y.getNodesInRange(a,function(a){var d=NodeFilter.FILTER_REJECT;
if(f(a))d=NodeFilter.FILTER_ACCEPT;else if(S(a)||q(a))d=NodeFilter.FILTER_SKIP;return d},NodeFilter.SHOW_ELEMENT);V(a.startContainer,d,f);return d};this.getImageElements=function(a){var d;d=Y.getNodesInRange(a,function(a){var d=NodeFilter.FILTER_SKIP;g(a)&&(d=NodeFilter.FILTER_ACCEPT);return d},NodeFilter.SHOW_ELEMENT);V(a.startContainer,d,g);return d};this.getHyperlinkElements=function(a){var d=[],c=a.cloneRange();a.collapsed&&a.endContainer.nodeType===Node.ELEMENT_NODE&&(a=U(a.endContainer,a.endOffset),
a.nodeType===Node.TEXT_NODE&&c.setEnd(a,1));B(c,!0,!1).forEach(function(a){for(a=a.parentNode;!f(a);){if(b(a)&&-1===d.indexOf(a)){d.push(a);break}a=a.parentNode}});c.detach();return d};this.getNormalizedFontFamilyName=function(a){/^(["'])(?:.|[\n\r])*?\1$/.test(a)||(a=a.replace(/^[ \t\r\n\f]*((?:.|[\n\r])*?)[ \t\r\n\f]*$/,"$1"),/[ \t\r\n\f]/.test(a)&&(a="'"+a.replace(/[ \t\r\n\f]+/g," ")+"'"));return a}};odf.OdfUtils=new odf.OdfUtilsImpl;
gui.OdfTextBodyNodeFilter=function(){var g=odf.OdfUtils,h=Node.TEXT_NODE,c=NodeFilter.FILTER_REJECT,b=NodeFilter.FILTER_ACCEPT,f=odf.Namespaces.textns;this.acceptNode=function(m){if(m.nodeType===h){if(!g.isGroupingElement(m.parentNode))return c}else if(m.namespaceURI===f&&"tracked-changes"===m.localName)return c;return b}};xmldom.LSSerializerFilter=function(){};xmldom.LSSerializerFilter.prototype.acceptNode=function(g){};
odf.OdfNodeFilter=function(){this.acceptNode=function(g){return"http://www.w3.org/1999/xhtml"===g.namespaceURI?NodeFilter.FILTER_SKIP:g.namespaceURI&&g.namespaceURI.match(/^urn:webodf:/)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}};xmldom.XPathIterator=function(){};xmldom.XPathIterator.prototype.AllChildElementIterator$next=function(){};xmldom.XPathIterator.prototype.AllChildElementIterator$reset=function(){};
function createXPathSingleton(){function g(b,a,d){return-1!==b&&(b<a||-1===a)&&(b<d||-1===d)}function h(b){for(var a=[],d=0,c=b.length,k;d<c;){var f=b,m=c,h=a,p,r=[],q=f.indexOf("[",d),t=f.indexOf("/",d),D=f.indexOf("=",d);g(t,q,D)?(p=f.substring(d,t),d=t+1):g(q,t,D)?(p=f.substring(d,q),d=e(f,q,r)):g(D,t,q)?(p=f.substring(d,D),d=D):(p=f.substring(d,m),d=m);h.push({location:p,predicates:r});if(d<c&&"="===b[d]){k=b.substring(d+1,c);if(2<k.length&&("'"===k[0]||'"'===k[0]))k=k.slice(1,k.length-1);else try{k=
parseInt(k,10)}catch(J){}d=c}}return{steps:a,value:k}}function c(){var b=null,a=!1;this.setNode=function(a){b=a};this.AllChildElementIterator$reset=function(){a=!1};this.AllChildElementIterator$next=function(){var d=a?null:b;a=!0;return d}}function b(b,a,d){this.AllChildElementIterator$reset=function(){b.AllChildElementIterator$reset()};this.AllChildElementIterator$next=function(){for(var c=b.AllChildElementIterator$next();c;){c.nodeType===Node.ELEMENT_NODE&&(c=c.getAttributeNodeNS(a,d));if(c)break;
c=b.AllChildElementIterator$next()}return c}}function f(b,a){var d=b.AllChildElementIterator$next(),c=null;this.AllChildElementIterator$reset=function(){b.AllChildElementIterator$reset();d=b.AllChildElementIterator$next();c=null};this.AllChildElementIterator$next=function(){for(;d;){if(c)if(a&&c.firstChild)c=c.firstChild;else{for(;!c.nextSibling&&c!==d;)c=c.parentNode;c===d?d=b.AllChildElementIterator$next():c=c.nextSibling}else{do(c=d.firstChild)||(d=b.AllChildElementIterator$next());while(d&&!c)
}if(c&&c.nodeType===Node.ELEMENT_NODE)return c}return null}}function m(b,a){this.AllChildElementIterator$reset=function(){b.AllChildElementIterator$reset()};this.AllChildElementIterator$next=function(){for(var d=b.AllChildElementIterator$next();d&&!a(d);)d=b.AllChildElementIterator$next();return d}}function r(b,a,d){a=a.split(":",2);var c=d(a[0]),k=a[1];return new m(b,function(a){return a.localName===k&&a.namespaceURI===c})}function p(b,a,d){var n=new c,k=q(n,a,d),e=a.value;return void 0===e?new m(b,
function(a){n.setNode(a);k.AllChildElementIterator$reset();return!!k.AllChildElementIterator$next()}):new m(b,function(a){n.setNode(a);k.AllChildElementIterator$reset();return(a=k.AllChildElementIterator$next())?a.nodeValue===e:!1})}var q,e;e=function(b,a,d){for(var c=a,k=b.length,e=0;c<k;)"]"===b[c]?(--e,0>=e&&d.push(h(b.substring(a,c)))):"["===b[c]&&(0>=e&&(a=c+1),e+=1),c+=1;return c};q=function(c,a,d){var n,k,e,m;for(n=0;n<a.steps.length;n+=1){e=a.steps[n];k=e.location;if(""===k)c=new f(c,!1);
else if("@"===k[0]){k=k.substr(1).split(":",2);m=d(k[0]);if(!m)throw"No namespace associated with the prefix "+k[0];c=new b(c,m,k[1])}else"."!==k&&(c=new f(c,!1),-1!==k.indexOf(":")&&(c=r(c,k,d)));for(k=0;k<e.predicates.length;k+=1)m=e.predicates[k],c=p(c,m,d)}return c};return{getODFElementsWithXPath:function(b,a,d){var e=b.ownerDocument,k=[];if(e&&"function"===typeof e.evaluate)for(d=e.evaluate(a,b,d,XPathResult.UNORDERED_NODE_ITERATOR_TYPE,null),b=d.iterateNext();b;)b.nodeType===Node.ELEMENT_NODE&&
k.push(b),b=d.iterateNext();else{k=new c;k.setNode(b);b=h(a);k=q(k,b,d);b=[];for(d=k.AllChildElementIterator$next();d;)b.push(d),d=k.AllChildElementIterator$next();k=b}return k}}}xmldom.XPath=createXPathSingleton();
odf.StyleInfo=function(){function g(a,d){var b,c,k,e,n,f=0;if(b=A[a.localName])if(k=b[a.namespaceURI])f=k.length;for(b=0;b<f;b+=1)c=k[b],e=c.ns,n=c.localname,(c=a.getAttributeNS(e,n))&&a.setAttributeNS(e,D[e]+n,d+c);for(k=a.firstElementChild;k;)g(k,d),k=k.nextElementSibling}function h(a,d){var b,c,k,e,n,f=0;if(b=A[a.localName])if(k=b[a.namespaceURI])f=k.length;for(b=0;b<f;b+=1)if(c=k[b],e=c.ns,n=c.localname,c=a.getAttributeNS(e,n))c=c.replace(d,""),a.setAttributeNS(e,D[e]+n,c);for(k=a.firstElementChild;k;)h(k,
d),k=k.nextElementSibling}function c(a,d){var b,c,k,e,n,f=0;if(b=A[a.localName])if(k=b[a.namespaceURI])f=k.length;for(b=0;b<f;b+=1)if(e=k[b],c=e.ns,n=e.localname,c=a.getAttributeNS(c,n))d=d||{},e=e.keyname,d.hasOwnProperty(e)?d[e][c]=1:(n={},n[c]=1,d[e]=n);return d}function b(a,d){var k,e;c(a,d);for(k=a.firstChild;k;)k.nodeType===Node.ELEMENT_NODE&&(e=k,b(e,d)),k=k.nextSibling}function f(a,d,b){this.key=a;this.name=d;this.family=b;this.requires={}}function m(a,d,b){var c=a+'"'+d,k=b[c];k||(k=b[c]=
new f(c,a,d));return k}function r(a,d,b){var c,k,e,n,f,l=0;c=a.getAttributeNS(w,"name");n=a.getAttributeNS(w,"family");c&&n&&(d=m(c,n,b));if(d){if(c=A[a.localName])if(e=c[a.namespaceURI])l=e.length;for(c=0;c<l;c+=1)if(n=e[c],k=n.ns,f=n.localname,k=a.getAttributeNS(k,f))n=n.keyname,n=m(k,n,b),d.requires[n.key]=n}for(a=a.firstElementChild;a;)r(a,d,b),a=a.nextElementSibling;return b}function p(a,d){var b=d[a.family];b||(b=d[a.family]={});b[a.name]=1;Object.keys(a.requires).forEach(function(b){p(a.requires[b],
d)})}function q(a,d){var b=r(a,null,{});Object.keys(b).forEach(function(a){a=b[a];var c=d[a.family];c&&c.hasOwnProperty(a.name)&&p(a,d)})}function e(a,d){function b(d){(d=n.getAttributeNS(w,d))&&(a[d]=!0)}var c=["font-name","font-name-asian","font-name-complex"],k,n;for(k=d&&d.firstElementChild;k;)n=k,c.forEach(b),e(a,n),k=k.nextElementSibling}function l(a,d){function b(a){var c=e.getAttributeNS(w,a);c&&d.hasOwnProperty(c)&&e.setAttributeNS(w,"style:"+a,d[c])}var c=["font-name","font-name-asian",
"font-name-complex"],k,e;for(k=a&&a.firstElementChild;k;)e=k,c.forEach(b),l(e,d),k=k.nextElementSibling}var a=odf.Namespaces.chartns,d=odf.Namespaces.dbns,n=odf.Namespaces.dr3dns,k=odf.Namespaces.drawns,y=odf.Namespaces.formns,u=odf.Namespaces.numberns,z=odf.Namespaces.officens,x=odf.Namespaces.presentationns,w=odf.Namespaces.stylens,v=odf.Namespaces.tablens,t=odf.Namespaces.textns,D={"urn:oasis:names:tc:opendocument:xmlns:chart:1.0":"chart:","urn:oasis:names:tc:opendocument:xmlns:database:1.0":"db:",
"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0":"dr3d:","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0":"draw:","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0":"fo:","urn:oasis:names:tc:opendocument:xmlns:form:1.0":"form:","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":"number:","urn:oasis:names:tc:opendocument:xmlns:office:1.0":"office:","urn:oasis:names:tc:opendocument:xmlns:presentation:1.0":"presentation:","urn:oasis:names:tc:opendocument:xmlns:style:1.0":"style:","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0":"svg:",
"urn:oasis:names:tc:opendocument:xmlns:table:1.0":"table:","urn:oasis:names:tc:opendocument:xmlns:text:1.0":"chart:","http://www.w3.org/XML/1998/namespace":"xml:"},J={text:[{ens:w,en:"tab-stop",ans:w,a:"leader-text-style"},{ens:w,en:"drop-cap",ans:w,a:"style-name"},{ens:t,en:"notes-configuration",ans:t,a:"citation-body-style-name"},{ens:t,en:"notes-configuration",ans:t,a:"citation-style-name"},{ens:t,en:"a",ans:t,a:"style-name"},{ens:t,en:"alphabetical-index",ans:t,a:"style-name"},{ens:t,en:"linenumbering-configuration",
ans:t,a:"style-name"},{ens:t,en:"list-level-style-number",ans:t,a:"style-name"},{ens:t,en:"ruby-text",ans:t,a:"style-name"},{ens:t,en:"span",ans:t,a:"style-name"},{ens:t,en:"a",ans:t,a:"visited-style-name"},{ens:w,en:"text-properties",ans:w,a:"text-line-through-text-style"},{ens:t,en:"alphabetical-index-source",ans:t,a:"main-entry-style-name"},{ens:t,en:"index-entry-bibliography",ans:t,a:"style-name"},{ens:t,en:"index-entry-chapter",ans:t,a:"style-name"},{ens:t,en:"index-entry-link-end",ans:t,a:"style-name"},
{ens:t,en:"index-entry-link-start",ans:t,a:"style-name"},{ens:t,en:"index-entry-page-number",ans:t,a:"style-name"},{ens:t,en:"index-entry-span",ans:t,a:"style-name"},{ens:t,en:"index-entry-tab-stop",ans:t,a:"style-name"},{ens:t,en:"index-entry-text",ans:t,a:"style-name"},{ens:t,en:"index-title-template",ans:t,a:"style-name"},{ens:t,en:"list-level-style-bullet",ans:t,a:"style-name"},{ens:t,en:"outline-level-style",ans:t,a:"style-name"}],paragraph:[{ens:k,en:"caption",ans:k,a:"text-style-name"},{ens:k,
en:"circle",ans:k,a:"text-style-name"},{ens:k,en:"connector",ans:k,a:"text-style-name"},{ens:k,en:"control",ans:k,a:"text-style-name"},{ens:k,en:"custom-shape",ans:k,a:"text-style-name"},{ens:k,en:"ellipse",ans:k,a:"text-style-name"},{ens:k,en:"frame",ans:k,a:"text-style-name"},{ens:k,en:"line",ans:k,a:"text-style-name"},{ens:k,en:"measure",ans:k,a:"text-style-name"},{ens:k,en:"path",ans:k,a:"text-style-name"},{ens:k,en:"polygon",ans:k,a:"text-style-name"},{ens:k,en:"polyline",ans:k,a:"text-style-name"},
{ens:k,en:"rect",ans:k,a:"text-style-name"},{ens:k,en:"regular-polygon",ans:k,a:"text-style-name"},{ens:z,en:"annotation",ans:k,a:"text-style-name"},{ens:y,en:"column",ans:y,a:"text-style-name"},{ens:w,en:"style",ans:w,a:"next-style-name"},{ens:v,en:"body",ans:v,a:"paragraph-style-name"},{ens:v,en:"even-columns",ans:v,a:"paragraph-style-name"},{ens:v,en:"even-rows",ans:v,a:"paragraph-style-name"},{ens:v,en:"first-column",ans:v,a:"paragraph-style-name"},{ens:v,en:"first-row",ans:v,a:"paragraph-style-name"},
{ens:v,en:"last-column",ans:v,a:"paragraph-style-name"},{ens:v,en:"last-row",ans:v,a:"paragraph-style-name"},{ens:v,en:"odd-columns",ans:v,a:"paragraph-style-name"},{ens:v,en:"odd-rows",ans:v,a:"paragraph-style-name"},{ens:t,en:"notes-configuration",ans:t,a:"default-style-name"},{ens:t,en:"alphabetical-index-entry-template",ans:t,a:"style-name"},{ens:t,en:"bibliography-entry-template",ans:t,a:"style-name"},{ens:t,en:"h",ans:t,a:"style-name"},{ens:t,en:"illustration-index-entry-template",ans:t,a:"style-name"},
{ens:t,en:"index-source-style",ans:t,a:"style-name"},{ens:t,en:"object-index-entry-template",ans:t,a:"style-name"},{ens:t,en:"p",ans:t,a:"style-name"},{ens:t,en:"table-index-entry-template",ans:t,a:"style-name"},{ens:t,en:"table-of-content-entry-template",ans:t,a:"style-name"},{ens:t,en:"table-index-entry-template",ans:t,a:"style-name"},{ens:t,en:"user-index-entry-template",ans:t,a:"style-name"},{ens:w,en:"page-layout-properties",ans:w,a:"register-truth-ref-style-name"}],chart:[{ens:a,en:"axis",ans:a,
a:"style-name"},{ens:a,en:"chart",ans:a,a:"style-name"},{ens:a,en:"data-label",ans:a,a:"style-name"},{ens:a,en:"data-point",ans:a,a:"style-name"},{ens:a,en:"equation",ans:a,a:"style-name"},{ens:a,en:"error-indicator",ans:a,a:"style-name"},{ens:a,en:"floor",ans:a,a:"style-name"},{ens:a,en:"footer",ans:a,a:"style-name"},{ens:a,en:"grid",ans:a,a:"style-name"},{ens:a,en:"legend",ans:a,a:"style-name"},{ens:a,en:"mean-value",ans:a,a:"style-name"},{ens:a,en:"plot-area",ans:a,a:"style-name"},{ens:a,en:"regression-curve",
ans:a,a:"style-name"},{ens:a,en:"series",ans:a,a:"style-name"},{ens:a,en:"stock-gain-marker",ans:a,a:"style-name"},{ens:a,en:"stock-loss-marker",ans:a,a:"style-name"},{ens:a,en:"stock-range-line",ans:a,a:"style-name"},{ens:a,en:"subtitle",ans:a,a:"style-name"},{ens:a,en:"title",ans:a,a:"style-name"},{ens:a,en:"wall",ans:a,a:"style-name"}],section:[{ens:t,en:"alphabetical-index",ans:t,a:"style-name"},{ens:t,en:"bibliography",ans:t,a:"style-name"},{ens:t,en:"illustration-index",ans:t,a:"style-name"},
{ens:t,en:"index-title",ans:t,a:"style-name"},{ens:t,en:"object-index",ans:t,a:"style-name"},{ens:t,en:"section",ans:t,a:"style-name"},{ens:t,en:"table-of-content",ans:t,a:"style-name"},{ens:t,en:"table-index",ans:t,a:"style-name"},{ens:t,en:"user-index",ans:t,a:"style-name"}],ruby:[{ens:t,en:"ruby",ans:t,a:"style-name"}],table:[{ens:d,en:"query",ans:d,a:"style-name"},{ens:d,en:"table-representation",ans:d,a:"style-name"},{ens:v,en:"background",ans:v,a:"style-name"},{ens:v,en:"table",ans:v,a:"style-name"}],
"table-column":[{ens:d,en:"column",ans:d,a:"style-name"},{ens:v,en:"table-column",ans:v,a:"style-name"}],"table-row":[{ens:d,en:"query",ans:d,a:"default-row-style-name"},{ens:d,en:"table-representation",ans:d,a:"default-row-style-name"},{ens:v,en:"table-row",ans:v,a:"style-name"}],"table-cell":[{ens:d,en:"column",ans:d,a:"default-cell-style-name"},{ens:v,en:"table-column",ans:v,a:"default-cell-style-name"},{ens:v,en:"table-row",ans:v,a:"default-cell-style-name"},{ens:v,en:"body",ans:v,a:"style-name"},
{ens:v,en:"covered-table-cell",ans:v,a:"style-name"},{ens:v,en:"even-columns",ans:v,a:"style-name"},{ens:v,en:"covered-table-cell",ans:v,a:"style-name"},{ens:v,en:"even-columns",ans:v,a:"style-name"},{ens:v,en:"even-rows",ans:v,a:"style-name"},{ens:v,en:"first-column",ans:v,a:"style-name"},{ens:v,en:"first-row",ans:v,a:"style-name"},{ens:v,en:"last-column",ans:v,a:"style-name"},{ens:v,en:"last-row",ans:v,a:"style-name"},{ens:v,en:"odd-columns",ans:v,a:"style-name"},{ens:v,en:"odd-rows",ans:v,a:"style-name"},
{ens:v,en:"table-cell",ans:v,a:"style-name"}],graphic:[{ens:n,en:"cube",ans:k,a:"style-name"},{ens:n,en:"extrude",ans:k,a:"style-name"},{ens:n,en:"rotate",ans:k,a:"style-name"},{ens:n,en:"scene",ans:k,a:"style-name"},{ens:n,en:"sphere",ans:k,a:"style-name"},{ens:k,en:"caption",ans:k,a:"style-name"},{ens:k,en:"circle",ans:k,a:"style-name"},{ens:k,en:"connector",ans:k,a:"style-name"},{ens:k,en:"control",ans:k,a:"style-name"},{ens:k,en:"custom-shape",ans:k,a:"style-name"},{ens:k,en:"ellipse",ans:k,a:"style-name"},
{ens:k,en:"frame",ans:k,a:"style-name"},{ens:k,en:"g",ans:k,a:"style-name"},{ens:k,en:"line",ans:k,a:"style-name"},{ens:k,en:"measure",ans:k,a:"style-name"},{ens:k,en:"page-thumbnail",ans:k,a:"style-name"},{ens:k,en:"path",ans:k,a:"style-name"},{ens:k,en:"polygon",ans:k,a:"style-name"},{ens:k,en:"polyline",ans:k,a:"style-name"},{ens:k,en:"rect",ans:k,a:"style-name"},{ens:k,en:"regular-polygon",ans:k,a:"style-name"},{ens:z,en:"annotation",ans:k,a:"style-name"}],presentation:[{ens:n,en:"cube",ans:x,
a:"style-name"},{ens:n,en:"extrude",ans:x,a:"style-name"},{ens:n,en:"rotate",ans:x,a:"style-name"},{ens:n,en:"scene",ans:x,a:"style-name"},{ens:n,en:"sphere",ans:x,a:"style-name"},{ens:k,en:"caption",ans:x,a:"style-name"},{ens:k,en:"circle",ans:x,a:"style-name"},{ens:k,en:"connector",ans:x,a:"style-name"},{ens:k,en:"control",ans:x,a:"style-name"},{ens:k,en:"custom-shape",ans:x,a:"style-name"},{ens:k,en:"ellipse",ans:x,a:"style-name"},{ens:k,en:"frame",ans:x,a:"style-name"},{ens:k,en:"g",ans:x,a:"style-name"},
{ens:k,en:"line",ans:x,a:"style-name"},{ens:k,en:"measure",ans:x,a:"style-name"},{ens:k,en:"page-thumbnail",ans:x,a:"style-name"},{ens:k,en:"path",ans:x,a:"style-name"},{ens:k,en:"polygon",ans:x,a:"style-name"},{ens:k,en:"polyline",ans:x,a:"style-name"},{ens:k,en:"rect",ans:x,a:"style-name"},{ens:k,en:"regular-polygon",ans:x,a:"style-name"},{ens:z,en:"annotation",ans:x,a:"style-name"}],"drawing-page":[{ens:k,en:"page",ans:k,a:"style-name"},{ens:x,en:"notes",ans:k,a:"style-name"},{ens:w,en:"handout-master",
ans:k,a:"style-name"},{ens:w,en:"master-page",ans:k,a:"style-name"}],"list-style":[{ens:t,en:"list",ans:t,a:"style-name"},{ens:t,en:"numbered-paragraph",ans:t,a:"style-name"},{ens:t,en:"list-item",ans:t,a:"style-override"},{ens:w,en:"style",ans:w,a:"list-style-name"}],data:[{ens:w,en:"style",ans:w,a:"data-style-name"},{ens:w,en:"style",ans:w,a:"percentage-data-style-name"},{ens:x,en:"date-time-decl",ans:w,a:"data-style-name"},{ens:t,en:"creation-date",ans:w,a:"data-style-name"},{ens:t,en:"creation-time",
ans:w,a:"data-style-name"},{ens:t,en:"database-display",ans:w,a:"data-style-name"},{ens:t,en:"date",ans:w,a:"data-style-name"},{ens:t,en:"editing-duration",ans:w,a:"data-style-name"},{ens:t,en:"expression",ans:w,a:"data-style-name"},{ens:t,en:"meta-field",ans:w,a:"data-style-name"},{ens:t,en:"modification-date",ans:w,a:"data-style-name"},{ens:t,en:"modification-time",ans:w,a:"data-style-name"},{ens:t,en:"print-date",ans:w,a:"data-style-name"},{ens:t,en:"print-time",ans:w,a:"data-style-name"},{ens:t,
en:"table-formula",ans:w,a:"data-style-name"},{ens:t,en:"time",ans:w,a:"data-style-name"},{ens:t,en:"user-defined",ans:w,a:"data-style-name"},{ens:t,en:"user-field-get",ans:w,a:"data-style-name"},{ens:t,en:"user-field-input",ans:w,a:"data-style-name"},{ens:t,en:"variable-get",ans:w,a:"data-style-name"},{ens:t,en:"variable-input",ans:w,a:"data-style-name"},{ens:t,en:"variable-set",ans:w,a:"data-style-name"}],"page-layout":[{ens:x,en:"notes",ans:w,a:"page-layout-name"},{ens:w,en:"handout-master",ans:w,
a:"page-layout-name"},{ens:w,en:"master-page",ans:w,a:"page-layout-name"}]},A,L=xmldom.XPath;this.collectUsedFontFaces=e;this.changeFontFaceNames=l;this.UsedStyleList=function(a,d){var c={};this.uses=function(a){var d=a.localName,b=a.getAttributeNS(k,"name")||a.getAttributeNS(w,"name");a="style"===d?a.getAttributeNS(w,"family"):a.namespaceURI===u?"data":d;return(a=c[a])?0<a[b]:!1};b(a,c);d&&q(d,c)};this.getStyleName=function(a,d){var b,c,k=A[d.localName];if(k&&(k=k[d.namespaceURI]))for(c=0;c<k.length;c+=
1)if(k[c].keyname===a&&(k=k[c],d.hasAttributeNS(k.ns,k.localname))){b=d.getAttributeNS(k.ns,k.localname);break}return b};this.hasDerivedStyles=function(a,d,b){var c=b.getAttributeNS(w,"name");b=b.getAttributeNS(w,"family");return L.getODFElementsWithXPath(a,'//style:*[@style:parent-style-name="'+c+'"][@style:family="'+b+'"]',d).length?!0:!1};this.prefixStyleNames=function(a,d,b){var c;if(a){for(c=a.firstChild;c;){if(c.nodeType===Node.ELEMENT_NODE){var e=c,n=d,f=e.getAttributeNS(k,"name"),l=void 0;
f?l=k:(f=e.getAttributeNS(w,"name"))&&(l=w);l&&e.setAttributeNS(l,D[l]+"name",n+f)}c=c.nextSibling}g(a,d);b&&g(b,d)}};this.removePrefixFromStyleNames=function(a,d,b){var c=new RegExp("^"+d);if(a){for(d=a.firstChild;d;){if(d.nodeType===Node.ELEMENT_NODE){var e=d,n=c,f=e.getAttributeNS(k,"name"),l=void 0;f?l=k:(f=e.getAttributeNS(w,"name"))&&(l=w);l&&(f=f.replace(n,""),e.setAttributeNS(l,D[l]+"name",f))}d=d.nextSibling}h(a,c);b&&h(b,c)}};this.determineStylesForNode=c;A=function(){var a,d,b,c,k,e={},
n,f,l,m;for(b in J)if(J.hasOwnProperty(b))for(c=J[b],d=c.length,a=0;a<d;a+=1)k=c[a],l=k.en,m=k.ens,e.hasOwnProperty(l)?n=e[l]:e[l]=n={},n.hasOwnProperty(m)?f=n[m]:n[m]=f=[],f.push({ns:k.ans,localname:k.a,keyname:b});return e}()};"function"!==typeof Object.create&&(Object.create=function(g){var h=function(){};h.prototype=g;return new h});
xmldom.LSSerializer=function(){function g(b){var c=b||{},g=function(b){var a={},d;for(d in b)b.hasOwnProperty(d)&&(a[b[d]]=d);return a}(b),h=[c],q=[g],e=0;this.Namespaces$push=function(){e+=1;c=h[e]=Object.create(c);g=q[e]=Object.create(g)};this.Namespaces$pop=function(){h.pop();q.pop();--e;c=h[e];g=q[e]};this.getLocalNamespaceDefinitions=function(){return g};this.getQName=function(b){var a=b.namespaceURI,d=0,e;if(!a)return b.localName;if(e=g[a])return e+":"+b.localName;do{e||!b.prefix?(e="ns"+d,
d+=1):e=b.prefix;if(c[e]===a)break;if(!c[e]){c[e]=a;g[a]=e;break}e=null}while(null===e);return e+":"+b.localName}}function h(b){return b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;")}function c(f,m){var g="",p=b.xmldom_LSSerializer$filter?b.xmldom_LSSerializer$filter.acceptNode(m):NodeFilter.FILTER_ACCEPT,q;if(p===NodeFilter.FILTER_ACCEPT&&m.nodeType===Node.ELEMENT_NODE){f.Namespaces$push();q=f.getQName(m);var e,l=m.attributes,a,d,n,
k="",y;e="<"+q;a=l.length;for(d=0;d<a;d+=1)n=l.item(d),"http://www.w3.org/2000/xmlns/"!==n.namespaceURI&&(y=b.xmldom_LSSerializer$filter?b.xmldom_LSSerializer$filter.acceptNode(n):NodeFilter.FILTER_ACCEPT,y===NodeFilter.FILTER_ACCEPT&&(y=f.getQName(n),n="string"===typeof n.value?h(n.value):n.value,k+=" "+(y+'="'+n+'"')));a=f.getLocalNamespaceDefinitions();for(d in a)a.hasOwnProperty(d)&&((l=a[d])?"xmlns"!==l&&(e+=" xmlns:"+a[d]+'="'+d+'"'):e+=' xmlns="'+d+'"');g+=e+(k+">")}if(p===NodeFilter.FILTER_ACCEPT||
p===NodeFilter.FILTER_SKIP){for(p=m.firstChild;p;)g+=c(f,p),p=p.nextSibling;m.nodeValue&&(g+=h(m.nodeValue))}q&&(g+="</"+q+">",f.Namespaces$pop());return g}var b=this;this.xmldom_LSSerializer$filter=null;this.xmldom_LSSerializer$writeToString=function(b,m){if(!b)return"";var h=new g(m);return c(h,b)}};
(function(){function g(b){var a,d=p.length;for(a=0;a<d;a+=1)if("urn:oasis:names:tc:opendocument:xmlns:office:1.0"===b.namespaceURI&&b.localName===p[a])return a;return-1}function h(b,a){var d=new f.UsedStyleList(b,a),c=new odf.OdfNodeFilter;this.acceptNode=function(b){var e=c.acceptNode(b);e===NodeFilter.FILTER_ACCEPT&&b.parentNode===a&&b.nodeType===Node.ELEMENT_NODE&&(e=d.uses(b)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT);return e}}function c(b,a){var d=new h(b,a);this.acceptNode=function(a){var b=
d.acceptNode(a);b!==NodeFilter.FILTER_ACCEPT||!a.parentNode||a.parentNode.namespaceURI!==odf.Namespaces.textns||"s"!==a.parentNode.localName&&"tab"!==a.parentNode.localName||(b=NodeFilter.FILTER_REJECT);return b}}function b(b,a){if(a){var d=g(a),c,k=b.firstChild;if(-1!==d){for(;k;){c=g(k);if(-1!==c&&c>d)break;k=k.nextSibling}b.insertBefore(a,k)}}}var f=new odf.StyleInfo,m=core.DomUtils,r=odf.Namespaces.stylens,p="meta settings scripts font-face-decls styles automatic-styles master-styles body".split(" "),
q=Date.now()+"_webodf_",e=new core.Base64;odf.ODFElement=function(){};odf.ODFDocumentElement=function(){};odf.ODFDocumentElement.prototype=new odf.ODFElement;odf.ODFDocumentElement.prototype.constructor=odf.ODFDocumentElement;odf.ODFDocumentElement.prototype.fontFaceDecls=null;odf.ODFDocumentElement.prototype.manifest=null;odf.ODFDocumentElement.prototype.settings=null;odf.ODFDocumentElement.namespaceURI="urn:oasis:names:tc:opendocument:xmlns:office:1.0";odf.ODFDocumentElement.localName="document";
odf.AnnotationElement=function(){};odf.OdfPart=function(b,a,d,c){var k=this;this.odf_OdfPart$size=0;this.type=null;this.name=b;this.container=d;this.odf_OdfPart$url=null;this.mimetype=a;this.odf_OdfPart$onstatereadychange=this.odf_OdfPart$document=null;this.odf_OdfPart$EMPTY=0;this.odf_OdfPart$LOADING=1;this.odf_OdfPart$DONE=2;this.odf_OdfPart$state=this.odf_OdfPart$EMPTY;this.data="";this.odf_OdfPart_prototype$load=function(){c&&(this.mimetype=a,c.loadAsDataURL(b,a,function(a,d){a&&runtime.log(a);
k.odf_OdfPart$url=d;k.odf_OdfPart$onchange&&k.odf_OdfPart$onchange(k)}))}};odf.OdfPart.prototype.odf_OdfPart_prototype$load=function(){};odf.OdfPart.prototype.odf_OdfPart_prototype$getUrl=function(){return this.data?"data:;base64,"+e.toBase64(this.data):null};odf.OdfContainer=function a(d,n){function k(a){for(var d=a.firstChild,b;d;)b=d.nextSibling,d.nodeType===Node.ELEMENT_NODE?k(d):d.nodeType===Node.PROCESSING_INSTRUCTION_NODE&&a.removeChild(d),d=b}function g(a){var d={},b,c,k=a.ownerDocument.createNodeIterator(a,
NodeFilter.SHOW_ELEMENT,null,!1);for(a=k.nextNode();a;)"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===a.namespaceURI&&("annotation"===a.localName?(b=a.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","name"))&&(d.hasOwnProperty(b)?runtime.log("Warning: annotation name used more than once with <office:annotation/>: '"+b+"'"):d[b]=a):"annotation-end"===a.localName&&((b=a.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","name"))?d.hasOwnProperty(b)?(c=d[b],c.annotationEndElement?
runtime.log("Warning: annotation name used more than once with <office:annotation-end/>: '"+b+"'"):c.annotationEndElement=a):runtime.log("Warning: annotation end without an annotation start, name: '"+b+"'"):runtime.log("Warning: annotation end without a name found"))),a=k.nextNode()}function p(a,d){for(var b=a&&a.firstChild;b;)b.nodeType===Node.ELEMENT_NODE&&b.setAttributeNS("urn:webodf:names:scope","scope",d),b=b.nextSibling}function z(a,d){for(var b=E.rootElement.meta,b=b&&b.firstChild;b&&(b.namespaceURI!==
a||b.localName!==d);)b=b.nextSibling;for(b=b&&b.firstChild;b&&b.nodeType!==Node.TEXT_NODE;)b=b.nextSibling;return b?b.data:null}function x(a){var d={},b;for(a=a.firstChild;a;)a.nodeType===Node.ELEMENT_NODE&&a.namespaceURI===r&&"font-face"===a.localName&&(b=a.getAttributeNS(r,"name"),d[b]=a),a=a.nextSibling;return d}function w(a,d){var b=null,c,k,e;if(a)for(b=a.cloneNode(!0),c=b.firstElementChild;c;)k=c.nextElementSibling,(e=c.getAttributeNS("urn:webodf:names:scope","scope"))&&e!==d&&b.removeChild(c),
c=k;return b}function v(a,d){var b,c,k,e=null,n={};if(a)for(d.forEach(function(a){f.collectUsedFontFaces(n,a)}),e=a.cloneNode(!0),b=e.firstElementChild;b;)c=b.nextElementSibling,k=b.getAttributeNS(r,"name"),n[k]||e.removeChild(b),b=c;return e}function t(a){var d=E.rootElement.ownerDocument,b;if(a){k(a.documentElement);try{b=d.importNode(a.documentElement,!0)}catch(c$0){}}return b}function D(a){E.odf_OdfContainer$state=a;E.odf_OdfContainer$onstatereadychange&&E.odf_OdfContainer$onstatereadychange(E)}
function J(a){F=null;E.rootElement=a;a.fontFaceDecls=m.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls");a.styles=m.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles");a.automaticStyles=m.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles");a.masterStyles=m.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles");a.body=m.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0",
"body");a.meta=m.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta");a.settings=m.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","settings");a.scripts=m.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","scripts");g(a)}function A(d){var c=t(d),k=E.rootElement,e;c&&"document-styles"===c.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===c.namespaceURI?(k.fontFaceDecls=m.getDirectChild(c,"urn:oasis:names:tc:opendocument:xmlns:office:1.0",
"font-face-decls"),b(k,k.fontFaceDecls),e=m.getDirectChild(c,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles"),k.styles=e||d.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles"),b(k,k.styles),e=m.getDirectChild(c,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles"),k.automaticStyles=e||d.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles"),p(k.automaticStyles,"document-styles"),b(k,k.automaticStyles),c=m.getDirectChild(c,
"urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles"),k.masterStyles=c||d.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles"),b(k,k.masterStyles),f.prefixStyleNames(k.automaticStyles,q,k.masterStyles)):D(a.INVALID)}function L(d){d=t(d);var c,k,e,n;if(d&&"document-content"===d.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===d.namespaceURI){c=E.rootElement;e=m.getDirectChild(d,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls");
if(c.fontFaceDecls&&e){n=c.fontFaceDecls;var g,h,q,R,B={};k=x(n);R=x(e);for(e=e.firstElementChild;e;){g=e.nextElementSibling;if(e.namespaceURI===r&&"font-face"===e.localName)if(h=e.getAttributeNS(r,"name"),k.hasOwnProperty(h)){if(!e.isEqualNode(k[h])){q=h;var y=k,S=R,K=0,v;for(v=q=q.replace(/\d+$/,"");y.hasOwnProperty(v)||S.hasOwnProperty(v);)K+=1,v=q+K;q=v;e.setAttributeNS(r,"style:name",q);n.appendChild(e);k[q]=e;delete R[h];B[h]=q}}else n.appendChild(e),k[h]=e,delete R[h];e=g}n=B}else e&&(c.fontFaceDecls=
e,b(c,e));k=m.getDirectChild(d,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles");p(k,"document-content");n&&f.changeFontFaceNames(k,n);if(c.automaticStyles&&k)for(n=k.firstChild;n;)c.automaticStyles.appendChild(n),n=k.firstChild;else k&&(c.automaticStyles=k,b(c,k));d=m.getDirectChild(d,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","body");if(!d)throw"<office:body/> tag is mising.";c.body=d;b(c,c.body)}else D(a.INVALID)}function S(a){a=t(a);var d;a&&"document-meta"===a.localName&&
"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===a.namespaceURI&&(d=E.rootElement,d.meta=m.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta"),b(d,d.meta))}function K(a){a=t(a);var d;a&&"document-settings"===a.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===a.namespaceURI&&(d=E.rootElement,d.settings=m.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","settings"),b(d,d.settings))}function R(a){a=t(a);var d;if(a&&"manifest"===a.localName&&
"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"===a.namespaceURI)for(d=E.rootElement,d.manifest=a,a=d.manifest.firstElementChild;a;)"file-entry"===a.localName&&"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"===a.namespaceURI&&(H[a.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","full-path")]=a.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","media-type")),a=a.nextElementSibling}function B(a,d,b){a=m.core_DomUtilsImpl$getElementsByTagName(a,d);var c;
for(c=0;c<a.length;c+=1)d=a[c],b.hasOwnProperty(d.namespaceURI)||d.parentNode.removeChild(d)}function V(a){B(a,"script",{"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:office:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:table:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:text:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0":!0});B(a,"style",{"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0":!0,
"urn:oasis:names:tc:opendocument:xmlns:style:1.0":!0})}function U(a){var d=a.firstElementChild,b=[],c,k,e,n=a.attributes,f=n.length;for(c=0;c<f;c+=1)e=n.item(c),k=e.localName.substr(0,2).toLowerCase(),null===e.namespaceURI&&"on"===k&&b.push(e);f=b.length;for(c=0;c<f;c+=1)a.removeAttributeNode(b[c]);for(;d;)U(d),d=d.nextElementSibling}function M(d){var b=d.shift();b?Z.loadAsDOM(b.path,function(c,k){k&&(V(k),U(k.documentElement));b.handler(k);E.odf_OdfContainer$state===a.INVALID?c?runtime.log("ERROR: Unable to load "+
b.path+" - "+c):runtime.log("ERROR: Unable to load "+b.path):(c&&runtime.log("DEBUG: Unable to load "+b.path+" - "+c),M(d))}):(g(E.rootElement),D(a.function__new_odf_OdfContainer___odf_OdfContainer_DocumentType_number__string____function__odf_OdfContainer_____null______$DONE))}function P(a){var d="";odf.Namespaces.forEachPrefix(function(a,b){d+=" xmlns:"+a+'="'+b+'"'});return'<?xml version="1.0" encoding="UTF-8"?><office:'+a+" "+d+' office:version="1.2">'}function N(){var a=new xmldom.LSSerializer,
d=P("document-meta");a.xmldom_LSSerializer$filter=new odf.OdfNodeFilter;d+=a.xmldom_LSSerializer$writeToString(E.rootElement.meta,odf.Namespaces.namespaceMap);return d+"</office:document-meta>"}function Y(a,d){var b=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:file-entry");b.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:full-path",a);b.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:media-type",
d);return b}function W(){var a=runtime.parseXML('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2"></manifest:manifest>'),d=a.documentElement,b=new xmldom.LSSerializer,c;for(c in H)H.hasOwnProperty(c)&&d.appendChild(Y(c,H[c]));b.xmldom_LSSerializer$filter=new odf.OdfNodeFilter;return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n'+b.xmldom_LSSerializer$writeToString(a,odf.Namespaces.namespaceMap)}function fa(){var a,d,b,c=odf.Namespaces.namespaceMap,
k=new xmldom.LSSerializer,e=P("document-styles");d=w(E.rootElement.automaticStyles,"document-styles");b=E.rootElement.masterStyles.cloneNode(!0);a=v(E.rootElement.fontFaceDecls,[b,E.rootElement.styles,d]);f.removePrefixFromStyleNames(d,q,b);k.xmldom_LSSerializer$filter=new h(b,d);e+=k.xmldom_LSSerializer$writeToString(a,c);e+=k.xmldom_LSSerializer$writeToString(E.rootElement.styles,c);e+=k.xmldom_LSSerializer$writeToString(d,c);e+=k.xmldom_LSSerializer$writeToString(b,c);return e+"</office:document-styles>"}
function C(){var a,d,b=odf.Namespaces.namespaceMap,k=new xmldom.LSSerializer,e=P("document-content");d=w(E.rootElement.automaticStyles,"document-content");a=v(E.rootElement.fontFaceDecls,[d]);k.xmldom_LSSerializer$filter=new c(E.rootElement.body,d);e+=k.xmldom_LSSerializer$writeToString(a,b);e+=k.xmldom_LSSerializer$writeToString(d,b);e+=k.xmldom_LSSerializer$writeToString(E.rootElement.body,b);return e+"</office:document-content>"}function X(d,b){runtime.BrowserRuntime$loadXML(d,function(d,c){if(d)b(d);
else if(c){V(c);U(c.documentElement);var k=t(c);k&&"document"===k.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===k.namespaceURI?(J(k),D(a.function__new_odf_OdfContainer___odf_OdfContainer_DocumentType_number__string____function__odf_OdfContainer_____null______$DONE)):D(a.INVALID)}else b("No DOM was loaded.")})}function ca(a,d){var c;c=E.rootElement;var k=c.meta;k||(c.meta=k=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta"),b(c,k));c=k;a&&m.mapKeyValObjOntoNode(c,
a,odf.Namespaces.lookupNamespaceURI);d&&m.removeKeyElementsFromNode(c,d,odf.Namespaces.lookupNamespaceURI)}function ba(d,b){function c(a,d){var b;d||(d=a);b=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",d);f[a]=b;f.appendChild(b)}var k=new core.Zip("",null),e="application/vnd.oasis.opendocument."+d+(!0===b?"-template":""),n=runtime.byteArrayFromString(e,"utf8"),f=E.rootElement,g=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",d);k.core_Zip$save("mimetype",
n,!1,new Date);c("meta");c("settings");c("scripts");c("fontFaceDecls","font-face-decls");c("styles");c("automaticStyles","automatic-styles");c("masterStyles","master-styles");c("body");f.body.appendChild(g);H["/"]=e;H["settings.xml"]="text/xml";H["meta.xml"]="text/xml";H["styles.xml"]="text/xml";H["content.xml"]="text/xml";D(a.function__new_odf_OdfContainer___odf_OdfContainer_DocumentType_number__string____function__odf_OdfContainer_____null______$DONE);return k}function T(){var a,d=new Date;if(H["settings.xml"]){a=
new xmldom.LSSerializer;var b=P("document-settings");E.rootElement.settings&&E.rootElement.settings.firstElementChild&&(a.xmldom_LSSerializer$filter=new odf.OdfNodeFilter,b+=a.xmldom_LSSerializer$writeToString(E.rootElement.settings,odf.Namespaces.namespaceMap));a=runtime.byteArrayFromString(b+"</office:document-settings>","utf8");Z.core_Zip$save("settings.xml",a,!0,d)}else Z.core_Zip$remove("settings.xml");b=runtime.getWindow();a="WebODF/"+webodf.Version;b&&(a=a+" "+b.navigator.userAgent);ca({"meta:generator":a},
null);a=runtime.byteArrayFromString(N(),"utf8");Z.core_Zip$save("meta.xml",a,!0,d);a=runtime.byteArrayFromString(fa(),"utf8");Z.core_Zip$save("styles.xml",a,!0,d);a=runtime.byteArrayFromString(C(),"utf8");Z.core_Zip$save("content.xml",a,!0,d);a=runtime.byteArrayFromString(W(),"utf8");Z.core_Zip$save("META-INF/manifest.xml",a,!0,d)}function ea(a,d){T();Z.writeAs(a,function(a){d(a)})}var E=this,Z,H={},F,ia="";this.odf_OdfContainer$onstatereadychange=n;this.odf_OdfContainer$state=this.odf_OdfContainer$onchange=
null;this.odf_OdfContainer$getMetadata=z;this.setRootElement=J;this.getContentElement=function(){var a;F||(a=E.rootElement.body,F=m.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","text")||m.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","presentation")||m.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","spreadsheet"));if(!F)throw"Could not find content element in <office:body/>.";return F};this.getDocumentType=function(){var a=E.getContentElement();
return a&&a.localName};this.isTemplate=function(){return"-template"===H["/"].substr(-9)};this.setIsTemplate=function(a){var d=H["/"],b="-template"===d.substr(-9);a!==b&&(d=a?d+"-template":d.substr(0,d.length-9),H["/"]=d,a=runtime.byteArrayFromString(d,"utf8"),Z.core_Zip$save("mimetype",a,!1,new Date))};this.getPart=function(a){return new odf.OdfPart(a,H[a],E,Z)};this.getPartData=function(a,d){Z.core_Zip$load(a,d)};this.odf_OdfContainer$setMetadata=ca;this.incrementEditingCycles=function(){var a=z(odf.Namespaces.metans,
"editing-cycles"),a=a?parseInt(a,10):0;isNaN(a)&&(a=0);ca({"meta:editing-cycles":a+1},null);return a+1};this.odf_OdfContainer$createByteArray=function(a,d){T();Z.core_Zip$createByteArray(a,d)};this.saveAs=ea;this.odf_OdfContainer$save=function(a){ea(ia,a)};this.odf_OdfContainer$getUrl=function(){return ia};this.setBlob=function(a,d,b){b=e.convertBase64ToByteArray(b);Z.core_Zip$save(a,b,!1,new Date);H.hasOwnProperty(a)&&runtime.log(a+" has been overwritten.");H[a]=d};this.removeBlob=function(a){var d=
Z.core_Zip$remove(a);runtime.BrowserRuntime$assert(d,"file is not found: "+a);delete H[a]};this.odf_OdfContainer$state=a.function__new_odf_OdfContainer___odf_OdfContainer_DocumentType_number__string____function__odf_OdfContainer_____null______$LOADING;this.rootElement=function(a){var d=document.createElementNS(a.namespaceURI,a.localName),b;a=new a.Type;for(b in a)a.hasOwnProperty(b)&&(d[b]=a[b]);return d}({Type:odf.ODFDocumentElement,namespaceURI:odf.ODFDocumentElement.namespaceURI,localName:odf.ODFDocumentElement.localName});
d===odf.OdfContainer.function__new_odf_OdfContainer___odf_OdfContainer_DocumentType_number__string____function__odf_OdfContainer_____null______$DocumentType.TEXT?Z=ba("text"):d===odf.OdfContainer.function__new_odf_OdfContainer___odf_OdfContainer_DocumentType_number__string____function__odf_OdfContainer_____null______$DocumentType.TEXT_TEMPLATE?Z=ba("text",!0):d===odf.OdfContainer.function__new_odf_OdfContainer___odf_OdfContainer_DocumentType_number__string____function__odf_OdfContainer_____null______$DocumentType.PRESENTATION?
Z=ba("presentation"):d===odf.OdfContainer.function__new_odf_OdfContainer___odf_OdfContainer_DocumentType_number__string____function__odf_OdfContainer_____null______$DocumentType.PRESENTATION_TEMPLATE?Z=ba("presentation",!0):d===odf.OdfContainer.function__new_odf_OdfContainer___odf_OdfContainer_DocumentType_number__string____function__odf_OdfContainer_____null______$DocumentType.SPREADSHEET?Z=ba("spreadsheet"):d===odf.OdfContainer.function__new_odf_OdfContainer___odf_OdfContainer_DocumentType_number__string____function__odf_OdfContainer_____null______$DocumentType.SPREADSHEET_TEMPLATE?
Z=ba("spreadsheet",!0):(ia=d,Z=new core.Zip(ia,function(d,b){Z=b;d?X(ia,function(b){d&&(Z.error=d+"\n"+b,D(a.INVALID))}):M([{path:"styles.xml",handler:A},{path:"content.xml",handler:L},{path:"meta.xml",handler:S},{path:"settings.xml",handler:K},{path:"META-INF/manifest.xml",handler:R}])}))};odf.OdfContainer.function__new_odf_OdfContainer___odf_OdfContainer_DocumentType_number__string____function__odf_OdfContainer_____null______$EMPTY=0;odf.OdfContainer.function__new_odf_OdfContainer___odf_OdfContainer_DocumentType_number__string____function__odf_OdfContainer_____null______$LOADING=
1;odf.OdfContainer.function__new_odf_OdfContainer___odf_OdfContainer_DocumentType_number__string____function__odf_OdfContainer_____null______$DONE=2;odf.OdfContainer.INVALID=3;odf.OdfContainer.SAVING=4;odf.OdfContainer.MODIFIED=5;odf.OdfContainer.getContainer=function(a){return new odf.OdfContainer(a,null)}})();
odf.OdfContainer.function__new_odf_OdfContainer___odf_OdfContainer_DocumentType_number__string____function__odf_OdfContainer_____null______$DocumentType={TEXT:1,TEXT_TEMPLATE:2,PRESENTATION:3,PRESENTATION_TEMPLATE:4,SPREADSHEET:5,SPREADSHEET_TEMPLATE:6};gui.AnnotatableCanvas=function(){};gui.AnnotatableCanvas.prototype.refreshSize=function(){};gui.AnnotatableCanvas.prototype.gui_AnnotatableCanvas_prototype$getZoomLevel=function(){};gui.AnnotatableCanvas.prototype.getSizer=function(){};
gui.AnnotationViewManager=function(g,h,c,b){function f(d){var b=d.annotationEndElement,c=l.createRange(),e=d.getAttributeNS(odf.Namespaces.officens,"name");b&&(c.setStart(d,d.childNodes.length),c.setEnd(b,0),d=a.getTextNodes(c,!1),d.forEach(function(a){var d;a:{for(d=a.parentNode;d.namespaceURI!==odf.Namespaces.officens||"body"!==d.localName;){if("http://www.w3.org/1999/xhtml"===d.namespaceURI&&"webodf-annotationHighlight"===d.className&&d.getAttribute("annotation")===e){d=!0;break a}d=d.parentNode}d=
!1}d||(d=l.createElement("span"),d.className="webodf-annotationHighlight",d.setAttribute("annotation",e),a.parentNode.replaceChild(d,a),d.appendChild(a))}));c.detach()}function m(a){var b=g.getSizer();a?(c.style.display="inline-block",b.style.paddingRight=d.getComputedStyle(c).width):(c.style.display="none",b.style.paddingRight=0);g.refreshSize()}function r(){e.sort(function(a,d){return a.compareDocumentPosition(d)&Node.DOCUMENT_POSITION_FOLLOWING?-1:1})}function p(){var a;for(a=0;a<e.length;a+=1){var d=
e[a],b=d.parentNode,f=b.nextElementSibling,l=f.nextElementSibling,m=b.parentNode,h=e[e.indexOf(d)-1],d=g.gui_AnnotatableCanvas_prototype$getZoomLevel();b.style.left=(c.getBoundingClientRect().left-m.getBoundingClientRect().left)/d+"px";b.style.width=c.getBoundingClientRect().width/d+"px";f.style.width=parseFloat(b.style.left)-30+"px";h?(h=h.parentNode.getBoundingClientRect(),20>=(m.getBoundingClientRect().top-h.bottom)/d?b.style.top=Math.abs(m.getBoundingClientRect().top-h.bottom)/d+20+"px":b.style.top=
"0px"):b.style.top="0px";l.style.left=f.getBoundingClientRect().width/d+"px";var f=l.style,p=l.getBoundingClientRect().left/d,m=l.getBoundingClientRect().top/d,q=b.getBoundingClientRect().left/d,h=b.getBoundingClientRect().top/d,p=q-p,m=h-m;f.width=Math.sqrt(p*p+m*m)+"px";b=Math.asin((b.getBoundingClientRect().top-l.getBoundingClientRect().top)/(d*parseFloat(l.style.width)));l.style.transform="rotate("+b+"rad)";l.style.MozTransform="rotate("+b+"rad)";l.style.WebkitTransform="rotate("+b+"rad)";l.style.msTransform=
"rotate("+b+"rad)"}}function q(a){var d=e.indexOf(a),b=a.parentNode.parentNode;"div"===b.localName&&(b.parentNode.insertBefore(a,b),b.parentNode.removeChild(b));a=a.getAttributeNS(odf.Namespaces.officens,"name");a=l.querySelectorAll('span.webodf-annotationHighlight[annotation="'+a+'"]');for(var c,b=0;b<a.length;b+=1){for(c=a.item(b);c.firstChild;)c.parentNode.insertBefore(c.firstChild,c);c.parentNode.removeChild(c)}-1!==d&&e.splice(d,1);e.length||m(!1)}var e=[],l=h.ownerDocument,a=odf.OdfUtils,d=
runtime.getWindow();runtime.BrowserRuntime$assert(!!d,"Expected to be run in an environment which has a global window, like a browser.");this.gui_AnnotationViewManager$rerenderAnnotations=p;this.rehighlightAnnotations=function(){e.forEach(function(a){f(a)})};this.getMinimumHeightForAnnotationPane=function(){return"none"!==c.style.display&&0<e.length?(e[e.length-1].parentNode.getBoundingClientRect().bottom-c.getBoundingClientRect().top)/g.gui_AnnotatableCanvas_prototype$getZoomLevel()+"px":null};this.addAnnotations=
function(d){d.length&&(m(!0),d.forEach(function(d){e.push(d);var c=l.createElement("div"),n=l.createElement("div"),m=l.createElement("div"),g=l.createElement("div"),h;c.className="annotationWrapper";c.setAttribute("creator",a.getAnnotationCreator(d));d.parentNode.insertBefore(c,d);n.className="annotationNote";n.appendChild(d);b&&(h=l.createElement("div"),h.className="annotationRemoveButton",n.appendChild(h));m.className="annotationConnector horizontal";g.className="annotationConnector angular";c.appendChild(n);
c.appendChild(m);c.appendChild(g);d.annotationEndElement&&f(d)}),r(),p())};this.gui_AnnotationViewManager$forgetAnnotation=q;this.forgetAnnotations=function(){for(;e.length;)q(e[0])}};gui.Viewport=function(){};gui.Viewport.prototype.gui_SingleScrollViewport$scrollIntoView=function(g,h){};
gui.SingleScrollViewport=function(g){this.gui_SingleScrollViewport$scrollIntoView=function(h,c){var b,f,m,r;r=g.offsetHeight-g.clientHeight;m=g.offsetWidth-g.clientWidth;var p=g.getBoundingClientRect();if(h&&p){b=p.left+5;f=p.top+5;m=p.right-(m+5);r=p.bottom-(r+5);if(c||h.top<f)g.scrollTop-=f-h.top;else if(h.top>r||h.bottom>r)g.scrollTop=h.bottom-h.top<=r-f?g.scrollTop+(h.bottom-r):g.scrollTop+(h.top-f);h.left<b?g.scrollLeft-=b-h.left:h.right>m&&(g.scrollLeft=h.right-h.left<=m-b?g.scrollLeft+(h.right-
m):g.scrollLeft-(b-h.left))}}};
(function(){function g(c,m,h,p,q){var e,l=0,a;for(a in c)if(c.hasOwnProperty(a)){if(l===h){e=a;break}l+=1}e?m.getPartData(c[e].href,function(a,n){if(a)runtime.log(a);else if(n){var k="@font-face { font-family: "+(c[e].family||e)+"; src: url(data:application/x-font-ttf;charset=binary;base64,"+b.convertUTF8ArrayToBase64(n)+') format("truetype"); }';try{p.insertRule(k,p.cssRules.length)}catch(l$1){runtime.log("Problem inserting rule in CSS: "+runtime.BrowserRuntime$toJson(l$1)+"\nRule: "+k)}}else runtime.log("missing font data for "+
c[e].href);g(c,m,h+1,p,q)}):q&&q()}var h=xmldom.XPath,c=odf.OdfUtils,b=new core.Base64;odf.FontLoader=function(){this.loadFonts=function(b,m){for(var r=b.rootElement.fontFaceDecls;m.cssRules.length;)m.deleteRule(m.cssRules.length-1);if(r){var p={},q,e,l,a;if(r)for(r=h.getODFElementsWithXPath(r,"style:font-face[svg:font-face-src]",odf.Namespaces.lookupNamespaceURI),q=0;q<r.length;q+=1)e=r[q],l=e.getAttributeNS(odf.Namespaces.stylens,"name"),a=c.getNormalizedFontFamilyName(e.getAttributeNS(odf.Namespaces.svgns,
"font-family")),e=h.getODFElementsWithXPath(e,"svg:font-face-src/svg:font-face-uri",odf.Namespaces.lookupNamespaceURI),0<e.length&&(e=e[0].getAttributeNS(odf.Namespaces.xlinkns,"href"),p[l]={href:e,family:a});g(p,b,0,m)}}}})();
odf.Formatting=function(){function g(a){var d;(a=D[a])?d=v.mergeObjects({},a):d={};return d}function h(){for(var d=a.rootElement.fontFaceDecls,b={},c,e,d=d&&d.firstElementChild;d;){if(c=d.getAttributeNS(k,"name"))if((e=d.getAttributeNS(n,"font-family"))||0<d.getElementsByTagNameNS(n,"font-face-uri").length)b[c]=e;d=d.nextElementSibling}return b}function c(d){for(var b=a.rootElement.styles.firstElementChild;b;){if(b.namespaceURI===k&&"default-style"===b.localName&&b.getAttributeNS(k,"family")===d)return b;
b=b.nextElementSibling}return null}function b(d,b,c){var e,n,f;c=c||[a.rootElement.automaticStyles,a.rootElement.styles];for(f=0;f<c.length;f+=1)for(e=c[f],e=e.firstElementChild;e;){n=e.getAttributeNS(k,"name");if(e.namespaceURI===k&&"style"===e.localName&&e.getAttributeNS(k,"family")===b&&n===d||"list-style"===b&&e.namespaceURI===y&&"list-style"===e.localName&&n===d||"data"===b&&e.namespaceURI===u&&n===d)return e;e=e.nextElementSibling}return null}function f(a){for(var d,b,c,e,n={},f=a.firstElementChild;f;){if(f.namespaceURI===
k)for(c=n[f.nodeName]={},b=f.attributes,d=0;d<b.length;d+=1)e=b.item(d),c[e.name]=e.value;f=f.nextElementSibling}b=a.attributes;for(d=0;d<b.length;d+=1)e=b.item(d),n[e.name]=e.value;return n}function m(d,e){for(var n=a.rootElement.styles,l,m={},h=d.getAttributeNS(k,"family"),p=d;p;)l=f(p),m=v.mergeObjects(l,m),(l=p.getAttributeNS(k,"parent-style-name"))?p=b(l,h,[n]):p=null;if(p=c(h))l=f(p),m=v.mergeObjects(l,m);!1!==e&&(l=g(h),m=v.mergeObjects(l,m));return m}function r(b,c){function e(a){Object.keys(a).forEach(function(d){Object.keys(a[d]).forEach(function(a){l+=
"|"+d+":"+a+"|"})})}for(var k=b.nodeType===Node.TEXT_NODE?b.parentNode:b,n,f=[],l="",m=!1;k&&!x.isInlineRoot(k)&&k.parentNode!==a.rootElement;)!m&&x.isGroupingElement(k)&&(m=!0),(n=d.determineStylesForNode(k))&&f.push(n),k=k.parentNode;m&&(f.forEach(e),c&&(c[l]=f));return m?f:void 0}function p(d){var c={orderedStyles:[],styleProperties:{}};d.forEach(function(d){Object.keys(d).forEach(function(e){var n=Object.keys(d[e])[0],f={name:n,family:e,displayName:void 0,isCommonStyle:!1},l;(l=b(n,e))?(e=m(l),
c.styleProperties=v.mergeObjects(e,c.styleProperties),f.displayName=l.getAttributeNS(k,"display-name")||void 0,f.isCommonStyle=l.parentNode===a.rootElement.styles):runtime.log("No style element found for '"+n+"' of family '"+e+"'");c.orderedStyles.push(f)})});return c}function q(a,d){var b={},c=[];d||(d={});a.forEach(function(a){r(a,b)});Object.keys(b).forEach(function(a){d[a]||(d[a]=p(b[a]));c.push(d[a])});return c}function e(d){for(var b=a.rootElement.masterStyles.firstElementChild;b&&(b.namespaceURI!==
k||"master-page"!==b.localName||b.getAttributeNS(k,"name")!==d);)b=b.nextElementSibling;return b}function l(a,d){var b;a&&(b=t.convertMeasure(a,"px"));void 0===b&&d&&(b=t.convertMeasure(d,"px"));return b}var a,d=new odf.StyleInfo,n=odf.Namespaces.svgns,k=odf.Namespaces.stylens,y=odf.Namespaces.textns,u=odf.Namespaces.numberns,z=odf.Namespaces.fons,x=odf.OdfUtils,w=core.DomUtils,v=new core.Utils,t=new core.CSSUnits,D={paragraph:{"style:paragraph-properties":{"fo:text-align":"left"}}};this.getSystemDefaultStyleAttributes=
g;this.odf_Formatting$setOdfContainer=function(d){a=d};this.getFontMap=h;this.getAvailableParagraphStyles=function(){for(var d=a.rootElement.styles,b,c,e=[],d=d&&d.firstElementChild;d;)"style"===d.localName&&d.namespaceURI===k&&(b=d.getAttributeNS(k,"family"),"paragraph"===b&&(b=d.getAttributeNS(k,"name"),c=d.getAttributeNS(k,"display-name")||b,b&&c&&e.push({name:b,displayName:c}))),d=d.nextElementSibling;return e};this.isStyleUsed=function(b){var c,e=a.rootElement;c=d.hasDerivedStyles(e,odf.Namespaces.lookupNamespaceURI,
b);b=(new d.UsedStyleList(e.styles)).uses(b)||(new d.UsedStyleList(e.automaticStyles)).uses(b)||(new d.UsedStyleList(e.body)).uses(b);return c||b};this.getDefaultStyleElement=c;this.getStyleElement=b;this.getStyleAttributes=f;this.getInheritedStyleAttributes=m;this.getFirstCommonParentStyleNameOrSelf=function(d){var c=a.rootElement.styles,e;if(e=b(d,"paragraph",[a.rootElement.automaticStyles]))if(d=e.getAttributeNS(k,"parent-style-name"),!d)return null;return(e=b(d,"paragraph",[c]))?d:null};this.hasParagraphStyle=
function(a){return!!b(a,"paragraph")};this.odf_Formatting$getAppliedStyles=q;this.getAppliedStylesForElement=function(a,d){return q([a],d)[0]};this.updateStyle=function(d,b){var c,e;w.mapObjOntoNode(d,b,odf.Namespaces.lookupNamespaceURI);(c=(c=b["style:text-properties"])&&c["style:font-name"])&&!h().hasOwnProperty(c)&&(e=d.ownerDocument.createElementNS(k,"style:font-face"),e.setAttributeNS(k,"style:name",c),e.setAttributeNS(n,"svg:font-family",c),a.rootElement.fontFaceDecls.appendChild(e))};this.createDerivedStyleObject=
function(d,c,e){var k=b(d,c),n;runtime.BrowserRuntime$assert(!!k,"No style element found for '"+d+"' of family '"+c+"'");k.parentNode===a.rootElement.styles?n={"style:parent-style-name":d}:n=f(k);n["style:family"]=c;v.mergeObjects(n,e);return n};this.getDefaultTabStopDistance=function(){for(var a=c("paragraph"),a=a&&a.firstElementChild,d;a;)a.namespaceURI===k&&"paragraph-properties"===a.localName&&(d=a.getAttributeNS(k,"tab-stop-distance")),a=a.nextElementSibling;d||(d="1.25cm");return x.parseNonNegativeLength(d)};
this.getMasterPageElement=e;this.getContentSize=function(d,c){var n,f,m,g,h,p,q,r,y,v;a:{f=b(d,c);runtime.BrowserRuntime$assert("paragraph"===c||"table"===c,"styleFamily must be either paragraph or table");if(f){if(f=f.getAttributeNS(k,"master-page-name"))(n=e(f))||runtime.log("WARN: No master page definition found for "+f);n||(n=e("Standard"));n||(n=a.rootElement.masterStyles.getElementsByTagNameNS(k,"master-page")[0])||runtime.log("WARN: Document has no master pages defined");if(n)for(f=n.getAttributeNS(k,
"page-layout-name"),m=a.rootElement.automaticStyles.getElementsByTagNameNS(k,"page-layout"),g=0;g<m.length;g+=1)if(n=m.item(g),n.getAttributeNS(k,"name")===f)break a}n=null}n||(n=w.getDirectChild(a.rootElement.styles,k,"default-page-layout"));(n=w.getDirectChild(n,k,"page-layout-properties"))?("landscape"===n.getAttributeNS(k,"print-orientation")?(f="29.7cm",m="21.001cm"):(f="21.001cm",m="29.7cm"),f=l(n.getAttributeNS(z,"page-width"),f),m=l(n.getAttributeNS(z,"page-height"),m),g=l(n.getAttributeNS(z,
"margin")),void 0===g?(g=l(n.getAttributeNS(z,"margin-left"),"2cm"),h=l(n.getAttributeNS(z,"margin-right"),"2cm"),p=l(n.getAttributeNS(z,"margin-top"),"2cm"),q=l(n.getAttributeNS(z,"margin-bottom"),"2cm")):g=h=p=q=g,r=l(n.getAttributeNS(z,"padding")),void 0===r?(r=l(n.getAttributeNS(z,"padding-left"),"0cm"),y=l(n.getAttributeNS(z,"padding-right"),"0cm"),v=l(n.getAttributeNS(z,"padding-top"),"0cm"),n=l(n.getAttributeNS(z,"padding-bottom"),"0cm")):r=y=v=n=r):(f=l("21.001cm"),m=l("29.7cm"),g=h=p=q=g=
l("2cm"),r=y=v=n=r=l("0cm"));return{width:f-g-h-r-y,height:m-p-q-v-n}}};
(function(){var g=odf.Namespaces.stylens,h=odf.Namespaces.textns,c={graphic:"draw","drawing-page":"draw",paragraph:"text",presentation:"presentation",ruby:"text",section:"text",table:"table","table-cell":"table","table-column":"table","table-row":"table",text:"text",list:"text",page:"office"};odf.StyleTreeNode=function(b){this.derivedStyles={};this.odf_StyleTreeNode$element=b};odf.StyleTree=function(b,f){function m(b){var a,d,c,e={};if(!b)return e;for(b=b.firstElementChild;b;)b.namespaceURI!==g||
"style"!==b.localName&&"default-style"!==b.localName?b.namespaceURI===h&&"list-style"===b.localName?d="list":b.namespaceURI!==g||"page-layout"!==b.localName&&"default-page-layout"!==b.localName?d=void 0:d="page":d=b.getAttributeNS(g,"family"),d&&((a=b.getAttributeNS(g,"name"))||(a=""),e.hasOwnProperty(d)?c=e[d]:e[d]=c={},c[a]=b),b=b.nextElementSibling;return e}function r(b,a){if(b.hasOwnProperty(a))return b[a];var d=null,c=Object.keys(b),e;for(e=0;e<c.length&&!(d=r(b[c[e]].derivedStyles,a));e+=1);
return d}function p(b,a,d){var c,e,f;if(!a.hasOwnProperty(b))return null;c=new odf.StyleTreeNode(a[b]);e=c.odf_StyleTreeNode$element.getAttributeNS(g,"parent-style-name");f=null;e&&(f=r(d,e)||p(e,a,d));f?f.derivedStyles[b]=c:d[b]=c;delete a[b];return c}function q(b,a){b&&Object.keys(b).forEach(function(d){p(d,b,a)})}var e={};this.getStyleTree=function(){return e};(function(){var l,a,d;a=m(b);d=m(f);Object.keys(c).forEach(function(b){l=e[b]={};q(a[b],l);q(d[b],l)})})()}})();
(function(){function g(b,c){try{b.insertRule(c,b.cssRules.length)}catch(f$2){runtime.log("cannot load rule: "+c+" - "+f$2)}}function h(b,c){this.listCounterCount=0;this.contentRules=b;this.counterIdStack=[];this.continuedCounterIdStack=c}function c(b){function c(d,k,f,l){var h=k.namespaceURI===m&&"list"===k.localName,p=k.namespaceURI===m&&"list-item"===k.localName;if(h||p){if(h){var h=f+=1,r,v,t;l.listCounterCount+=1;p=d+"-level"+h+"-"+l.listCounterCount;k.setAttributeNS("urn:webodf:names:helper",
"counter-id",p);r=l.continuedCounterIdStack.shift();r||(r=p,a+=p+" 1 ",v='text|list[webodfhelper|counter-id="'+p+'"] > text|list-item:first-child > :not(text|list):first-child:before{',v+="counter-increment: "+r+" 0;",v+="}",g(b,v));for(;l.counterIdStack.length>=h;)l.counterIdStack.pop();l.counterIdStack.push(r);t=l.contentRules[h.toString()]||"";for(v=1;v<=h;v+=1)t=t.replace(v+"webodf-listLevel",l.counterIdStack[v-1]);v='text|list[webodfhelper|counter-id="'+p+'"] > text|list-item > :not(text|list):first-child:before{';
v+=t;v+="counter-increment: "+r+";";v+="}";g(b,v)}for(k=k.firstElementChild;k;)c(d,k,f,l),k=k.nextElementSibling}else l.continuedCounterIdStack=[]}var f=0,a="",d={};this.createCounterRules=function(a,b,m){var g=b.getAttributeNS(r,"id"),p=[];m&&(m=m.getAttributeNS("urn:webodf:names:helper","counter-id"),p=d[m].slice(0));a=new h(a,p);g?g="Y"+g:(f+=1,g="X"+f);c(g,b,0,a);d[g+"-level1-1"]=a.counterIdStack};this.initialiseCreatedCounters=function(){g(b,"office|document{"+("counter-reset: "+a+";")+"}")}}
var b=odf.Namespaces.fons,f=odf.Namespaces.stylens,m=odf.Namespaces.textns,r=odf.Namespaces.xmlns,p={1:"decimal",a:"lower-latin",A:"upper-latin",i:"lower-roman",I:"upper-roman"};odf.ListStyleToCss=function(){function h(a){var b=n.odf_OdfUtilsImpl$parseLength(a);return b?d.convert(b.value,b.unit,"px"):(runtime.log("Could not parse value '"+a+"'."),0)}function e(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function l(a,d){var b;a&&(b=a.getAttributeNS(m,"style-name"));return b===d}function a(a,
d,b){d=d.getElementsByTagNameNS(m,"list");a=new c(a);var n,g,h,q,t,D,J={},A;for(A=0;A<d.length;A+=1)if(n=d.item(A),D=n.getAttributeNS(m,"style-name")){h=n.getAttributeNS(m,"continue-numbering");q=n.getAttributeNS(m,"continue-list");(t=n.getAttributeNS(r,"id"))&&(J[t]=n);t=b[D].odf_StyleTreeNode$element.firstElementChild;for(var L,S={};t;){L=(L=t.getAttributeNS(m,"level"))&&parseInt(L,10);var K=t,R="",B,V=void 0;if("list-level-style-number"===K.localName){var U=K,R=U.getAttributeNS(f,"num-format");
B=U.getAttributeNS(f,"num-suffix")||"";var M=U.getAttributeNS(f,"num-prefix")||"",P="",N=U.getAttributeNS(m,"level"),U=U.getAttributeNS(m,"display-levels");M&&(P+='"'+e(M)+'"\n');if(p.hasOwnProperty(R))for(N=N?parseInt(N,10):1,U=U?parseInt(U,10):1;0<U;)P+=" counter("+(N-U+1)+"webodf-listLevel,"+p[R]+")",1<U&&(P+='"."'),--U;else P=R?P+(' "'+R+'"'):P+' ""';R="content:"+P+' "'+e(B)+'"'}else"list-level-style-image"===K.localName?R="content: none":"list-level-style-bullet"===K.localName&&(R=K.getAttributeNS(m,
"bullet-char"),R='content: "'+e(R)+'"');if(K=K.getElementsByTagNameNS(f,"list-level-properties")[0])B=K.getAttributeNS(m,"list-level-position-and-space-mode"),"label-alignment"===B&&((K=K.getElementsByTagNameNS(f,"list-level-label-alignment")[0])&&(V=K.getAttributeNS(m,"label-followed-by")),"space"===V&&(R+=' "\\a0"'));S[L]="\n"+R+";\n";t=t.nextElementSibling}t=S;h&&!q&&l(g,D)?a.createCounterRules(t,n,g):q&&l(J[q],D)?a.createCounterRules(t,n,J[q]):a.createCounterRules(t,n);g=n}a.initialiseCreatedCounters()}
var d=new core.CSSUnits,n=odf.OdfUtils;this.applyListStyles=function(d,c,e){var n,l;(n=c.list)&&Object.keys(n).forEach(function(a){l=n[a];for(var c=l.odf_StyleTreeNode$element.firstElementChild;c;){if(c.namespaceURI===m){var e=d,p=c,r='text|list[text|style-name="'+a+'"]',y=p.getAttributeNS(m,"level"),u,S,K,R=void 0,B=void 0,V=void 0,U=void 0,p=(u=p.getElementsByTagNameNS(f,"list-level-properties")[0])&&u.getAttributeNS(m,"list-level-position-and-space-mode");S=u&&u.getElementsByTagNameNS(f,"list-level-label-alignment")[0];
for(y=y&&parseInt(y,10);1<y;)r+=" > text|list-item > text|list",--y;y=u&&u.getAttributeNS(b,"text-align")||"left";switch(y){case "end":y="right";break;case "start":y="left"}"label-alignment"===p?(K=S&&S.getAttributeNS(b,"margin-left")||"0px",V=S&&S.getAttributeNS(b,"text-indent")||"0px",U=S&&S.getAttributeNS(m,"label-followed-by"),S=h(K)):(K=u&&u.getAttributeNS(m,"space-before")||"0px",R=u&&u.getAttributeNS(m,"min-label-width")||"0px",B=u&&u.getAttributeNS(m,"min-label-distance")||"0px",S=h(K)+h(R));
u=r+" > text|list-item{";u+="margin-left: "+S+"px;";u+="}";g(e,u);u=r+" > text|list-item > text|list{";u+="margin-left: "+-S+"px;";u+="}";g(e,u);u=r+" > text|list-item > :not(text|list):first-child:before{";u+="text-align: "+y+";";u+="display: inline-block;";"label-alignment"===p?(u+="margin-left: "+V+";","listtab"===U&&(u+="padding-right: 0.2cm;")):(u+="min-width: "+R+";",u+="margin-left: "+(parseFloat(R)?"-":"")+R+";",u+="padding-right: "+B+";");u+="}";g(e,u)}c=c.nextElementSibling}});a(d,e,n)}}})();
odf.LazyStyleProperties=function(g,h){var c={};this.value=function(b){var f;c.hasOwnProperty(b)?f=c[b]:(f=h[b](),void 0===f&&g&&(f=g.value(b)),c[b]=f);return f};this.odf_LazyStyleProperties$reset=function(b){g=b;c={}}};
odf.StyleParseUtils=function(){function g(c){var b,f;c=(c=/(-?[0-9]*[0-9][0-9]*(\.[0-9]*)?|0+\.[0-9]*[1-9][0-9]*|\.[0-9]*[1-9][0-9]*)((cm)|(mm)|(in)|(pt)|(pc)|(px))/.exec(c))?{value:parseFloat(c[1]),unit:c[3]}:null;f=c&&c.unit;"px"===f?b=c.value:"cm"===f?b=c.value/2.54*96:"mm"===f?b=c.value/25.4*96:"in"===f?b=96*c.value:"pt"===f?b=c.value/.75:"pc"===f&&(b=16*c.value);return b}var h=odf.Namespaces.stylens;this.odf_StyleParseUtils$parseLength=g;this.parsePositiveLengthOrPercent=function(c,b,f){var m;
c&&(m=parseFloat(c.substr(0,c.indexOf("%"))),isNaN(m)&&(m=void 0));var h;void 0!==m?(f&&(h=f.value(b)),void 0===h?m=void 0:m*=h/100):m=g(c);return m};this.getPropertiesElement=function(c,b,f){for(b=f?f.nextElementSibling:b.firstElementChild;b&&(b.localName!==c||b.namespaceURI!==h);)b=b.nextElementSibling;return b};this.parseAttributeList=function(c){c&&(c=c.replace(/^\s*(.*?)\s*$/g,"$1"));return c&&0<c.length?c.split(/\s+/):[]}};
odf.Style2CSS=function(){function g(a,d,b){var c=[];b=b.derivedStyles;var e;var k=z[a],n;void 0===k?d=null:(n=d?"["+k+'|style-name="'+d+'"]':"","presentation"===k&&(k="draw",n=d?'[presentation|style-name="'+d+'"]':""),d=k+"|"+x[a].join(n+","+k+"|")+n);null!==d&&c.push(d);for(e in b)b.hasOwnProperty(e)&&(d=g(a,e,b[e]),c=c.concat(d));return c}function h(a){var d;if("default-style"===a.localName)return null;d=a.getAttributeNS(l,"parent-style-name");a=a.getAttributeNS(l,"family");return W.getODFElementsWithXPath(N,
d?"//style:*[@style:name='"+d+"'][@style:family='"+a+"']":"//style:default-style[@style:family='"+a+"']",odf.Namespaces.lookupNamespaceURI)[0]}function c(a,d){var b="",c,e,k;for(c=0;c<d.length;c+=1)if(e=d[c],k=a.getAttributeNS(e[0],e[1])){k=k.trim();if(B.hasOwnProperty(e[1])){var n=k;k=n.indexOf(" ");var f;-1!==k?(f=n.substring(0,k),k=n.substring(k)):(f=n,k="");(f=M.odf_OdfUtilsImpl$parseLength(f))&&"pt"===f.unit&&.75>f.value&&(n="0.75pt"+k);k=n}else if(V.hasOwnProperty(e[1])){var m=a,n=e[0];f=e[1];
var g=M.odf_OdfUtilsImpl$parseLength(k),p;if(g&&"%"===g.unit){k=g.value/100;m=h(m.parentNode);for(g="0";m;){if(p=y.getDirectChild(m,l,"paragraph-properties"))if(p=M.odf_OdfUtilsImpl$parseLength(p.getAttributeNS(n,f))){if("%"!==p.unit){g=p.value*k+p.unit;break}k*=p.value/100}m=h(m)}k=g}}e[2]&&(b+=e[2]+":"+k+";")}return b}function b(a,d,b,c){return d+d+b+b+c+c}function f(a,d){var b=[a],c=d.derivedStyles;Object.keys(c).forEach(function(a){a=f(a,c[a]);b=b.concat(a)});return b}function m(a,d,b,c){function e(d,
b){var c=[],k;d.forEach(function(a){n.forEach(function(d){c.push('draw|page[webodfhelper|page-style-name="'+d+'"] draw|frame[presentation|class="'+a+'"]')})});0<c.length&&(k=c.join(",")+"{visibility:"+b+";}",a.insertRule(k,a.cssRules.length))}var n=f(d,c),l=[],m=[];["page-number","date-time","header","footer"].forEach(function(a){var d;d=b.getAttributeNS(k,"display-"+a);"true"===d?l.push(a):"false"===d&&m.push(a)});e(l,"visible");e(m,"hidden")}function r(a,f,B,V){var x,z;if("page"===f){var E=V.odf_StyleTreeNode$element,
N="",H,F;B=y.getDirectChild(E,l,"page-layout-properties");var W;if(B)if(W=E.getAttributeNS(l,"name"),N+=c(B,K),(H=y.getDirectChild(B,l,"background-image"))&&(F=H.getAttributeNS(n,"href"))&&(N=N+("background-image: url('odfkit:"+F+"');")+c(H,v)),"presentation"===P)for(H=(E=y.getDirectChild(E.parentNode.parentNode,e,"master-styles"))&&E.firstElementChild;H;)H.namespaceURI===l&&"master-page"===H.localName&&H.getAttributeNS(l,"page-layout-name")===W&&(F=H.getAttributeNS(l,"name"),E='draw|page[draw|master-page-name="'+
F+'"] {'+N+"}",F='office|body, draw|page[draw|master-page-name="'+F+'"] {'+c(B,R)+" }",a.insertRule(E,a.cssRules.length),a.insertRule(F,a.cssRules.length)),H=H.nextElementSibling;else"text"===P&&(E="office|text {"+N+"}",F="office|body {width: "+B.getAttributeNS(q,"page-width")+";}",a.insertRule(E,a.cssRules.length),a.insertRule(F,a.cssRules.length))}else{N=g(f,B,V).join(",");W="";if(E=y.getDirectChild(V.odf_StyleTreeNode$element,l,"text-properties")){var O=E,aa=z="";H="";F=1;E=""+c(O,w);x=O.getAttributeNS(l,
"text-underline-style");"solid"===x&&(z+=" underline");x=O.getAttributeNS(l,"text-line-through-style");"solid"===x&&(z+=" line-through");z.length&&(E=E+("text-decoration:"+z+";\n")+("text-decoration-line:"+z+";\n")+("-moz-text-decoration-line:"+z+";\n"));x=O.getAttributeNS(l,"text-line-through-type");switch(x){case "double":aa+=" double";break;case "single":aa+=" single"}aa&&(E=E+("text-decoration-style:"+aa+";\n")+("-moz-text-decoration-style:"+aa+";\n"));if(z=O.getAttributeNS(l,"font-name")||O.getAttributeNS(q,
"font-family"))x=U[z],E+="font-family: "+(x||z)+";";if(x=O.getAttributeNS(l,"text-position"))z=u.parseAttributeList(x),x=z[0],z=z[1],E+="vertical-align: "+x+"\n; ",z&&(F=parseFloat(z)/100);if(O.hasAttributeNS(q,"font-size")||1!==F){for(O=O.parentNode;O;){if(x=(x=y.getDirectChild(O,l,"text-properties"))?M.parseFoFontSize(x.getAttributeNS(q,"font-size")):null){if("%"!==x.unit){H="font-size: "+x.value*F+x.unit+";";break}F*=x.value/100}O=h(O)}H||(H="font-size: "+parseFloat(Y)*F+fa.getUnits(Y)+";")}E+=
H;W+=E}if(E=y.getDirectChild(V.odf_StyleTreeNode$element,l,"paragraph-properties"))H=E,E=""+c(H,t),(F=y.getDirectChild(H,l,"background-image"))&&(O=F.getAttributeNS(n,"href"))&&(E=E+("background-image: url('odfkit:"+O+"');")+c(F,v)),(H=H.getAttributeNS(q,"line-height"))&&"normal"!==H&&(H=M.parseFoLineHeight(H),E="%"!==H.unit?E+("line-height: "+H.value+H.unit+";"):E+("line-height: "+H.value/100+";")),W+=E;if(E=y.getDirectChild(V.odf_StyleTreeNode$element,l,"graphic-properties"))O=E,E=""+c(O,D),H=O.getAttributeNS(p,
"opacity"),F=O.getAttributeNS(p,"fill"),O=O.getAttributeNS(p,"fill-color"),"solid"===F||"hatch"===F?O&&"none"!==O?(H=isNaN(parseFloat(H))?1:parseFloat(H)/100,F=O.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,b),(O=(F=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(F))?{r:parseInt(F[1],16),g:parseInt(F[2],16),b:parseInt(F[3],16)}:null)&&(E+="background-color: rgba("+O.r+","+O.g+","+O.b+","+H+");")):E+="background: none;":"none"===F&&(E+="background: none;"),W+=E;if(E=y.getDirectChild(V.odf_StyleTreeNode$element,
l,"drawing-page-properties"))H=E,F=""+c(H,D),"true"===H.getAttributeNS(k,"background-visible")&&(F+="background: none;"),W+=F,m(a,B,E,V);(E=y.getDirectChild(V.odf_StyleTreeNode$element,l,"table-cell-properties"))&&(W+=""+c(E,J));(E=y.getDirectChild(V.odf_StyleTreeNode$element,l,"table-row-properties"))&&(W+=""+c(E,L));(E=y.getDirectChild(V.odf_StyleTreeNode$element,l,"table-column-properties"))&&(W+=""+c(E,A));if(E=y.getDirectChild(V.odf_StyleTreeNode$element,l,"table-properties"))B=W,W=""+c(E,S),
E=E.getAttributeNS(d,"border-model"),"collapsing"===E?W+="border-collapse:collapse;":"separating"===E&&(W+="border-collapse:separate;"),W=B+W;W.length&&a.insertRule(N+"{"+W+"}",a.cssRules.length)}for(var ga in V.derivedStyles)V.derivedStyles.hasOwnProperty(ga)&&r(a,f,ga,V.derivedStyles[ga])}var p=odf.Namespaces.drawns,q=odf.Namespaces.fons,e=odf.Namespaces.officens,l=odf.Namespaces.stylens,a=odf.Namespaces.svgns,d=odf.Namespaces.tablens,n=odf.Namespaces.xlinkns,k=odf.Namespaces.presentationns,y=core.DomUtils,
u=new odf.StyleParseUtils,z={graphic:"draw","drawing-page":"draw",paragraph:"text",presentation:"presentation",ruby:"text",section:"text",table:"table","table-cell":"table","table-column":"table","table-row":"table",text:"text",list:"text",page:"office"},x={graphic:"circle connected control custom-shape ellipse frame g line measure page page-thumbnail path polygon polyline rect regular-polygon".split(" "),paragraph:"alphabetical-index-entry-template h illustration-index-entry-template index-source-style object-index-entry-template p table-index-entry-template table-of-content-entry-template user-index-entry-template".split(" "),
presentation:"caption circle connector control custom-shape ellipse frame g line measure page-thumbnail path polygon polyline rect regular-polygon".split(" "),"drawing-page":"caption circle connector control page custom-shape ellipse frame g line measure page-thumbnail path polygon polyline rect regular-polygon".split(" "),ruby:["ruby","ruby-text"],section:"alphabetical-index bibliography illustration-index index-title object-index section table-of-content table-index user-index".split(" "),table:["background",
"table"],"table-cell":"body covered-table-cell even-columns even-rows first-column first-row last-column last-row odd-columns odd-rows table-cell".split(" "),"table-column":["table-column"],"table-row":["table-row"],text:"a index-entry-chapter index-entry-link-end index-entry-link-start index-entry-page-number index-entry-span index-entry-tab-stop index-entry-text index-title-template linenumbering-configuration list-level-style-number list-level-style-bullet outline-level-style span".split(" "),
list:["list-item"]},w=[[q,"color","color"],[q,"background-color","background-color"],[q,"font-weight","font-weight"],[q,"font-style","font-style"],[q,"font-variant","font-variant"],[q,"letter-spacing","letter-spacing"],[q,"text-transform","text-transform"],[q,"text-shadow","text-shadow"]],v=[[l,"repeat","background-repeat"]],t=[[q,"background-color","background-color"],[q,"text-align","text-align"],[q,"text-indent","text-indent"],[q,"padding","padding"],[q,"padding-left","padding-left"],[q,"padding-right",
"padding-right"],[q,"padding-top","padding-top"],[q,"padding-bottom","padding-bottom"],[q,"border-left","border-left"],[q,"border-right","border-right"],[q,"border-top","border-top"],[q,"border-bottom","border-bottom"],[q,"margin","margin"],[q,"margin-left","margin-left"],[q,"margin-right","margin-right"],[q,"margin-top","margin-top"],[q,"margin-bottom","margin-bottom"],[q,"border","border"]],D=[[q,"background-color","background-color"],[q,"min-height","min-height"],[p,"stroke","border"],[a,"stroke-color",
"border-color"],[a,"stroke-width","border-width"],[q,"border","border"],[q,"border-left","border-left"],[q,"border-right","border-right"],[q,"border-top","border-top"],[q,"border-bottom","border-bottom"]],J=[[q,"background-color","background-color"],[q,"border-left","border-left"],[q,"border-right","border-right"],[q,"border-top","border-top"],[q,"border-bottom","border-bottom"],[q,"border","border"]],A=[[l,"column-width","width"]],L=[[l,"row-height","height"],[q,"keep-together",null]],S=[[l,"width",
"width"],[q,"margin-left","margin-left"],[q,"margin-right","margin-right"],[q,"margin-top","margin-top"],[q,"margin-bottom","margin-bottom"]],K=[[q,"background-color","background-color"],[q,"padding","padding"],[q,"padding-left","padding-left"],[q,"padding-right","padding-right"],[q,"padding-top","padding-top"],[q,"padding-bottom","padding-bottom"],[q,"border","border"],[q,"border-left","border-left"],[q,"border-right","border-right"],[q,"border-top","border-top"],[q,"border-bottom","border-bottom"],
[q,"margin","margin"],[q,"margin-left","margin-left"],[q,"margin-right","margin-right"],[q,"margin-top","margin-top"],[q,"margin-bottom","margin-bottom"]],R=[[q,"page-width","width"],[q,"page-height","height"]],B={border:!0,"border-left":!0,"border-right":!0,"border-top":!0,"border-bottom":!0,"stroke-width":!0},V={margin:!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"margin-bottom":!0},U={},M=odf.OdfUtils,P,N,Y,W=xmldom.XPath,fa=new core.CSSUnits;this.style2css=function(a,d,b,c,e){function k(a,
d){n="@namespace "+a+" url("+d+");";try{b.insertRule(n,b.cssRules.length)}catch(c$3){}}var n,f,l;for(N=d;b.cssRules.length;)b.deleteRule(b.cssRules.length-1);odf.Namespaces.forEachPrefix(k);k("webodfhelper","urn:webodf:names:helper");U=c;P=a;Y=runtime.getWindow().getComputedStyle(document.body,null).getPropertyValue("font-size")||"12pt";for(l in z)if(z.hasOwnProperty(l))for(f in a=e[l],a)a.hasOwnProperty(f)&&r(b,l,f,a[f])}};
(function(){function g(h,c){var b=this;this.getDistance=function(c){var m=b.x-c.x;c=b.y-c.y;return Math.sqrt(m*m+c*c)};this.getCenter=function(c){return new g((b.x+c.x)/2,(b.y+c.y)/2)};b.x=h;b.y=c}gui.ZoomHelper=function(){function h(a,b,c,e){a=e?"translate3d("+a+"px, "+b+"px, 0) scale3d("+c+", "+c+", 1)":"translate("+a+"px, "+b+"px) scale("+c+")";d.style.WebkitTransform=a;d.style.MozTransform=a;d.style.msTransform=a;d.style.OTransform=a;d.style.transform=a}function c(a){a?h(-n.x,-n.y,u,!0):(h(0,
0,u,!0),h(0,0,u,!1))}function b(a){if(x&&J){var d=x.style.overflow,b=x.classList.contains("webodf-customScrollbars");a&&b||!a&&!b||(a?(x.classList.add("webodf-customScrollbars"),x.style.overflow="hidden",runtime.BrowserRuntime$requestAnimationFrame(function(){x.style.overflow=d})):x.classList.remove("webodf-customScrollbars"))}}function f(){h(-n.x,-n.y,u,!0);x.scrollLeft=0;x.scrollTop=0;A=w.style.overflow;w.style.overflow="visible";b(!1)}function m(){h(0,0,u,!0);x.scrollLeft=n.x;x.scrollTop=n.y;w.style.overflow=
A||"";b(!0)}function r(a){return new g(a.pageX-d.offsetLeft,a.pageY-d.offsetTop)}function p(a){k&&(n.x-=a.x-k.x,n.y-=a.y-k.y,n=new g(Math.min(Math.max(n.x,d.offsetLeft),(d.offsetLeft+d.offsetWidth)*u-x.clientWidth),Math.min(Math.max(n.y,d.offsetTop),(d.offsetTop+d.offsetHeight)*u-x.clientHeight)));k=a}function q(a){var d=a.touches.length,b=0<d?r(a.touches[0]):null;a=1<d?r(a.touches[1]):null;b&&a?(y=b.getDistance(a),z=u,k=b.getCenter(a),f(),D=t.PINCH):b&&(k=b,D=t.SCROLL)}function e(a){var b=a.touches.length,
e=0<b?r(a.touches[0]):null,b=1<b?r(a.touches[1]):null;if(e&&b)if(a.preventDefault(),D===t.SCROLL)D=t.PINCH,f(),y=e.getDistance(b);else{a=e.getCenter(b);e=e.getDistance(b)/y;p(a);var b=u,k=Math.min(4,d.offsetParent.clientWidth/d.offsetWidth);u=z*e;u=Math.min(Math.max(u,k),4);e=u/b;n.x+=(e-1)*(a.x+n.x);n.y+=(e-1)*(a.y+n.y);c(!0)}else e&&(D===t.PINCH?(D=t.SCROLL,m()):p(e))}function l(){D===t.PINCH&&(v.core_EventNotifier$emit(gui.ZoomHelper.signalZoomChanged,u),m(),c(!1));D=t.NONE}function a(){x&&(x.removeEventListener("touchstart",
q,!1),x.removeEventListener("touchmove",e,!1),x.removeEventListener("touchend",l,!1))}var d,n,k,y,u,z,x,w,v=new core.EventNotifier([gui.ZoomHelper.signalZoomChanged]),t={NONE:0,SCROLL:1,PINCH:2},D=t.NONE,J=runtime.getWindow().hasOwnProperty("ontouchstart"),A="";this.gui_ZoomHelper$subscribe=function(a,d){v.core_EventNotifier$subscribe(a,d)};this.unsubscribe=function(a,d){v.unsubscribe(a,d)};this.gui_ZoomHelper$getZoomLevel=function(){return u};this.gui_ZoomHelper$setZoomLevel=function(a){d&&(u=a,
c(!1),v.core_EventNotifier$emit(gui.ZoomHelper.signalZoomChanged,u))};this.destroy=function(d){a();b(!1);d()};this.setZoomableElement=function(k){a();d=k;x=d.offsetParent;w=d.parentNode;c(!1);x&&(x.addEventListener("touchstart",q,!1),x.addEventListener("touchmove",e,!1),x.addEventListener("touchend",l,!1));b(!0)};z=u=1;n=new g(0,0)};gui.ZoomHelper.signalZoomChanged="zoomChanged"})();ops.Canvas=function(){};ops.Canvas.prototype.gui_AnnotatableCanvas_prototype$getZoomLevel=function(){};
ops.Canvas.prototype.getElement=function(){};ops.Canvas.prototype.getSizer=function(){};ops.Canvas.prototype.getZoomHelper=function(){};
(function(){function g(){function a(c){b=!0;runtime.BrowserRuntime$setTimeout(function(){try{c()}catch(e$4){runtime.log(String(e$4)+"\n"+e$4.stack)}b=!1;0<d.length&&a(d.pop())},10)}var d=[],b=!1;this.clearQueue=function(){d.length=0};this.addToQueue=function(c){if(!d.length&&!b)return a(c);d.push(c)}}function h(a){function d(){for(;0<b.cssRules.length;)b.deleteRule(0);b.insertRule("#shadowContent draw|page {display:none;}",0);b.insertRule("office|presentation draw|page {display:none;}",1);b.insertRule("#shadowContent draw|page:nth-of-type("+
c+") {display:block;}",2);b.insertRule("office|presentation draw|page:nth-of-type("+c+") {display:block;}",3)}var b=a.sheet,c=1;this.PageSwitcher$showFirstPage=function(){c=1;d()};this.PageSwitcher$showNextPage=function(){c+=1;d()};this.PageSwitcher$showPreviousPage=function(){1<c&&(--c,d())};this.PageSwitcher$showPage=function(a){0<a&&(c=a,d())};this.css=a;this.destroy=function(d){a.parentNode.removeChild(a);d()}}function c(a){a=a.sheet;for(var d=a.cssRules;d.length;)a.deleteRule(d.length-1)}function b(a,
d,b){var c=new odf.Style2CSS,e=new odf.ListStyleToCss;b=b.sheet;var k=(new odf.StyleTree(a.rootElement.styles,a.rootElement.automaticStyles)).getStyleTree();c.style2css(a.getDocumentType(),a.rootElement,b,d.getFontMap(),k);e.applyListStyles(b,k,a.rootElement.body)}function f(a,d){(new odf.FontLoader).loadFonts(a,d.sheet)}function m(a,d,b){var c=null;a=a.rootElement.body.getElementsByTagNameNS(L,b+"-decl");b=d.getAttributeNS(L,"use-"+b+"-name");var e;if(b&&0<a.length)for(d=0;d<a.length;d+=1)if(e=a[d],
e.getAttributeNS(L,"name")===b){c=e.textContent;break}return c}function r(a,d,b,c){var e=a.ownerDocument;d=K.core_DomUtilsImpl$getElementsByTagNameNS(a,d,b);for(a=0;a<d.length;a+=1)K.removeAllChildNodes(d[a]),c&&(b=d[a],b.appendChild(e.createTextNode(c)))}function p(a,d,b){d.setAttributeNS("urn:webodf:names:helper","styleid",a);var c,e=d.getAttributeNS(J,"anchor-type"),k=d.getAttributeNS(t,"x"),n=d.getAttributeNS(t,"y"),f=d.getAttributeNS(t,"width"),l=d.getAttributeNS(t,"height"),m=d.getAttributeNS(x,
"min-height"),g=d.getAttributeNS(x,"min-width");if("as-char"===e)c="display: inline-block;";else if(e||k||n)c="position: absolute;";else if(f||l||m||g)c="display: block;";k&&(c+="left: "+k+";");n&&(c+="top: "+n+";");f&&(c+="width: "+f+";");l&&(c+="height: "+l+";");m&&(c+="min-height: "+m+";");g&&(c+="min-width: "+g+";");c&&(c="draw|"+d.localName+'[webodfhelper|styleid="'+a+'"] {'+c+"}",b.insertRule(c,b.cssRules.length))}function q(a){for(a=a.firstChild;a;){if(a.namespaceURI===w&&"binary-data"===a.localName)return"data:image/png;base64,"+
a.textContent.replace(/[\r\n\s]/g,"");a=a.nextSibling}return""}function e(a,d,b,c){function e(d){d&&(d='draw|image[webodfhelper|styleid="'+a+'"] {'+("background-image: url("+d+");")+"}",c.insertRule(d,c.cssRules.length))}function k(a){e(a.odf_OdfPart$url)}b.setAttributeNS("urn:webodf:names:helper","styleid",a);var n=b.getAttributeNS(A,"href"),f;if(n)try{f=d.getPart(n),f.odf_OdfPart$onchange=k,f.odf_OdfPart_prototype$load()}catch(l$5){runtime.log("slight problem: "+String(l$5))}else n=q(b),e(n)}function l(a){var d=
a.ownerDocument;K.core_DomUtilsImpl$getElementsByTagNameNS(a,J,"line-break").forEach(function(a){a.hasChildNodes()||a.appendChild(d.createElement("br"))})}function a(a){var d=a.ownerDocument;K.core_DomUtilsImpl$getElementsByTagNameNS(a,J,"s").forEach(function(a){var b,c;K.removeAllChildNodes(a);a.appendChild(d.createTextNode(" "));c=parseInt(a.getAttributeNS(J,"c"),10);if(1<c)for(a.removeAttributeNS(J,"c"),b=1;b<c;b+=1)a.parentNode.insertBefore(a.cloneNode(!0),a)})}function d(a){K.core_DomUtilsImpl$getElementsByTagNameNS(a,
J,"tab").forEach(function(a){a.textContent="\t"})}function n(a,d){function b(a,c){var n=f.documentElement.namespaceURI;"video/"===c.substr(0,6)?(e=f.createElementNS(n,"video"),e.setAttribute("controls","controls"),k=f.createElementNS(n,"source"),a&&k.setAttribute("src",a),k.setAttribute("type",c),e.appendChild(k),d.parentNode.appendChild(e)):d.innerHtml="Unrecognised Plugin"}function c(a){b(a.odf_OdfPart$url,a.mimetype)}var e,k,n,f=d.ownerDocument,l;if(n=d.getAttributeNS(A,"href"))try{l=a.getPart(n),
l.odf_OdfPart$onchange=c,l.odf_OdfPart_prototype$load()}catch(m$6){runtime.log("slight problem: "+String(m$6))}else runtime.log("using MP4 data fallback"),n=q(d),b(n,"video/mp4")}function k(a){var d=a.getElementsByTagName("head")[0],b,c;for(c=d.firstElementChild;c&&("style"!==c.localName||!c.hasAttribute("webodfcss"));)c=c.nextElementSibling;if(c)return a=parseInt(c.getAttribute("webodfcss"),10),c.setAttribute("webodfcss",a+1),c;"string"===String(typeof webodf_css)?b=webodf_css:(c="webodf.css",runtime.currentDirectory&&
(c=runtime.currentDirectory(),0<c.length&&"/"!==c.substr(-1)&&(c+="/"),c+="../webodf.css"),b=runtime.BrowserRuntime$readFileSync(c,"utf-8"));c=a.createElementNS(d.namespaceURI,"style");c.setAttribute("media","screen, print, handheld, projection");c.setAttribute("type","text/css");c.setAttribute("webodfcss","1");c.appendChild(a.createTextNode(b));d.appendChild(c);return c}function y(a){var d=parseInt(a.getAttribute("webodfcss"),10);1===d?a.parentNode.removeChild(a):a.setAttribute("count",d-1)}function u(a){var d=
a.getElementsByTagName("head")[0],b=a.createElementNS(d.namespaceURI,"style"),c="";b.setAttribute("type","text/css");b.setAttribute("media","screen, print, handheld, projection");odf.Namespaces.forEachPrefix(function(a,d){c+="@namespace "+a+" url("+d+");\n"});c+="@namespace webodfhelper url(urn:webodf:names:helper);\n";b.appendChild(a.createTextNode(c));d.appendChild(b);return b}var z=odf.Namespaces.drawns,x=odf.Namespaces.fons,w=odf.Namespaces.officens,v=odf.Namespaces.stylens,t=odf.Namespaces.svgns,
D=odf.Namespaces.tablens,J=odf.Namespaces.textns,A=odf.Namespaces.xlinkns,L=odf.Namespaces.presentationns,S=xmldom.XPath,K=core.DomUtils;odf.OdfCanvas=function(q,B){function t(a,d,b){function c(a,d,b,k){ha.addToQueue(function(){e(a,d,b,k)})}var k,n;k=d.getElementsByTagNameNS(z,"image");for(d=0;d<k.length;d+=1)n=k.item(d),c("image"+String(d),a,n,b)}function x(a,d){function b(a,d){ha.addToQueue(function(){n(a,d)})}var c,e,k;e=d.getElementsByTagNameNS(z,"plugin");for(c=0;c<e.length;c+=1)k=e.item(c),
b(a,k)}function A(){var a;a=T.firstChild;var d=da.gui_ZoomHelper$getZoomLevel();a&&(T.style.WebkitTransformOrigin="0% 0%",T.style.MozTransformOrigin="0% 0%",T.style.msTransformOrigin="0% 0%",T.style.OTransformOrigin="0% 0%",T.style.transformOrigin="0% 0%",H&&((a=H.getMinimumHeightForAnnotationPane())?T.style.minHeight=a:T.style.removeProperty("min-height")),q.style.width=Math.round(d*T.offsetWidth)+"px",q.style.height=Math.round(d*T.offsetHeight)+"px",q.style.display="inline-block")}function P(b,
c){var e=aa.sheet;K.removeAllChildNodes(q);T=C.createElementNS(q.namespaceURI,"div");T.style.display="inline-block";T.style.background="white";T.style.setProperty("float","left","important");T.appendChild(c);q.appendChild(T);ea=C.createElementNS(q.namespaceURI,"div");ea.id="annotationsPane";ga=C.createElementNS(q.namespaceURI,"div");ga.id="shadowContent";ga.style.position="absolute";ga.style.top=0;ga.style.left=0;b.getContentElement().appendChild(ga);var k=c.body,n,f=[],g;for(n=k.firstElementChild;n&&
n!==k;)if(n.namespaceURI===z&&(f[f.length]=n),n.firstElementChild)n=n.firstElementChild;else{for(;n&&n!==k&&!n.nextElementSibling;)n=n.parentNode;n&&n.nextElementSibling&&(n=n.nextElementSibling)}for(g=0;g<f.length;g+=1)n=f[g],p("frame"+String(g),n,e);f=S.getODFElementsWithXPath(k,".//*[*[@text:anchor-type='paragraph']]",odf.Namespaces.lookupNamespaceURI);for(n=0;n<f.length;n+=1)k=f[n],k.setAttributeNS&&k.setAttributeNS("urn:webodf:names:helper","containsparagraphanchor",!0);k=ca;n=ga;var h,y,B,u,
A,M;g=b.rootElement.ownerDocument;if((f=c.body.firstElementChild)&&f.namespaceURI===w&&("presentation"===f.localName||"drawing"===f.localName))for(f=f.firstElementChild;f;){if(h=(h=f.getAttributeNS(z,"master-page-name"))?k.getMasterPageElement(h):null){y=f.getAttributeNS("urn:webodf:names:helper","styleid");B=g.createElementNS(z,"draw:page");M=h.firstElementChild;for(A=0;M;)"true"!==M.getAttributeNS(L,"placeholder")&&(u=M.cloneNode(!0),B.appendChild(u)),M=M.nextElementSibling,A+=1;var E=K.core_DomUtilsImpl$getElementsByTagNameNS(B,
z,"frame");for(A=0;A<E.length;A+=1)u=E[A],(M=u.getAttributeNS(L,"class"))&&!/^(date-time|footer|header|page-number)$/.test(M)&&u.parentNode.removeChild(u);u=K.core_DomUtilsImpl$getElementsByTagNameNS(B,z,"*");for(A=0;A<u.length;A+=1)p(y+"_"+A,u[A],e);n.appendChild(B);A=String(n.getElementsByTagNameNS(z,"page").length);r(B,J,"page-number",A);r(B,L,"header",m(b,f,"header"));r(B,L,"footer",m(b,f,"footer"));p(y,B,e);B.setAttributeNS("urn:webodf:names:helper","page-style-name",f.getAttributeNS(z,"style-name"));
B.setAttributeNS(z,"draw:master-page-name",h.getAttributeNS(v,"name"))}f=f.nextElementSibling}k=q.namespaceURI;f=K.core_DomUtilsImpl$getElementsByTagNameNS(c.body,D,"table-cell");for(n=0;n<f.length;n+=1)g=f[n],g.hasAttributeNS(D,"number-columns-spanned")&&g.setAttributeNS(k,"colspan",g.getAttributeNS(D,"number-columns-spanned")),g.hasAttributeNS(D,"number-rows-spanned")&&g.setAttributeNS(k,"rowspan",g.getAttributeNS(D,"number-rows-spanned"));l(c.body);a(c.body);d(c.body);t(b,c.body,e);x(b,c.body);
T.insertBefore(ga,T.firstChild);da.setZoomableElement(T)}function N(a){E?(ea.parentNode||T.appendChild(ea),H&&H.forgetAnnotations(),H=new gui.AnnotationViewManager(fa,a.body,ea,Z),a=K.core_DomUtilsImpl$getElementsByTagNameNS(a.body,w,"annotation"),H.addAnnotations(a),A()):ea.parentNode&&(T.removeChild(ea),H.forgetAnnotations(),A())}function Y(a){function d(){c(ia);c(O);c(aa);K.removeAllChildNodes(q);q.style.display="inline-block";var e=X.rootElement;q.ownerDocument.importNode(e,!0);ca.odf_Formatting$setOdfContainer(X);
f(X,ia);b(X,ca,O);P(X,e);N(e);a||ha.addToQueue(function(){var a=[X];if(la.hasOwnProperty("statereadychange")){var d=la.statereadychange,b;for(b=0;b<d.length;b+=1)d[b].apply(null,a)}})}X.odf_OdfContainer$state===odf.OdfContainer.function__new_odf_OdfContainer___odf_OdfContainer_DocumentType_number__string____function__odf_OdfContainer_____null______$DONE?d():(runtime.log("WARNING: refreshOdf called but ODF was not DONE."),ja=runtime.BrowserRuntime$setTimeout(function G(){X.odf_OdfContainer$state===
odf.OdfContainer.function__new_odf_OdfContainer___odf_OdfContainer_DocumentType_number__string____function__odf_OdfContainer_____null______$DONE?d():(runtime.log("will be back later..."),ja=runtime.BrowserRuntime$setTimeout(G,500))},100))}function W(a){ha.clearQueue();K.removeAllChildNodes(q);q.appendChild(q.ownerDocument.createTextNode(runtime.tr("Loading")+a+"..."));q.removeAttribute("style");X=new odf.OdfContainer(a,function(a){X=a;Y(!1)})}runtime.BrowserRuntime$assert(!!q&&!!q,"odf.OdfCanvas constructor needs DOM element");
runtime.BrowserRuntime$assert(!!q.ownerDocument&&!!q.ownerDocument,"odf.OdfCanvas constructor needs DOM");var fa=this,C=q.ownerDocument,X,ca=new odf.Formatting,ba,T=null,ea=null,E=!1,Z=!1,H=null,F,ia,O,aa,ga,la={},ja,ka,ma=!1,oa=!1,ha=new g,da=new gui.ZoomHelper,na=B||new gui.SingleScrollViewport(q.parentNode);this.refreshCSS=function(){ma=!0;ka.trigger()};this.refreshSize=function(){ka.trigger()};this.odfContainer=function(){return X};this.odf_OdfCanvas$setOdfContainer=function(a,d){X=a;Y(!0===d)};
this.odf_OdfCanvas$load=this.load=W;this.odf_OdfCanvas$save=function(a){X.odf_OdfContainer$save(a)};this.odf_OdfCanvas$addListener=function(a,d){switch(a){case "click":q.addEventListener?q.addEventListener(a,d,!1):q.attachEvent?q.attachEvent("on"+a,d):q["on"+a]=d;break;default:var b;la.hasOwnProperty(a)?b=la[a]:b=la[a]=[];d&&-1===b.indexOf(d)&&b.push(d)}};this.odf_OdfCanvas$getFormatting=function(){return ca};this.getAnnotationViewManager=function(){return H};this.refreshAnnotations=function(){N(X.rootElement)};
this.odf_OdfCanvas$rerenderAnnotations=function(){H&&(oa=!0,ka.trigger())};this.getSizer=function(){return T};this.enableAnnotations=function(a,d){a!==E&&(E=a,Z=d,X&&N(X.rootElement))};this.odf_OdfCanvas$addAnnotation=function(a){H&&(H.addAnnotations([a]),A())};this.odf_OdfCanvas$forgetAnnotation=function(a){H&&(H.gui_AnnotationViewManager$forgetAnnotation(a),A())};this.getZoomHelper=function(){return da};this.odf_OdfCanvas$setZoomLevel=function(a){da.gui_ZoomHelper$setZoomLevel(a)};this.gui_AnnotatableCanvas_prototype$getZoomLevel=
function(){return da.gui_ZoomHelper$getZoomLevel()};this.fitToContainingElement=function(a,d){var b=da.gui_ZoomHelper$getZoomLevel(),c=q.offsetHeight/b,b=a/(q.offsetWidth/b);d/c<b&&(b=d/c);da.gui_ZoomHelper$setZoomLevel(b)};this.fitToWidth=function(a){var d=q.offsetWidth/da.gui_ZoomHelper$getZoomLevel();da.gui_ZoomHelper$setZoomLevel(a/d)};this.fitSmart=function(a,d){var b,c;c=da.gui_ZoomHelper$getZoomLevel();b=q.offsetWidth/c;c=q.offsetHeight/c;b=a/b;void 0!==d&&d/c<b&&(b=d/c);da.gui_ZoomHelper$setZoomLevel(Math.min(1,
b))};this.fitToHeight=function(a){var d=q.offsetHeight/da.gui_ZoomHelper$getZoomLevel();da.gui_ZoomHelper$setZoomLevel(a/d)};this.odf_OdfCanvas$showFirstPage=function(){ba.PageSwitcher$showFirstPage()};this.odf_OdfCanvas$showNextPage=function(){ba.PageSwitcher$showNextPage()};this.odf_OdfCanvas$showPreviousPage=function(){ba.PageSwitcher$showPreviousPage()};this.odf_OdfCanvas$showPage=function(a){ba.PageSwitcher$showPage(a);A()};this.getElement=function(){return q};this.getViewport=function(){return na};
this.addCssForFrameWithImage=function(a){var d=a.getAttributeNS(z,"name"),b=a.firstElementChild;p(d,a,aa.sheet);b&&e(d+"img",X,b,aa.sheet)};this.destroy=function(a){var d=C.getElementsByTagName("head")[0],b=[ba.destroy,ka.destroy];runtime.BrowserRuntime$clearTimeout(ja);ea&&ea.parentNode&&ea.parentNode.removeChild(ea);da.destroy(function(){T&&(q.removeChild(T),T=null)});y(F);d.removeChild(ia);d.removeChild(O);d.removeChild(aa);core.Async.destroyAll(b,a)};F=k(C);ba=new h(u(C));ia=u(C);O=u(C);aa=u(C);
ka=core.Task.createRedrawTask(function(){ma&&(b(X,ca,O),ma=!1);oa&&(H&&H.gui_AnnotationViewManager$rerenderAnnotations(),oa=!1);A()});da.gui_ZoomHelper$subscribe(gui.ZoomHelper.signalZoomChanged,A)}})();
odf.StepUtils=function(){this.getContentBounds=function(g){var h=g.container(),c,b;runtime.BrowserRuntime$assert(g.isStep(),"Step iterator must be on a step");h.nodeType===Node.TEXT_NODE&&0<g.offset()?c=g.offset():(h=g.core_StepIterator$leftNode())&&h.nodeType===Node.TEXT_NODE&&(c=h.length);h&&(h.nodeType===Node.TEXT_NODE?(runtime.BrowserRuntime$assert(0<c,"Empty text node found"),b={container:h,startOffset:c-1,endOffset:c}):b={container:h,startOffset:0,endOffset:h.childNodes.length});return b}};
ops.MemberProperties=function(){};
ops.Member=function(g,h){var c=new ops.MemberProperties;this.ops_Member$getMemberId=function(){return g};this.getProperties=function(){return c};this.setProperties=function(b){Object.keys(b).forEach(function(f){c[f]=b[f]})};this.removeProperties=function(b){Object.keys(b).forEach(function(b){"fullName"!==b&&"color"!==b&&"imageUrl"!==b&&c.hasOwnProperty(b)&&delete c[b]})};runtime.BrowserRuntime$assert(!!g,"No memberId was supplied!");h.fullName||(h.fullName=runtime.tr("Unknown Author"));h.ops_MemberProperties$color||
(h.ops_MemberProperties$color="black");h.imageUrl||(h.imageUrl="avatar-joe.png");c=h};ops.Document=function(){};ops.Document.prototype.getMemberIds=function(){};ops.Document.prototype.ops_Document_prototype$removeCursor=function(g){};ops.Document.prototype.getDocumentElement=function(){};ops.Document.prototype.getRootNode=function(){};ops.Document.prototype.getDOMDocument=function(){};ops.Document.prototype.cloneDocumentElement=function(){};ops.Document.prototype.setDocumentElement=function(g){};
ops.Document.prototype.ops_Document_prototype$subscribe=function(g,h){};ops.Document.prototype.unsubscribe=function(g,h){};ops.Document.prototype.getCanvas=function(){};ops.Document.prototype.createRootFilter=function(g){};ops.Document.prototype.createPositionIterator=function(g){};ops.Document.prototype.hasCursor=function(g){};ops.Document.signalCursorAdded="cursor/added";ops.Document.signalCursorRemoved="cursor/removed";ops.Document.signalCursorMoved="cursor/moved";
ops.Document.signalMemberAdded="member/added";ops.Document.signalMemberUpdated="member/updated";ops.Document.signalMemberRemoved="member/removed";
ops.OdtCursor=function(g,h){var c=this,b={},f,m,r=new core.EventNotifier(["cursorUpdated"]);this.ops_OdtCursor$removeFromDocument=function(){m.core_Cursor$remove()};this.ops_OdtCursor$subscribe=function(b,c){r.core_EventNotifier$subscribe(b,c)};this.unsubscribe=function(b,c){r.unsubscribe(b,c)};this.gui_ShadowCursor$getMemberId=function(){return g};this.ops_OdtCursor$getNode=function(){return m.core_Cursor$getNode()};this.ops_OdtCursor$getAnchorNode=function(){return m.core_Cursor$getAnchorNode()};
this.ops_OdtCursor$getSelectedRange=function(){return m.core_Cursor$getSelectedRange()};this.ops_OdtCursor$setSelectedRange=function(b,f){m.core_Cursor$setSelectedRange(b,f);r.core_EventNotifier$emit("cursorUpdated",c)};this.hasForwardSelection=function(){return m.hasForwardSelection()};this.ops_OdtCursor$getDocument=function(){return h};this.ops_OdtCursor$getSelectionType=function(){return f};this.setSelectionType=function(c){b.hasOwnProperty(c)?f=c:runtime.log("Invalid selection type: "+c)};this.resetSelectionType=
function(){c.setSelectionType("Range")};m=new core.Cursor(h.getDOMDocument(),g);b.Range=!0;b.Region=!0;c.resetSelectionType()};ops.OdtCursor.RangeSelection="Range";ops.OdtCursor.RegionSelection="Region";ops.OdtCursor.signalCursorUpdated="cursorUpdated";
(function(){var g=0;ops.StepsCache=function(h,c,b){function f(a,d){var c=this;this.nodeId=a;this.steps=-1;this.node=d;this.previousBookmark=this.nextBookmark=null;this.setIteratorPosition=function(a){a.setPositionBeforeElement(d);b(c.steps,a)}}function m(a,d,c){var e=this;this.nodeId=a;this.steps=d;this.node=c;this.previousBookmark=this.nextBookmark=null;this.setIteratorPosition=function(a){a.setUnfilteredPosition(c,0);b(e.steps,a)}}function r(a,d){var b="["+a.nodeId;d&&(b+=" => "+d.nodeId);return b+
"]"}function p(){if(!0===ops.StepsCache.ENABLE_CACHE_VERIFICATION){for(var a=u,d,b,c,e=new core.LoopWatchDog(0,1E5),k={};a;){e.core_LoopWatchDog$check();(d=a.previousBookmark)?runtime.BrowserRuntime$assert(d.nextBookmark===a,"Broken bookmark link to previous @"+r(d,a)):(runtime.BrowserRuntime$assert(a===u,"Broken bookmark link @"+r(a)),runtime.BrowserRuntime$assert(void 0===z||u===u||u.steps<=z,"Base point is damaged @"+r(a)));(b=a.nextBookmark)&&runtime.BrowserRuntime$assert(b.previousBookmark===
a,"Broken bookmark link to next @"+r(a,b));if(void 0===z||a===u||a.steps<=z)runtime.BrowserRuntime$assert(y.core_DomUtilsImpl$containsNode(h,a.node),"Disconnected node is being reported as undamaged @"+r(a)),d&&(c=a.node.compareDocumentPosition(d.node),runtime.BrowserRuntime$assert(!c||!!(c&w),"Bookmark order with previous does not reflect DOM order @"+r(d,a))),b&&y.core_DomUtilsImpl$containsNode(h,b.node)&&(c=a.node.compareDocumentPosition(b.node),runtime.BrowserRuntime$assert(!c||!!(c&x),"Bookmark order with next does not reflect DOM order @"+
r(a,b)));a=a.nextBookmark}Object.keys(n).forEach(function(a){var d=n[a];(void 0===z||a<=z)&&runtime.BrowserRuntime$assert(d.steps<=a,"Bookmark step of "+d.steps+" exceeds cached step lookup for "+a+" @"+r(d));runtime.BrowserRuntime$assert(!1===k.hasOwnProperty(d.nodeId),"Bookmark "+r(d)+" appears twice in cached step lookup at steps "+k[d.nodeId]+" and "+a);k[d.nodeId]=a})}}function q(a){var d="";a.nodeType===Node.ELEMENT_NODE&&(d=a.getAttributeNS("urn:webodf:names:steps","nodeId")||"");return d}
function e(a){var d=g.toString();a.setAttributeNS("urn:webodf:names:steps","nodeId",d);g+=1;return d}function l(a){var d,b,e=new core.LoopWatchDog(0,1E4);void 0!==z&&a>z&&(a=z);for(d=Math.floor(a/c)*c;!b&&0<=d;)b=n[d],d-=c;for(b=b||u;b.nextBookmark&&b.nextBookmark.steps<=a;)e.core_LoopWatchDog$check(),b=b.nextBookmark;runtime.BrowserRuntime$assert(-1===a||b.steps<=a,"Bookmark @"+r(b)+" at step "+b.steps+" exceeds requested step of "+a);return b}function a(a){a.previousBookmark&&(a.previousBookmark.nextBookmark=
a.nextBookmark);a.nextBookmark&&(a.nextBookmark.previousBookmark=a.previousBookmark)}function d(a){for(var d,b=null;!b&&a&&a!==h;)(d=q(a))&&(b=k[d])&&b.node!==a&&(runtime.log("Cloned node detected. Creating new bookmark"),b=null,a.removeAttributeNS("urn:webodf:names:steps","nodeId")),a=a.parentNode;return b}var n={},k={},y=core.DomUtils,u,z,x=Node.DOCUMENT_POSITION_FOLLOWING,w=Node.DOCUMENT_POSITION_PRECEDING;this.updateBookmark=function(d,b){var g,m=Math.ceil(d/c)*c,r,w,S;if(void 0!==z&&z<d){r=l(z);
for(w=r.nextBookmark;w&&w.steps<=d;)g=w.nextBookmark,S=Math.ceil(w.steps/c)*c,n[S]===w&&delete n[S],y.core_DomUtilsImpl$containsNode(h,w.node)?w.steps=d+1:(a(w),delete k[w.nodeId]),w=g;z=d}else r=l(d);w=q(b)||e(b);g=k[w];g?g.node!==b&&(runtime.log("Cloned node detected. Creating new bookmark"),w=e(b),g=k[w]=new f(w,b)):g=k[w]=new f(w,b);w=g;w.steps!==d&&(g=Math.ceil(w.steps/c)*c,g!==m&&n[g]===w&&delete n[g],w.steps=d);if(r!==w&&r.nextBookmark!==w){if(r.steps===w.steps)for(;w.node.compareDocumentPosition(r.node)&
x&&r!==u;)r=r.previousBookmark;r!==w&&r.nextBookmark!==w&&(a(w),g=r.nextBookmark,w.nextBookmark=r.nextBookmark,w.previousBookmark=r,r.nextBookmark=w,g&&(g.previousBookmark=w))}r=n[m];if(!r||w.steps>r.steps)n[m]=w;p()};this.setToClosestStep=function(a,d){var b;p();b=l(a);b.setIteratorPosition(d);return b.steps};this.setToClosestDomPoint=function(a,b,c){var e,k;p();if(a!==h||b)if(a===h&&b===h.childNodes.length)for(k in e=u,n)n.hasOwnProperty(k)&&(a=n[k],a.steps>e.steps&&(e=a));else{if(e=d(a.childNodes.item(b)||
a),!e)for(c.setUnfilteredPosition(a,b);!e&&c.previousNode();)e=d(c.getCurrentNode())}else e=u;e=e||u;void 0!==z&&e.steps>z&&(e=l(z));e.setIteratorPosition(c);return e.steps};this.damageCacheAfterStep=function(a){0>a&&(a=-1);void 0===z?z=a:a<z&&(z=a);p()};(function(){var a=q(h)||e(h);u=new m(a,0,h)})()};ops.StepsCache.ENABLE_CACHE_VERIFICATION=!1;ops.StepsCache.Bookmark=function(){};ops.StepsCache.Bookmark.prototype.setIteratorPosition=function(g){}})();
(function(){ops.OdtStepsTranslator=function(g,h,c,b){function f(a,b,c){var e=b.getCurrentNode();b.isBeforeNode()&&p.isParagraph(e)&&(c||(a+=1),r.updateBookmark(a,e))}function m(d,b){if(!b||c.acceptPosition(d)===e)return!0;for(;d.previousPosition();)if(c.acceptPosition(d)===e){if(b(l,d.container(),d.unfilteredDomOffset()))return!0;break}for(;d.nextPosition();)if(c.acceptPosition(d)===e){if(b(a,d.container(),d.unfilteredDomOffset()))return!0;break}return!1}var r,p=odf.OdfUtils,q=core.DomUtils,e=core.PositionFilter.FilterResult.FILTER_ACCEPT,
l=core.StepDirection.PREVIOUS,a=core.StepDirection.NEXT;this.convertStepsToDomPoint=function(a){var b,k;if(isNaN(a))throw new TypeError("Requested steps is not numeric ("+a+")");if(0>a)throw new RangeError("Requested steps is negative ("+a+")");for(b=r.setToClosestStep(a,h);b<a&&h.nextPosition();)(k=c.acceptPosition(h)===e)&&(b+=1),f(b,h,k);if(b!==a)throw new RangeError("Requested steps ("+a+") exceeds available steps ("+b+")");return{node:h.container(),offset:h.unfilteredDomOffset()}};this.convertDomPointToSteps=
function(a,b,k){var l;q.core_DomUtilsImpl$containsNode(g,a)||(b=0>q.comparePoints(g,0,a,b),a=g,b=b?0:g.childNodes.length);h.setUnfilteredPosition(a,b);m(h,k)||h.setUnfilteredPosition(a,b);k=h.container();b=h.unfilteredDomOffset();a=r.setToClosestDomPoint(k,b,h);if(0>q.comparePoints(h.container(),h.unfilteredDomOffset(),k,b))return 0<a?a-1:a;for(;(h.container()!==k||h.unfilteredDomOffset()!==b)&&h.nextPosition();)(l=c.acceptPosition(h)===e)&&(a+=1),f(a,h,l);return a+0};this.prime=function(){var a,
b;for(a=r.setToClosestStep(0,h);h.nextPosition();)(b=c.acceptPosition(h)===e)&&(a+=1),f(a,h,b)};this.handleStepsInserted=function(a){r.damageCacheAfterStep(a.position)};this.handleStepsRemoved=function(a){r.damageCacheAfterStep(a.position-1)};r=new ops.StepsCache(g,b,function(a,b){do{if(c.acceptPosition(b)===e){f(a,b,!0);break}f(a-1,b,!1)}while(b.nextPosition())})}})();ops.Operation=function(){};ops.Operation.prototype.init=function(g){};ops.Operation.prototype.execute=function(g){};
ops.Operation.prototype.spec=function(){};
ops.TextPositionFilter=function(){function g(b,c){for(;b&&c(b)!==m;)b=b.previousSibling;return b}function h(b,f,e,l){var a;if(f){if(c.isInlineRoot(f)&&c.isGroupingElement(e))return r;l=c.lookLeftForCharacter(f);if(1===l||2===l&&(c.scanRightForAnyCharacter(e)||c.scanRightForAnyCharacter(c.nextNode(b))))return m}else if(c.isGroupingElement(b)&&c.isInlineRoot(g(b.previousSibling,l)))return m;l=!f&&c.isParagraph(b);a=c.lookRightForCharacter(e);if(l)return a?m:c.scanRightForAnyCharacter(e)?r:m;if(!a)return r;
f=f||c.previousNode(b);return c.scanLeftForAnyCharacter(f)?r:m}var c=odf.OdfUtils,b=Node.ELEMENT_NODE,f=Node.TEXT_NODE,m=core.PositionFilter.FilterResult.FILTER_ACCEPT,r=core.PositionFilter.FilterResult.FILTER_REJECT;this.acceptPosition=function(g){var q=g.container(),e=q.nodeType,l,a,d;if(e!==b&&e!==f)return r;if(e===f){e=g.unfilteredDomOffset();l=q.data;runtime.BrowserRuntime$assert(e!==l.length,"Unexpected offset.");if(0<e){g=l[e-1];if(!c.isODFWhitespace(g))return m;if(1<e)if(g=l[e-2],!c.isODFWhitespace(g))d=
m;else{if(!c.isODFWhitespace(l.substr(0,e)))return r}else a=c.previousNode(q),c.scanLeftForNonSpace(a)&&(d=m);if(d===m)return c.isTrailingWhitespace(q,e)?r:m;g=l[e];return c.isODFWhitespace(g)?r:c.scanLeftForAnyCharacter(c.previousNode(q))?r:m}a=g.core_PositionIterator$leftNode();d=q;q=q.parentNode;d=h(q,a,d,g.getNodeFilter())}else c.isGroupingElement(q)?(a=g.core_PositionIterator$leftNode(),d=g.rightNode(),d=h(q,a,d,g.getNodeFilter())):d=r;return d}};
function RootFilter(g,h,c){var b=core.PositionFilter.FilterResult.FILTER_ACCEPT,f=core.PositionFilter.FilterResult.FILTER_REJECT;this.acceptPosition=function(m){m=m.container();var r;"string"===typeof g?r=h[g].ops_OdtCursor$getNode():r=g;return c(m)===c(r)?b:f}}
ops.OdtDocument=function(g){function h(a){return new core.PositionIterator(a,D,L,!1)}function c(){var a=g.odfContainer().getContentElement(),d=a&&a.localName;runtime.BrowserRuntime$assert("text"===d,"Unsupported content element type '"+d+"' for OdtDocument");return a}function b(){return a.getDocumentElement().ownerDocument}function f(a){for(;a&&!(a.namespaceURI===odf.Namespaces.officens&&"text"===a.localName||a.namespaceURI===odf.Namespaces.officens&&"annotation"===a.localName);)a=a.parentNode;return a}
function m(a,d,b,c){c=h(c);var e;1===b.length?e=b[0]:(e=new core.PositionFilterChain,b.forEach(e.core_PositionFilterChain$addFilter));b=new core.StepIterator(e,c);b.setPosition(a,d);return b}function r(a){var d=h(c());a=v.convertStepsToDomPoint(a);d.setUnfilteredPosition(a.node,a.offset);return d}function p(a){return a===x}function q(d){var b=d.spec(),c=b.memberid,e=(new Date(b.timestamp)).toISOString(),b=g.odfContainer();d.isEdit&&(c=a.getMember(c).getProperties().fullName,b.odf_OdfContainer$setMetadata({"dc:creator":c,
"dc:date":e},null),c={setProperties:{"dc:creator":c,"dc:date":e},removedProperties:[]},t||(c.setProperties["meta:editing-cycles"]=b.incrementEditingCycles(),b.odf_OdfContainer$setMetadata(null,["meta:editing-duration","meta:document-statistic"])),t=d,a.ops_OdtDocument$emit("metadata/updated",c))}function e(a){var b,c=[],e,f=2;runtime.BrowserRuntime$assert(a.isStep(),"positionIterator is not at a step");do{if(b=d.getContentBounds(a))if(b=b.container,n.isDowngradableSpaceElement(b)){for(e=b.lastChild;b.firstChild;)c.push(b.firstChild),
b.parentNode.insertBefore(b.firstChild,b);b.parentNode.removeChild(b);a.setPosition(e,e.nodeType===Node.TEXT_NODE?e.length:e.childNodes.length);a.roundToPreviousStep()}--f}while(0<f&&a.nextStep());c.forEach(k.normalizeTextNodes)}function l(a,d,b){a=a.childNodes.item(d)||a;return(a=n.getParagraphElement(a))&&k.core_DomUtilsImpl$containsNode(b,a)?a:b}var a=this,d,n=odf.OdfUtils,k=core.DomUtils,y={},u={},z=new core.EventNotifier([ops.Document.signalMemberAdded,ops.Document.signalMemberUpdated,ops.Document.signalMemberRemoved,
ops.Document.signalCursorAdded,ops.Document.signalCursorRemoved,ops.Document.signalCursorMoved,"paragraph/changed","paragraphstyle/modified","style/created","style/deleted","table/added","operation/start","operation/end","router/batchstart","router/batchend","undo/changed","steps/inserted","steps/removed","metadata/updated","annotation/added"]),x=core.StepDirection.NEXT,w,v,t,D=NodeFilter.SHOW_ALL,J=new gui.BlacklistNamespaceNodeFilter(["urn:webodf:names:cursor","urn:webodf:names:editinfo"]),A=new gui.OdfTextBodyNodeFilter,
L=new core.NodeFilterChain([J,A]);this.createPositionIterator=h;this.getDocumentElement=function(){return g.odfContainer().rootElement};this.cloneDocumentElement=function(){var d=a.getDocumentElement(),b=g.getAnnotationViewManager();b&&b.forgetAnnotations();d=d.cloneNode(!0);g.refreshAnnotations();a.fixCursorPositions();return d};this.setDocumentElement=function(a){var d=g.odfContainer();z.unsubscribe("steps/inserted",v.handleStepsInserted);z.unsubscribe("steps/removed",v.handleStepsRemoved);d.setRootElement(a);
g.odf_OdfCanvas$setOdfContainer(d,!0);g.refreshCSS();a=c();v=new ops.OdtStepsTranslator(a,h(a),w,500);z.core_EventNotifier$subscribe("steps/inserted",v.handleStepsInserted);z.core_EventNotifier$subscribe("steps/removed",v.handleStepsRemoved)};this.getDOMDocument=b;this.getRootElement=f;this.createStepIterator=m;this.getIteratorAtPosition=r;this.convertCursorStepToDomPoint=function(a){return v.convertStepsToDomPoint(a)};this.convertDomPointToCursorStep=function(a,d,b){var c;b===x&&(c=p);return v.convertDomPointToSteps(a,
d,c)};this.convertDomToCursorRange=function(a){var d;d=v.convertDomPointToSteps(a.anchorNode,a.anchorOffset);a=a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset?d:v.convertDomPointToSteps(a.focusNode,a.focusOffset);return{position:d,length:a-d}};this.convertCursorToDomRange=function(a,d){var c=b().createRange(),e,k;e=v.convertStepsToDomPoint(a);d?(k=v.convertStepsToDomPoint(a+d),0<d?(c.setStart(e.node,e.offset),c.setEnd(k.node,k.offset)):(c.setStart(k.node,k.offset),c.setEnd(e.node,e.offset))):
c.setStart(e.node,e.offset);return c};this.upgradeWhitespacesAtPosition=function(a){var b=r(a),b=new core.StepIterator(w,b),c,e=2;runtime.BrowserRuntime$assert(b.isStep(),"positionIterator is not at a step (requested step: "+a+")");do{if(c=d.getContentBounds(b))if(a=c.container,c=c.startOffset,a.nodeType===Node.TEXT_NODE&&n.isSignificantWhitespace(a,c)){runtime.BrowserRuntime$assert(" "===a.data[c],"upgradeWhitespaceToElement: textNode.data[offset] should be a literal space");var k=a.ownerDocument.createElementNS(odf.Namespaces.textns,
"text:s"),f=a.parentNode,g=a;k.appendChild(a.ownerDocument.createTextNode(" "));1===a.length?f.replaceChild(k,a):(a.deleteData(c,1),0<c&&(c<a.length&&a.splitText(c),g=a.nextSibling),f.insertBefore(k,g));a=k;b.setPosition(a,a.childNodes.length);b.roundToPreviousStep()}--e}while(0<e&&b.nextStep())};this.downgradeWhitespaces=e;this.downgradeWhitespacesAtPosition=function(a){a=r(a);a=new core.StepIterator(w,a);e(a)};this.getTextNodeAtStep=function(d,c){var e=r(d),k=e.container(),f,n;k.nodeType===Node.TEXT_NODE?
(f=k,n=e.unfilteredDomOffset(),0<f.length&&(0<n&&(f=f.splitText(n)),f.parentNode.insertBefore(b().createTextNode(""),f),f=f.previousSibling,n=0)):(f=b().createTextNode(""),n=0,k.insertBefore(f,e.rightNode()));if(c){if(y[c]&&a.getCursorPosition(c)===d){for(e=y[c].ops_OdtCursor$getNode();e.nextSibling&&"cursor"===e.nextSibling.localName;)e.parentNode.insertBefore(e.nextSibling,e);0<f.length&&f.nextSibling!==e&&(f=b().createTextNode(""),n=0);e.parentNode.insertBefore(f,e)}}else for(;f.nextSibling&&"cursor"===
f.nextSibling.localName;)f.parentNode.insertBefore(f.nextSibling,f);for(;f.previousSibling&&f.previousSibling.nodeType===Node.TEXT_NODE;)e=f.previousSibling,e.appendData(f.data),n=e.length,f=e,f.parentNode.removeChild(f.nextSibling);for(;f.nextSibling&&f.nextSibling.nodeType===Node.TEXT_NODE;)e=f.nextSibling,f.appendData(e.data),f.parentNode.removeChild(e);return{textNode:f,offset:n}};this.fixCursorPositions=function(){Object.keys(y).forEach(function(d){var b=y[d],c=f(b.ops_OdtCursor$getNode()),e=
a.createRootFilter(c),k,n,g,h=!1;g=b.ops_OdtCursor$getSelectedRange();k=l(g.startContainer,g.startOffset,c);n=m(g.startContainer,g.startOffset,[w,e],k);g.collapsed?c=n:(k=l(g.endContainer,g.endOffset,c),c=m(g.endContainer,g.endOffset,[w,e],k));n.isStep()&&c.isStep()?n.container()!==c.container()||n.offset()!==c.offset()||g.collapsed&&b.ops_OdtCursor$getAnchorNode()===b.ops_OdtCursor$getNode()||(h=!0,g.setStart(n.container(),n.offset()),g.collapse(!0)):(h=!0,runtime.BrowserRuntime$assert(n.roundToClosestStep(),
"No walkable step found for cursor owned by "+d),g.setStart(n.container(),n.offset()),runtime.BrowserRuntime$assert(c.roundToClosestStep(),"No walkable step found for cursor owned by "+d),g.setEnd(c.container(),c.offset()));h&&(b.ops_OdtCursor$setSelectedRange(g,b.hasForwardSelection()),a.ops_OdtDocument$emit(ops.Document.signalCursorMoved,b))})};this.getCursorPosition=function(a){return(a=y[a])?v.convertDomPointToSteps(a.ops_OdtCursor$getNode(),0):0};this.getCursorSelection=function(a){a=y[a];var d=
0,b=0;a&&(d=v.convertDomPointToSteps(a.ops_OdtCursor$getNode(),0),b=v.convertDomPointToSteps(a.ops_OdtCursor$getAnchorNode(),0));return{position:b,length:d-b}};this.getPositionFilter=function(){return w};this.getOdfCanvas=function(){return g};this.getCanvas=function(){return g};this.getRootNode=c;this.addMember=function(a){runtime.BrowserRuntime$assert(!u[a.ops_Member$getMemberId()],"This member already exists");u[a.ops_Member$getMemberId()]=a};this.getMember=function(a){return u.hasOwnProperty(a)?
u[a]:null};this.removeMember=function(a){delete u[a]};this.ops_OdtDocument$getCursor=function(a){return y[a]};this.hasCursor=function(a){return y.hasOwnProperty(a)};this.getMemberIds=function(){return Object.keys(u)};this.addCursor=function(d){runtime.BrowserRuntime$assert(!!d,"OdtDocument::addCursor without cursor");var b=d.gui_ShadowCursor$getMemberId(),c=a.convertCursorToDomRange(0,0);runtime.BrowserRuntime$assert("string"===typeof b,"OdtDocument::addCursor has cursor without memberid");runtime.BrowserRuntime$assert(!y[b],
"OdtDocument::addCursor is adding a duplicate cursor with memberid "+b);d.ops_OdtCursor$setSelectedRange(c,!0);y[b]=d};this.ops_Document_prototype$removeCursor=function(d){var b=y[d];return b?(b.ops_OdtCursor$removeFromDocument(),delete y[d],a.ops_OdtDocument$emit(ops.Document.signalCursorRemoved,d),!0):!1};this.moveCursor=function(d,b,c,e){d=y[d];b=a.convertCursorToDomRange(b,c);d&&(d.ops_OdtCursor$setSelectedRange(b,0<=c),d.setSelectionType(e||"Range"))};this.ops_OdtDocument$getFormatting=function(){return g.odf_OdfCanvas$getFormatting()};
this.ops_OdtDocument$emit=function(a,d){z.core_EventNotifier$emit(a,d)};this.ops_Document_prototype$subscribe=function(a,d){z.core_EventNotifier$subscribe(a,d)};this.unsubscribe=function(a,d){z.unsubscribe(a,d)};this.createRootFilter=function(a){return new RootFilter(a,y,f)};this.ops_OdtDocument$close=function(a){a()};this.destroy=function(a){a()};(function(){var a=c();w=new ops.TextPositionFilter;d=new odf.StepUtils;v=new ops.OdtStepsTranslator(a,h(a),w,500);z.core_EventNotifier$subscribe("steps/inserted",
v.handleStepsInserted);z.core_EventNotifier$subscribe("steps/removed",v.handleStepsRemoved);z.core_EventNotifier$subscribe("operation/end",q);z.core_EventNotifier$subscribe("router/batchend",core.Task.processTasks)})()};ops.OdtDocument.signalParagraphChanged="paragraph/changed";ops.OdtDocument.signalTableAdded="table/added";ops.OdtDocument.signalCommonStyleCreated="style/created";ops.OdtDocument.signalCommonStyleDeleted="style/deleted";ops.OdtDocument.signalParagraphStyleModified="paragraphstyle/modified";
ops.OdtDocument.signalOperationStart="operation/start";ops.OdtDocument.signalOperationEnd="operation/end";ops.OdtDocument.function__new_ops_OdtDocument__odf_OdfCanvas___undefined$signalProcessingBatchStart="router/batchstart";ops.OdtDocument.function__new_ops_OdtDocument__odf_OdfCanvas___undefined$signalProcessingBatchEnd="router/batchend";ops.OdtDocument.function__new_ops_OdtDocument__odf_OdfCanvas___undefined$signalUndoStackChanged="undo/changed";ops.OdtDocument.signalStepsInserted="steps/inserted";
ops.OdtDocument.signalStepsRemoved="steps/removed";ops.OdtDocument.signalMetadataUpdated="metadata/updated";ops.OdtDocument.signalAnnotationAdded="annotation/added";
ops.OpAddAnnotation=function(){function g(b,c,e){var f=b.getTextNodeAtStep(e,h);f&&(b=f.textNode,e=b.parentNode,f.offset!==b.length&&b.splitText(f.offset),e.insertBefore(c,b.nextSibling),b.length||e.removeChild(b))}var h,c,b,f,m,r;this.init=function(g){h=g.memberid;c=parseInt(g.timestamp,10);b=parseInt(g.position,10);f=void 0!==g.length?parseInt(g.length,10)||0:void 0;m=g.name};this.isEdit=!0;this.group=void 0;this.execute=function(p){var q=p.ops_OdtDocument$getCursor(h),e,l;r=p.getDOMDocument();
var a=new Date(c),d,n,k;d=r.createElementNS(odf.Namespaces.officens,"office:annotation");d.setAttributeNS(odf.Namespaces.officens,"office:name",m);e=r.createElementNS(odf.Namespaces.dcns,"dc:creator");e.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",h);e.textContent=p.getMember(h).getProperties().fullName;l=r.createElementNS(odf.Namespaces.dcns,"dc:date");l.appendChild(r.createTextNode(a.toISOString()));a=r.createElementNS(odf.Namespaces.textns,"text:list");n=r.createElementNS(odf.Namespaces.textns,
"text:list-item");k=r.createElementNS(odf.Namespaces.textns,"text:p");n.appendChild(k);a.appendChild(n);d.appendChild(e);d.appendChild(l);d.appendChild(a);void 0!==f&&(e=r.createElementNS(odf.Namespaces.officens,"office:annotation-end"),e.setAttributeNS(odf.Namespaces.officens,"office:name",m),d.annotationEndElement=e,g(p,e,b+f));g(p,d,b);p.ops_OdtDocument$emit("steps/inserted",{position:b});q&&(e=r.createRange(),l=d.getElementsByTagNameNS(odf.Namespaces.textns,"p")[0],e.selectNodeContents(l),q.ops_OdtCursor$setSelectedRange(e,
!1),q.setSelectionType("Range"),p.ops_OdtDocument$emit(ops.Document.signalCursorMoved,q));p.getOdfCanvas().odf_OdfCanvas$addAnnotation(d);p.fixCursorPositions();p.ops_OdtDocument$emit("annotation/added",{memberId:h,annotation:d});return!0};this.spec=function(){return{optype:"AddAnnotation",memberid:h,timestamp:c,position:b,length:f,name:m}}};
ops.OpAddCursor=function(){var g,h;this.init=function(c){g=c.memberid;h=c.timestamp};this.isEdit=!1;this.group=void 0;this.execute=function(c){var b=c.ops_OdtDocument$getCursor(g);if(b)return!1;b=new ops.OdtCursor(g,c);c.addCursor(b);c.ops_OdtDocument$emit(ops.Document.signalCursorAdded,b);return!0};this.spec=function(){return{optype:"AddCursor",memberid:g,timestamp:h}}};
ops.OpAddMember=function(){var g,h,c;this.init=function(b){g=b.memberid;h=parseInt(b.timestamp,10);c=b.setProperties};this.isEdit=!1;this.group=void 0;this.execute=function(b){var f;if(b.getMember(g))return!1;f=new ops.Member(g,c);b.addMember(f);b.ops_OdtDocument$emit(ops.Document.signalMemberAdded,f);return!0};this.spec=function(){return{optype:"AddMember",memberid:g,timestamp:h,setProperties:c}}};
ops.OpAddStyle=function(){var g,h,c,b,f,m,r=odf.Namespaces.stylens;this.init=function(p){g=p.memberid;h=p.timestamp;c=p.styleName;b=p.styleFamily;f="true"===p.isAutomaticStyle||!0===p.isAutomaticStyle;m=p.setProperties};this.isEdit=!0;this.group=void 0;this.execute=function(g){var h=g.getOdfCanvas().odfContainer(),e=g.ops_OdtDocument$getFormatting(),l=g.getDOMDocument().createElementNS(r,"style:style");if(!l)return!1;m&&e.updateStyle(l,m);l.setAttributeNS(r,"style:family",b);l.setAttributeNS(r,"style:name",
c);f?h.rootElement.automaticStyles.appendChild(l):h.rootElement.styles.appendChild(l);g.getOdfCanvas().refreshCSS();f||g.ops_OdtDocument$emit("style/created",{name:c,family:b});return!0};this.spec=function(){return{optype:"AddStyle",memberid:g,timestamp:h,styleName:c,styleFamily:b,isAutomaticStyle:f,setProperties:m}}};
odf.ObjectNameGenerator=function(g,h){function c(a,d){var b={};this.generateName=function(){var c=d(),e=0,f;do f=a+e,e+=1;while(b[f]||c[f]);b[f]=!0;return f}}function b(){var a={};[g.rootElement.automaticStyles,g.rootElement.styles].forEach(function(d){for(d=d.firstElementChild;d;)d.namespaceURI===f&&"style"===d.localName&&(a[d.getAttributeNS(f,"name")]=!0),d=d.nextElementSibling});return a}var f=odf.Namespaces.stylens,m=odf.Namespaces.drawns,r=odf.Namespaces.xlinkns,p=(new core.Utils).hashString(h),
q=null,e=null,l=null,a={},d={};this.generateStyleName=function(){q||(q=new c("auto"+p+"_",function(){return b()}));return q.generateName()};this.generateFrameName=function(){var d,b,f;if(!e){b=g.rootElement.body.getElementsByTagNameNS(m,"frame");for(d=0;d<b.length;d+=1)f=b.item(d),a[f.getAttributeNS(m,"name")]=!0;e=new c("fr"+p+"_",function(){return a})}return e.generateName()};this.generateImageName=function(){var a,b,e;if(!l){e=g.rootElement.body.getElementsByTagNameNS(m,"image");for(a=0;a<e.length;a+=
1)b=e.item(a),b=b.getAttributeNS(r,"href"),b=b.substring(9,b.lastIndexOf(".")),d[b]=!0;l=new c("img"+p+"_",function(){return d})}return l.generateName()}};
odf.TextStyleApplicator=function(g,h,c){function b(b){function c(a,b){return"object"===typeof a&&"object"===typeof b?Object.keys(a).every(function(e){return c(a[e],b[e])}):a===b}var a={};this.isStyleApplied=function(d){d=h.getAppliedStylesForElement(d,a).styleProperties;return c(b,d)}}function f(b){var f={};this.applyStyleToContainer=function(a){var d;d=a.getAttributeNS(p,"style-name");var n=a.ownerDocument;d=d||"";if(!f.hasOwnProperty(d)){var k=d,m;m=d?h.createDerivedStyleObject(d,"text",b):b;n=
n.createElementNS(q,"style:style");h.updateStyle(n,m);n.setAttributeNS(q,"style:name",g.generateStyleName());n.setAttributeNS(q,"style:family","text");n.setAttributeNS("urn:webodf:names:scope","scope","document-content");c.appendChild(n);f[k]=n}d=f[d].getAttributeNS(q,"name");a.setAttributeNS(p,"text:style-name",d)}}function m(b,c){var a=b.ownerDocument,d=b.parentNode,f,k,g,m=new core.LoopWatchDog(1E4);k=[];k.push(b);for(g=b.nextSibling;g&&r.rangeContainsNode(c,g);)m.core_LoopWatchDog$check(),k.push(g),
g=g.nextSibling;"span"!==d.localName||d.namespaceURI!==p?(f=a.createElementNS(p,"text:span"),d.insertBefore(f,b),a=!1):(b.previousSibling&&!r.rangeContainsNode(c,d.firstChild)?(f=d.cloneNode(!1),d.parentNode.insertBefore(f,d.nextSibling)):f=d,a=!0);k.forEach(function(a){a.parentNode!==f&&f.appendChild(a)});if(g&&a)for(k=f.cloneNode(!1),f.parentNode.insertBefore(k,f.nextSibling);g;)m.core_LoopWatchDog$check(),a=g.nextSibling,k.appendChild(g),g=a;return f}var r=core.DomUtils,p=odf.Namespaces.textns,
q=odf.Namespaces.stylens;this.applyStyle=function(c,g,a){var d={},n,k,h,p;runtime.BrowserRuntime$assert(a&&a.hasOwnProperty("style:text-properties"),"applyStyle without any text properties");d["style:text-properties"]=a["style:text-properties"];h=new f(d);p=new b(d);c.forEach(function(a){n=p.isStyleApplied(a);!1===n&&(k=m(a,g),h.applyStyleToContainer(k))})}};
ops.OpApplyDirectStyling=function(){function g(b,c,f){var a=b.getOdfCanvas().odfContainer(),d=p.splitBoundaries(c),n=r.getTextNodes(c,!1);(new odf.TextStyleApplicator(new odf.ObjectNameGenerator(a,h),b.ops_OdtDocument$getFormatting(),a.rootElement.automaticStyles)).applyStyle(n,c,f);d.forEach(p.normalizeTextNodes)}var h,c,b,f,m,r=odf.OdfUtils,p=core.DomUtils;this.init=function(g){h=g.memberid;c=g.timestamp;b=parseInt(g.position,10);f=parseInt(g.length,10);m=g.setProperties};this.isEdit=!0;this.group=
void 0;this.execute=function(p){var e=p.convertCursorToDomRange(b,f),l=r.getParagraphElements(e);g(p,e,m);e.detach();p.getOdfCanvas().refreshCSS();p.fixCursorPositions();l.forEach(function(a){p.ops_OdtDocument$emit("paragraph/changed",{paragraphElement:a,memberId:h,timeStamp:c})});p.getOdfCanvas().odf_OdfCanvas$rerenderAnnotations();return!0};this.spec=function(){return{optype:"ApplyDirectStyling",memberid:h,timestamp:c,position:b,length:f,setProperties:m}}};
ops.OpApplyHyperlink=function(){function g(b){for(;b;){if(p.isHyperlink(b))return!0;b=b.parentNode}return!1}var h,c,b,f,m,r=core.DomUtils,p=odf.OdfUtils;this.init=function(g){h=g.memberid;c=g.timestamp;b=g.position;f=g.length;m=g.hyperlink};this.isEdit=!0;this.group=void 0;this.execute=function(q){var e=q.getDOMDocument(),l=q.convertCursorToDomRange(b,f),a=r.splitBoundaries(l),d=[],n=p.getTextNodes(l,!1);if(!n.length)return!1;n.forEach(function(a){var b=p.getParagraphElement(a);runtime.BrowserRuntime$assert(!1===
g(a),"The given range should not contain any link.");var c=m,f=e.createElementNS(odf.Namespaces.textns,"text:a");f.setAttributeNS(odf.Namespaces.xlinkns,"xlink:type","simple");f.setAttributeNS(odf.Namespaces.xlinkns,"xlink:href",c);a.parentNode.insertBefore(f,a);f.appendChild(a);b&&-1===d.indexOf(b)&&d.push(b)});a.forEach(r.normalizeTextNodes);l.detach();q.fixCursorPositions();q.getOdfCanvas().refreshSize();q.getOdfCanvas().odf_OdfCanvas$rerenderAnnotations();d.forEach(function(a){q.ops_OdtDocument$emit("paragraph/changed",
{paragraphElement:a,memberId:h,timeStamp:c})});return!0};this.spec=function(){return{optype:"ApplyHyperlink",memberid:h,timestamp:c,position:b,length:f,hyperlink:m}}};
ops.OpInsertImage=function(){var g,h,c,b,f,m,r,p,q=odf.Namespaces.drawns,e=odf.Namespaces.svgns,l=odf.Namespaces.textns,a=odf.Namespaces.xlinkns,d=odf.OdfUtils;this.init=function(a){g=a.memberid;h=a.timestamp;c=a.position;b=a.filename;f=a.frameWidth;m=a.frameHeight;r=a.frameStyleName;p=a.frameName};this.isEdit=!0;this.group=void 0;this.execute=function(n){var k=n.getOdfCanvas(),y=n.getTextNodeAtStep(c,g),u,z;if(!y)return!1;u=y.textNode;z=d.getParagraphElement(u);var y=y.offset!==u.length?u.splitText(y.offset):
u.nextSibling,x=n.getDOMDocument(),w=x.createElementNS(q,"draw:image"),x=x.createElementNS(q,"draw:frame");w.setAttributeNS(a,"xlink:href",b);w.setAttributeNS(a,"xlink:type","simple");w.setAttributeNS(a,"xlink:show","embed");w.setAttributeNS(a,"xlink:actuate","onLoad");x.setAttributeNS(q,"draw:style-name",r);x.setAttributeNS(q,"draw:name",p);x.setAttributeNS(l,"text:anchor-type","as-char");x.setAttributeNS(e,"svg:width",f);x.setAttributeNS(e,"svg:height",m);x.appendChild(w);u.parentNode.insertBefore(x,
y);n.ops_OdtDocument$emit("steps/inserted",{position:c});u.length||u.parentNode.removeChild(u);k.addCssForFrameWithImage(x);k.refreshCSS();n.ops_OdtDocument$emit("paragraph/changed",{paragraphElement:z,memberId:g,timeStamp:h});k.odf_OdfCanvas$rerenderAnnotations();return!0};this.spec=function(){return{optype:"InsertImage",memberid:g,timestamp:h,filename:b,position:c,frameWidth:f,frameHeight:m,frameStyleName:r,frameName:p}}};
ops.OpInsertTable=function(){function g(a,d){var c;if(1===e.length)c=e[0];else if(3===e.length)switch(a){case 0:c=e[0];break;case b-1:c=e[2];break;default:c=e[1]}else c=e[a];if(1===c.length)return c[0];if(3===c.length)switch(d){case 0:return c[0];case f-1:return c[2];default:return c[1]}return c[d]}var h,c,b,f,m,r,p,q,e,l=odf.OdfUtils;this.init=function(a){h=a.memberid;c=a.timestamp;m=a.position;b=a.initialRows;f=a.initialColumns;r=a.tableName;p=a.tableStyleName;q=a.tableColumnStyleName;e=a.tableCellStyleMatrix};
this.isEdit=!0;this.group=void 0;this.execute=function(a){var d=a.getTextNodeAtStep(m),e=a.getRootNode();if(d){var k=a.getDOMDocument(),y=k.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table"),u=k.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-column"),z,x,w,v;p&&y.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",p);r&&y.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:name",r);u.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0",
"table:number-columns-repeated",f);q&&u.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",q);y.appendChild(u);for(w=0;w<b;w+=1){u=k.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-row");for(v=0;v<f;v+=1)z=k.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-cell"),(x=g(w,v))&&z.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",x),x=k.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0",
"text:p"),z.appendChild(x),u.appendChild(z);y.appendChild(u)}d=l.getParagraphElement(d.textNode);e.insertBefore(y,d.nextSibling);a.ops_OdtDocument$emit("steps/inserted",{position:m});a.getOdfCanvas().refreshSize();a.ops_OdtDocument$emit("table/added",{tableElement:y,memberId:h,timeStamp:c});a.getOdfCanvas().odf_OdfCanvas$rerenderAnnotations();return!0}return!1};this.spec=function(){return{optype:"InsertTable",memberid:h,timestamp:c,position:m,initialRows:b,initialColumns:f,tableName:r,tableStyleName:p,
tableColumnStyleName:q,tableCellStyleMatrix:e}}};
ops.OpInsertText=function(){function g(b){return"\t"!==b&&r.isODFWhitespace(b)}var h,c,b,f,m,r=odf.OdfUtils;this.init=function(g){h=g.memberid;c=g.timestamp;b=g.position;m=g.text;f="true"===g.moveCursor||!0===g.moveCursor};this.isEdit=!0;this.group=void 0;this.execute=function(p){var q,e,l,a,d=p.getDOMDocument(),n,k=0,y,u=p.ops_OdtDocument$getCursor(h),z;p.upgradeWhitespacesAtPosition(b);if(q=p.getTextNodeAtStep(b)){e=q.textNode;a=e.nextSibling;l=e.parentNode;n=r.getParagraphElement(e);for(z=0;z<
m.length;z+=1){if(!(y="\t"===m[z])){y=m;var x=z;y=g(y[x])&&(!x||x===y.length-1||g(y[x-1]))}y&&(k?k<z&&l.insertBefore(d.createTextNode(m.substring(k,z)),a):(q.offset!==e.length&&(a=e.splitText(q.offset)),0<z&&e.appendData(m.substring(0,z))),k=z+1,"\t"===m[z]?(y=d.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:tab"),y.appendChild(d.createTextNode("\t"))):(" "!==m[z]&&runtime.log("WARN: InsertText operation contains non-tab, non-space whitespace character (character code "+m.charCodeAt(z)+
")"),y=d.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:s"),y.appendChild(d.createTextNode(" "))),l.insertBefore(y,a))}k?k<m.length&&l.insertBefore(d.createTextNode(m.substring(k)),a):e.insertData(q.offset,m);q=e.parentNode;l=e.nextSibling;q.removeChild(e);q.insertBefore(e,l);e.length||e.parentNode.removeChild(e);p.ops_OdtDocument$emit("steps/inserted",{position:b});u&&f&&(p.moveCursor(h,b+m.length,0),p.ops_OdtDocument$emit(ops.Document.signalCursorMoved,u));p.downgradeWhitespacesAtPosition(b);
p.downgradeWhitespacesAtPosition(b+m.length);p.getOdfCanvas().refreshSize();p.ops_OdtDocument$emit("paragraph/changed",{paragraphElement:n,memberId:h,timeStamp:c});p.getOdfCanvas().odf_OdfCanvas$rerenderAnnotations();return!0}return!1};this.spec=function(){return{optype:"InsertText",memberid:h,timestamp:c,position:b,text:m,moveCursor:f}}};
odf.CollapsingRules=function(g){function h(c){return b.isODFNode(c)||"br"===c.localName&&b.isLineBreak(c.parentNode)||c.nodeType===Node.TEXT_NODE&&b.isODFNode(c.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}function c(m){var r;m.nodeType===Node.TEXT_NODE?(r=m.parentNode,r.removeChild(m)):r=f.removeUnwantedNodes(m,h);if(m=r)m=r,m=!b.isParagraph(m)&&m!==g&&b.hasNoODFContent(m);return m?c(r):r}var b=odf.OdfUtils,f=core.DomUtils;this.mergeChildrenIntoParent=c};
ops.OpMergeParagraph=function(){function g(a){return odf.OdfUtils.isInlineRoot(a)?NodeFilter.FILTER_SKIP:l.isGroupingElement(a)&&l.hasNoODFContent(a)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}function h(a){if(a.nodeType===Node.TEXT_NODE){if(!a.length)return runtime.log("WARN: Empty text node found during merge operation"),!0;if(l.isODFWhitespace(a.data)&&!1===l.isSignificantWhitespace(a,0))return!0;a="#text"}else a=(a.prefix?a.prefix+":":"")+a.localName;runtime.log("WARN: Unexpected text element found near paragraph boundary ["+
a+"]");return!1}function c(d){d.collapsed||(a.splitBoundaries(d),d=l.getTextElements(d,!1,!0).filter(h),d.forEach(function(a){a.parentNode.removeChild(a)}))}function b(a,d,b){a=a.convertCursorStepToDomPoint(d);var c=l.getParagraphElement(a.node,a.offset);runtime.BrowserRuntime$assert(!!c,"Paragraph not found at step "+d);b&&b.setPosition(a.node,a.offset);return c}var f,m,r,p,q,e,l=odf.OdfUtils,a=core.DomUtils,d=odf.Namespaces.textns;this.init=function(a){f=a.memberid;m=a.timestamp;r=a.moveCursor;
p=a.paragraphStyleName;q=parseInt(a.sourceStartPosition,10);e=parseInt(a.destinationStartPosition,10)};this.isEdit=!0;this.group=void 0;this.execute=function(n){var k,l,h=n.ops_OdtDocument$getCursor(f);k=n.getRootNode();var z=new odf.CollapsingRules(k),x=n.createStepIterator(k,0,[n.getPositionFilter()],k),w;runtime.BrowserRuntime$assert(e<q,"Destination paragraph ("+e+") must be before source paragraph ("+q+")");l=b(n,e);k=b(n,q,x);x.previousStep();runtime.BrowserRuntime$assert(a.core_DomUtilsImpl$containsNode(l,
x.container()),"Destination paragraph must be adjacent to the source paragraph");w=l.ownerDocument.createRange();x.setPosition(l,l.childNodes.length);x.roundToPreviousStep();w.setStart(x.container(),x.offset());w.setEnd(l,l.childNodes.length);c(w);w=l.childNodes.length;var v=k.ownerDocument.createRange();x.setPosition(k,0);x.roundToNextStep();v.setStart(k,0);v.setEnd(x.container(),x.offset());c(v);for(v=k.firstChild;v;)"editinfo"===v.localName?k.removeChild(v):(l.appendChild(v),a.removeUnwantedNodes(v,
g)),v=k.firstChild;runtime.BrowserRuntime$assert(!k.childNodes.length,"Source paragraph should be empty before it is removed");z.mergeChildrenIntoParent(k);n.ops_OdtDocument$emit("steps/removed",{position:q-1});x.setPosition(l,w);x.roundToClosestStep();x.previousStep()||x.roundToNextStep();n.downgradeWhitespaces(x);p?l.setAttributeNS(d,"text:style-name",p):l.removeAttributeNS(d,"style-name");h&&r&&(n.moveCursor(f,q-1,0),n.ops_OdtDocument$emit(ops.Document.signalCursorMoved,h));n.fixCursorPositions();
n.getOdfCanvas().refreshSize();n.ops_OdtDocument$emit("paragraph/changed",{paragraphElement:l,memberId:f,timeStamp:m});n.getOdfCanvas().odf_OdfCanvas$rerenderAnnotations();return!0};this.spec=function(){return{optype:"MergeParagraph",memberid:f,timestamp:m,moveCursor:r,paragraphStyleName:p,sourceStartPosition:q,destinationStartPosition:e}}};
ops.OpMoveCursor=function(){var g,h,c,b,f;this.init=function(m){g=m.memberid;h=m.timestamp;c=m.position;b=m.length||0;f=m.selectionType||"Range"};this.isEdit=!1;this.group=void 0;this.execute=function(m){var h=m.ops_OdtDocument$getCursor(g),p;if(!h)return!1;p=m.convertCursorToDomRange(c,b);h.ops_OdtCursor$setSelectedRange(p,0<=b);h.setSelectionType(f);m.ops_OdtDocument$emit(ops.Document.signalCursorMoved,h);return!0};this.spec=function(){return{optype:"MoveCursor",memberid:g,timestamp:h,position:c,
length:b,selectionType:f}}};
ops.OpRemoveAnnotation=function(){var g,h,c,b,f=core.DomUtils;this.init=function(f){g=f.memberid;h=f.timestamp;c=parseInt(f.position,10);b=parseInt(f.length,10)};this.isEdit=!0;this.group=void 0;this.execute=function(b){function g(b){q.parentNode.insertBefore(b,q)}for(var h=b.getIteratorAtPosition(c).container(),q;h.namespaceURI!==odf.Namespaces.officens||"annotation"!==h.localName;)h=h.parentNode;if(!h)return!1;q=h;h=q.annotationEndElement;b.getOdfCanvas().odf_OdfCanvas$forgetAnnotation(q);f.core_DomUtilsImpl$getElementsByTagNameNS(q,
"urn:webodf:names:cursor","cursor").forEach(g);f.core_DomUtilsImpl$getElementsByTagNameNS(q,"urn:webodf:names:cursor","anchor").forEach(g);q.parentNode.removeChild(q);h&&h.parentNode.removeChild(h);b.ops_OdtDocument$emit("steps/removed",{position:0<c?c-1:c});b.getOdfCanvas().odf_OdfCanvas$rerenderAnnotations();b.fixCursorPositions();return!0};this.spec=function(){return{optype:"RemoveAnnotation",memberid:g,timestamp:h,position:c,length:b}}};
ops.OpRemoveBlob=function(){var g,h,c;this.init=function(b){g=b.memberid;h=b.timestamp;c=b.filename};this.isEdit=!0;this.group=void 0;this.execute=function(b){b.getOdfCanvas().odfContainer().removeBlob(c);return!0};this.spec=function(){return{optype:"RemoveBlob",memberid:g,timestamp:h,filename:c}}};
ops.OpRemoveCursor=function(){var g,h;this.init=function(c){g=c.memberid;h=c.timestamp};this.isEdit=!1;this.group=void 0;this.execute=function(c){return c.ops_Document_prototype$removeCursor(g)?!0:!1};this.spec=function(){return{optype:"RemoveCursor",memberid:g,timestamp:h}}};
ops.OpRemoveHyperlink=function(){var g,h,c,b,f=core.DomUtils,m=odf.OdfUtils;this.init=function(f){g=f.memberid;h=f.timestamp;c=f.position;b=f.length};this.isEdit=!0;this.group=void 0;this.execute=function(r){var p=r.convertCursorToDomRange(c,b),q=m.getHyperlinkElements(p);runtime.BrowserRuntime$assert(1===q.length,"The given range should only contain a single link.");q=f.mergeIntoParent(q[0]);p.detach();r.fixCursorPositions();r.getOdfCanvas().refreshSize();r.getOdfCanvas().odf_OdfCanvas$rerenderAnnotations();
r.ops_OdtDocument$emit("paragraph/changed",{paragraphElement:m.getParagraphElement(q),memberId:g,timeStamp:h});return!0};this.spec=function(){return{optype:"RemoveHyperlink",memberid:g,timestamp:h,position:c,length:b}}};
ops.OpRemoveMember=function(){var g,h;this.init=function(c){g=c.memberid;h=parseInt(c.timestamp,10)};this.isEdit=!1;this.group=void 0;this.execute=function(c){if(!c.getMember(g))return!1;c.removeMember(g);c.ops_OdtDocument$emit(ops.Document.signalMemberRemoved,g);return!0};this.spec=function(){return{optype:"RemoveMember",memberid:g,timestamp:h}}};
ops.OpRemoveStyle=function(){var g,h,c,b;this.init=function(f){g=f.memberid;h=f.timestamp;c=f.styleName;b=f.styleFamily};this.isEdit=!0;this.group=void 0;this.execute=function(f){var g=f.ops_OdtDocument$getFormatting().getStyleElement(c,b);if(!g)return!1;g.parentNode.removeChild(g);f.getOdfCanvas().refreshCSS();f.ops_OdtDocument$emit("style/deleted",{name:c,family:b});return!0};this.spec=function(){return{optype:"RemoveStyle",memberid:g,timestamp:h,styleName:c,styleFamily:b}}};
ops.OpRemoveText=function(){var g,h,c,b,f=odf.OdfUtils,m=core.DomUtils;this.init=function(f){runtime.BrowserRuntime$assert(0<=f.length,"OpRemoveText only supports positive lengths");g=f.memberid;h=f.timestamp;c=parseInt(f.position,10);b=parseInt(f.length,10)};this.isEdit=!0;this.group=void 0;this.execute=function(r){var p,q,e,l=r.ops_OdtDocument$getCursor(g),a=new odf.CollapsingRules(r.getRootNode());r.upgradeWhitespacesAtPosition(c);r.upgradeWhitespacesAtPosition(c+b);p=r.convertCursorToDomRange(c,
b);m.splitBoundaries(p);q=f.getTextElements(p,!1,!0);e=f.getParagraphElement(p.startContainer,p.startOffset);runtime.BrowserRuntime$assert(!!e,"Attempting to remove text outside a paragraph element");p.detach();q.forEach(function(d){d.parentNode?(runtime.BrowserRuntime$assert(m.core_DomUtilsImpl$containsNode(e,d),"RemoveText only supports removing elements within the same paragraph"),a.mergeChildrenIntoParent(d)):runtime.log("WARN: text element has already been removed from it's container")});r.ops_OdtDocument$emit("steps/removed",
{position:c});r.downgradeWhitespacesAtPosition(c);r.fixCursorPositions();r.getOdfCanvas().refreshSize();r.ops_OdtDocument$emit("paragraph/changed",{paragraphElement:e,memberId:g,timeStamp:h});l&&(l.resetSelectionType(),r.ops_OdtDocument$emit(ops.Document.signalCursorMoved,l));r.getOdfCanvas().odf_OdfCanvas$rerenderAnnotations();return!0};this.spec=function(){return{optype:"RemoveText",memberid:g,timestamp:h,position:c,length:b}}};
ops.OpSetBlob=function(){var g,h,c,b,f;this.init=function(m){g=m.memberid;h=m.timestamp;c=m.filename;b=m.mimetype;f=m.content};this.isEdit=!0;this.group=void 0;this.execute=function(g){g.getOdfCanvas().odfContainer().setBlob(c,b,f);return!0};this.spec=function(){return{optype:"SetBlob",memberid:g,timestamp:h,filename:c,mimetype:b,content:f}}};
ops.OpSetParagraphStyle=function(){function g(b,c,f){var e=[b.getPositionFilter()],g=f.container();f=f.unfilteredDomOffset();return!1===b.createStepIterator(g,f,e,c).previousStep()}var h,c,b,f,m=odf.OdfUtils;this.init=function(g){h=g.memberid;c=g.timestamp;b=g.position;f=g.styleName};this.isEdit=!0;this.group=void 0;this.execute=function(r){var p,q;p=r.getIteratorAtPosition(b);return(q=m.getParagraphElement(p.container()))?(runtime.BrowserRuntime$assert(g(r,q,p),"SetParagraphStyle position should be the first position in the paragraph"),
f?q.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:style-name",f):q.removeAttributeNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","style-name"),r.getOdfCanvas().refreshSize(),r.ops_OdtDocument$emit("paragraph/changed",{paragraphElement:q,timeStamp:c,memberId:h}),r.getOdfCanvas().odf_OdfCanvas$rerenderAnnotations(),!0):!1};this.spec=function(){return{optype:"SetParagraphStyle",memberid:h,timestamp:c,position:b,styleName:f}}};
ops.OpSplitParagraph=function(){var g,h,c,b,f,m,r=odf.OdfUtils,p=odf.Namespaces.textns;this.init=function(p){g=p.memberid;h=p.timestamp;b=p.position;c=p.sourceParagraphPosition;m=p.paragraphStyleName;f="true"===p.moveCursor||!0===p.moveCursor};this.isEdit=!0;this.group=void 0;this.execute=function(c){var e,l,a,d,n,k,y,u=c.ops_OdtDocument$getCursor(g);c.upgradeWhitespacesAtPosition(b);e=c.getTextNodeAtStep(b);if(!e)return!1;l=r.getParagraphElement(e.textNode);if(!l)return!1;r.isListItem(l.parentNode)?
a=l.parentNode:a=l;e.offset?(y=e.textNode,e.offset>=e.textNode.length?k=null:k=e.textNode.splitText(e.offset)):(y=e.textNode.previousSibling,k=null);for(d=e.textNode;d!==a;){d=d.parentNode;n=d.cloneNode(!1);k&&n.appendChild(k);if(y)for(;y&&y.nextSibling;)n.appendChild(y.nextSibling);else for(;d.firstChild;)n.appendChild(d.firstChild);d.parentNode.insertBefore(n,d.nextSibling);y=d;k=n}r.isListItem(k)&&(k=k.childNodes.item(0));m?k.setAttributeNS(p,"text:style-name",m):k.removeAttributeNS(p,"style-name");
e.textNode.length||e.textNode.parentNode.removeChild(e.textNode);c.ops_OdtDocument$emit("steps/inserted",{position:b});u&&f&&(c.moveCursor(g,b+1,0),c.ops_OdtDocument$emit(ops.Document.signalCursorMoved,u));c.fixCursorPositions();c.getOdfCanvas().refreshSize();c.ops_OdtDocument$emit("paragraph/changed",{paragraphElement:l,memberId:g,timeStamp:h});c.ops_OdtDocument$emit("paragraph/changed",{paragraphElement:k,memberId:g,timeStamp:h});c.getOdfCanvas().odf_OdfCanvas$rerenderAnnotations();return!0};this.spec=
function(){return{optype:"SplitParagraph",memberid:g,timestamp:h,position:b,sourceParagraphPosition:c,paragraphStyleName:m,moveCursor:f}}};
ops.OpUpdateMember=function(){function g(c){var f="//dc:creator[@editinfo:memberid='"+h+"']";c=xmldom.XPath.getODFElementsWithXPath(c.getRootNode(),f,function(b){return"editinfo"===b?"urn:webodf:names:editinfo":odf.Namespaces.lookupNamespaceURI(b)});for(f=0;f<c.length;f+=1)c[f].textContent=b.fullName}var h,c,b,f;this.init=function(g){h=g.memberid;c=parseInt(g.timestamp,10);b=g.setProperties;f=g.removedProperties};this.isEdit=!1;this.group=void 0;this.execute=function(c){var r=c.getMember(h);if(!r)return!1;
f&&r.removeProperties(f);b&&(r.setProperties(b),b.fullName&&g(c));c.ops_OdtDocument$emit(ops.Document.signalMemberUpdated,r);return!0};this.spec=function(){return{optype:"UpdateMember",memberid:h,timestamp:c,setProperties:b,removedProperties:f}}};
ops.OpUpdateMetadata=function(){var g,h,c,b;this.init=function(f){g=f.memberid;h=parseInt(f.timestamp,10);c=f.setProperties;b=f.removedProperties};this.isEdit=!0;this.group=void 0;this.execute=function(f){var g=f.getOdfCanvas().odfContainer(),h=null;b&&(h=b.attributes.split(","));g.odf_OdfContainer$setMetadata(c,h);f.ops_OdtDocument$emit("metadata/updated",{setProperties:c?c:{},removedProperties:h?h:[]});return!0};this.spec=function(){return{optype:"UpdateMetadata",memberid:g,timestamp:h,setProperties:c,
removedProperties:b}}};
ops.OpUpdateParagraphStyle=function(){function g(b,c){var e,f,a=c?c.split(","):[];for(e=0;e<a.length;e+=1)f=a[e].split(":"),b.removeAttributeNS(odf.Namespaces.lookupNamespaceURI(f[0]),f[1])}var h,c,b,f,m,r=odf.Namespaces.stylens;this.init=function(g){h=g.memberid;c=g.timestamp;b=g.styleName;f=g.setProperties;m=g.removedProperties};this.isEdit=!0;this.group=void 0;this.execute=function(c){var h=c.ops_OdtDocument$getFormatting(),e,l,a;return(e=""!==b?h.getStyleElement(b,"paragraph"):h.getDefaultStyleElement("paragraph"))?
(l=e.getElementsByTagNameNS(r,"paragraph-properties").item(0),a=e.getElementsByTagNameNS(r,"text-properties").item(0),f&&h.updateStyle(e,f),m&&(h=m["style:paragraph-properties"],l&&h&&(g(l,h.attributes),l.attributes.length||e.removeChild(l)),h=m["style:text-properties"],a&&h&&(g(a,h.attributes),a.attributes.length||e.removeChild(a)),g(e,m.attributes)),c.getOdfCanvas().refreshCSS(),c.ops_OdtDocument$emit("paragraphstyle/modified",b),c.getOdfCanvas().odf_OdfCanvas$rerenderAnnotations(),!0):!1};this.spec=
function(){return{optype:"UpdateParagraphStyle",memberid:h,timestamp:c,styleName:b,setProperties:f,removedProperties:m}}};
ops.OperationFactory=function(){function g(c){return function(b){return new c}}var h;this.ops_OperationFactory$register=function(c,b){h[c]=b};this.ops_OperationFactory$create=function(c){var b=null,f=h[c.optype];f&&(b=f(c),b.init(c));return b};h={AddMember:g(ops.OpAddMember),UpdateMember:g(ops.OpUpdateMember),RemoveMember:g(ops.OpRemoveMember),AddCursor:g(ops.OpAddCursor),ApplyDirectStyling:g(ops.OpApplyDirectStyling),SetBlob:g(ops.OpSetBlob),RemoveBlob:g(ops.OpRemoveBlob),InsertImage:g(ops.OpInsertImage),
InsertTable:g(ops.OpInsertTable),InsertText:g(ops.OpInsertText),RemoveText:g(ops.OpRemoveText),MergeParagraph:g(ops.OpMergeParagraph),SplitParagraph:g(ops.OpSplitParagraph),SetParagraphStyle:g(ops.OpSetParagraphStyle),UpdateParagraphStyle:g(ops.OpUpdateParagraphStyle),AddStyle:g(ops.OpAddStyle),RemoveStyle:g(ops.OpRemoveStyle),MoveCursor:g(ops.OpMoveCursor),RemoveCursor:g(ops.OpRemoveCursor),AddAnnotation:g(ops.OpAddAnnotation),RemoveAnnotation:g(ops.OpRemoveAnnotation),UpdateMetadata:g(ops.OpUpdateMetadata),
ApplyHyperlink:g(ops.OpApplyHyperlink),RemoveHyperlink:g(ops.OpRemoveHyperlink)}};ops.OperationRouter=function(){};ops.OperationRouter.prototype.ops_OperationRouter_prototype$setOperationFactory=function(g){};ops.OperationRouter.prototype.ops_OperationRouter_prototype$setPlaybackFunction=function(g){};ops.OperationRouter.prototype.ops_OperationRouter_prototype$push=function(g){};ops.OperationRouter.prototype.ops_OperationRouter_prototype$close=function(g){};
ops.OperationRouter.prototype.ops_OperationRouter_prototype$subscribe=function(g,h){};ops.OperationRouter.prototype.unsubscribe=function(g,h){};ops.OperationRouter.prototype.hasLocalUnsyncedOps=function(){};ops.OperationRouter.prototype.hasSessionHostConnection=function(){};ops.OperationRouter.function__this_ops_OperationRouter____$signalProcessingBatchStart="router/batchstart";ops.OperationRouter.function__this_ops_OperationRouter____$signalProcessingBatchEnd="router/batchend";
ops.TrivialOperationRouter=function(){var g=new core.EventNotifier([ops.OperationRouter.function__this_ops_OperationRouter____$signalProcessingBatchStart,ops.OperationRouter.function__this_ops_OperationRouter____$signalProcessingBatchEnd]),h,c,b=0;this.ops_OperationRouter_prototype$setOperationFactory=function(b){h=b};this.ops_OperationRouter_prototype$setPlaybackFunction=function(b){c=b};this.ops_OperationRouter_prototype$push=function(f){b+=1;g.core_EventNotifier$emit(ops.OperationRouter.function__this_ops_OperationRouter____$signalProcessingBatchStart,
{});f.forEach(function(f){f=f.spec();f.timestamp=Date.now();f=h.ops_OperationFactory$create(f);f.group="g"+b;c(f)});g.core_EventNotifier$emit(ops.OperationRouter.function__this_ops_OperationRouter____$signalProcessingBatchEnd,{})};this.ops_OperationRouter_prototype$close=function(b){b()};this.ops_OperationRouter_prototype$subscribe=function(b,c){g.core_EventNotifier$subscribe(b,c)};this.unsubscribe=function(b,c){g.unsubscribe(b,c)};this.hasLocalUnsyncedOps=function(){return!1};this.hasSessionHostConnection=
function(){return!0}};
ops.Session=function(g){function h(b){f.ops_OdtDocument$emit("router/batchstart",b)}function c(b){f.ops_OdtDocument$emit("router/batchend",b)}var b=new ops.OperationFactory,f=new ops.OdtDocument(g),m=null;this.ops_Session$setOperationFactory=function(c){b=c;m&&m.ops_OperationRouter_prototype$setOperationFactory(b)};this.setOperationRouter=function(g){m&&(m.unsubscribe(ops.OperationRouter.function__this_ops_OperationRouter____$signalProcessingBatchStart,h),m.unsubscribe(ops.OperationRouter.function__this_ops_OperationRouter____$signalProcessingBatchEnd,c));
m=g;m.ops_OperationRouter_prototype$subscribe(ops.OperationRouter.function__this_ops_OperationRouter____$signalProcessingBatchStart,h);m.ops_OperationRouter_prototype$subscribe(ops.OperationRouter.function__this_ops_OperationRouter____$signalProcessingBatchEnd,c);g.ops_OperationRouter_prototype$setPlaybackFunction(function(b){f.ops_OdtDocument$emit("operation/start",b);return b.execute(f)?(f.ops_OdtDocument$emit("operation/end",b),!0):!1});g.ops_OperationRouter_prototype$setOperationFactory(b)};this.getOperationFactory=
function(){return b};this.ops_Session$getOdtDocument=function(){return f};this.enqueue=function(b){m.ops_OperationRouter_prototype$push(b)};this.ops_Session$close=function(b){m.ops_OperationRouter_prototype$close(function(c){c?b(c):f.ops_OdtDocument$close(b)})};this.destroy=function(b){f.destroy(b)};this.setOperationRouter(new ops.TrivialOperationRouter)};
gui.AnnotationController=function(g,h,c){function b(){var a=p.ops_OdtDocument$getCursor(c),a=a&&a.ops_OdtCursor$getNode(),b=!1;a&&(b=!l.isWithinAnnotation(a,p.getRootNode()));b!==q&&(q=b,e.core_EventNotifier$emit("annotatable/changed",q))}function f(a){a.gui_ShadowCursor$getMemberId()===c&&b()}function m(a){a===c&&b()}function r(a){a.gui_ShadowCursor$getMemberId()===c&&b()}var p=g.ops_Session$getOdtDocument(),q=!1,e=new core.EventNotifier(["annotatable/changed"]),l=odf.OdfUtils,a=core.StepDirection.NEXT;
this.isAnnotatable=function(){return q};this.gui_AnnotationController$addAnnotation=function(){var a=new ops.OpAddAnnotation,b=p.getCursorSelection(c),e=b.length,b=b.position;q&&(e?(b=0<=e?b:b+e,e=Math.abs(e)):e=void 0,a.init({memberid:c,position:b,length:e,name:c+Date.now()}),g.enqueue([a]))};this.removeAnnotation=function(d){var b,e;b=p.getMember(c).getProperties().fullName;if(!0!==h.getState(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN)||b===l.getAnnotationCreator(d))b=p.convertDomPointToCursorStep(d,
0,a),e=p.convertDomPointToCursorStep(d,d.childNodes.length),d=new ops.OpRemoveAnnotation,d.init({memberid:c,position:b,length:e-b}),e=new ops.OpMoveCursor,e.init({memberid:c,position:0<b?b-1:b,length:0}),g.enqueue([d,e])};this.gui_AnnotationController$subscribe=function(a,b){e.core_EventNotifier$subscribe(a,b)};this.unsubscribe=function(a,b){e.unsubscribe(a,b)};this.destroy=function(a){p.unsubscribe(ops.Document.signalCursorAdded,f);p.unsubscribe(ops.Document.signalCursorRemoved,m);p.unsubscribe(ops.Document.signalCursorMoved,
r);a()};h.registerConstraint(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN);p.ops_Document_prototype$subscribe(ops.Document.signalCursorAdded,f);p.ops_Document_prototype$subscribe(ops.Document.signalCursorRemoved,m);p.ops_Document_prototype$subscribe(ops.Document.signalCursorMoved,r);b()};gui.AnnotationController.annotatableChanged="annotatable/changed";
gui.Avatar=function(g,h){var c=this,b,f,m;this.gui_Avatar$setColor=function(b){f.style.borderColor=b};this.setImageUrl=function(b){c.isVisible()?f.src=b:m=b};this.isVisible=function(){return"block"===b.style.display};this.gui_Avatar$show=function(){m&&(f.src=m,m=void 0);b.style.display="block"};this.gui_Avatar$hide=function(){b.style.display="none"};this.markAsFocussed=function(c){c?b.classList.add("active"):b.classList.remove("active")};this.destroy=function(c){g.removeChild(b);c()};(function(){var c=
g.ownerDocument;b=c.createElement("div");f=c.createElement("img");b.appendChild(f);b.style.display=h?"block":"none";b.className="handle";g.appendChild(b)})()};gui.StepInfo=function(){};gui.StepInfo.VisualDirection={LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1};gui.StepInfo.prototype.container=function(){};gui.StepInfo.prototype.offset=function(){};gui.VisualStepScanner=function(){};gui.VisualStepScanner.prototype.gui_ClosestXOffsetScanner$process=function(g,h,c){};
gui.GuiStepUtils=function(){function g(f){f=c.getContentBounds(f);var g,e=null;if(f)if(f.container.nodeType===Node.TEXT_NODE)g=f.container.ownerDocument.createRange(),g.setStart(f.container,f.startOffset),g.setEnd(f.container,f.endOffset),(e=0<g.getClientRects().length?g.getBoundingClientRect():null)&&" "===f.container.data.substring(f.startOffset,f.endOffset)&&1>=e.width&&(e=null),g.detach();else if(h.isCharacterElement(f.container)||h.isCharacterFrame(f.container))e=b.core_DomUtilsImpl$getBoundingClientRect(f.container);
return e}var h=odf.OdfUtils,c=new odf.StepUtils,b=core.DomUtils,f=core.StepDirection.NEXT,m=gui.StepInfo.VisualDirection.LEFT_TO_RIGHT,r=gui.StepInfo.VisualDirection.RIGHT_TO_LEFT;this.getContentRect=g;this.moveToFilteredStep=function(b,c,e){function l(a,b){b.gui_ClosestXOffsetScanner$process(x,k,h)&&(a=!0,!u&&b.gui_ClosestXOffsetScanner$token&&(u=b.gui_ClosestXOffsetScanner$token));return a}var a=c===f,d,n,k,h,u,z=b.snapshot();d=!1;var x;do d=g(b),x={gui_StepInfo_prototype$token:b.snapshot(),container:b.container,
offset:b.offset,gui_StepInfo_prototype$direction:c,visualDirection:c===f?m:r},b.nextStep()?n=g(b):n=null,b.core_StepIterator$restore(x.gui_StepInfo_prototype$token),a?(k=d,h=n):(k=n,h=d),d=e.reduce(l,!1);while(!d&&b.advanceStep(c));d||e.forEach(function(a){!u&&a.gui_ClosestXOffsetScanner$token&&(u=a.gui_ClosestXOffsetScanner$token)});b.core_StepIterator$restore(u||z);return!!u}};
gui.Caret=function(g,h,c,b){function f(){a.style.opacity="0"===a.style.opacity?"1":"0";t.trigger()}function m(){y.selectNodeContents(k);return y.getBoundingClientRect()}function r(a){return S[a]!==L[a]}function p(){Object.keys(L).forEach(function(a){S[a]=L[a]})}function q(){if(!1===L.isShown||"Range"!==g.ops_OdtCursor$getSelectionType()||!b&&!g.ops_OdtCursor$getSelectedRange().collapsed)L.visibility="hidden",a.style.visibility="hidden",t.cancel();else if(L.visibility="visible",a.style.visibility=
"visible",!1===L.isFocused)a.style.opacity="1",t.cancel();else{if(D||r("visibility"))a.style.opacity="1",t.cancel();t.trigger()}if(A||J){var c;c=g.ops_OdtCursor$getNode();var e,f,k=z.core_DomUtilsImpl$getBoundingClientRect(u.getSizer()),q=!1,y=0;c.removeAttributeNS("urn:webodf:names:cursor","caret-sizer-active");if(0<c.getClientRects().length)f=m(),y=f.left-z.core_DomUtilsImpl$getBoundingClientRect(c).left,q=!0;else if(w.setPosition(c,0),f=x.getContentRect(w),!f&&w.nextStep()&&(e=x.getContentRect(w))&&
(f=e,q=!0),f||(c.setAttributeNS("urn:webodf:names:cursor","caret-sizer-active","true"),f=m(),q=!0),!f)for(runtime.log("WARN: No suitable client rectangle found for visual caret for "+g.gui_ShadowCursor$getMemberId());c;){if(0<c.getClientRects().length){f=z.core_DomUtilsImpl$getBoundingClientRect(c);q=!0;break}c=c.parentNode}f=z.translateRect(f,k,u.gui_AnnotatableCanvas_prototype$getZoomLevel());c={top:f.top,height:f.height,right:q?f.left:f.right,width:z.adaptRangeDifferenceToZoomLevel(y,u.gui_AnnotatableCanvas_prototype$getZoomLevel())};
8>c.height&&(c={top:c.top-(8-c.height)/2,height:8,right:c.right});l.style.height=c.height+"px";l.style.top=c.top+"px";l.style.left=c.right-c.width+"px";l.style.width=c.width?c.width+"px":"";n&&(c=runtime.getWindow().getComputedStyle(g.ops_OdtCursor$getNode(),null),c.font?n.style.font=c.font:(n.style.fontStyle=c.fontStyle,n.style.fontVariant=c.fontVariant,n.style.fontWeight=c.fontWeight,n.style.fontSize=c.fontSize,n.style.lineHeight=c.lineHeight,n.style.fontFamily=c.fontFamily))}L.isShown&&J&&h.gui_SingleScrollViewport$scrollIntoView(a.getBoundingClientRect());
r("isFocused")&&d.markAsFocussed(L.isFocused);p();A=J=D=!1}function e(a){l.parentNode.removeChild(l);k.parentNode.removeChild(k);a()}var l,a,d,n,k,y,u=g.ops_OdtCursor$getDocument().getCanvas(),z=core.DomUtils,x=new gui.GuiStepUtils,w,v,t,D=!1,J=!1,A=!1,L={isFocused:!1,isShown:!0,visibility:"hidden"},S={isFocused:!L.isFocused,isShown:!L.isShown,visibility:"hidden"};this.handleUpdate=function(){A=!0;v.trigger()};this.refreshCursorBlinking=function(){D=!0;v.trigger()};this.setFocus=function(){L.isFocused=
!0;v.trigger()};this.removeFocus=function(){L.isFocused=!1;v.trigger()};this.gui_Caret$show=function(){L.isShown=!0;v.trigger()};this.gui_Caret$hide=function(){L.isShown=!1;v.trigger()};this.setAvatarImageUrl=function(a){d.setImageUrl(a)};this.gui_Caret$setColor=function(b){a.style.borderColor=b;d.gui_Avatar$setColor(b)};this.gui_Caret$getCursor=function(){return g};this.getFocusElement=function(){return a};this.toggleHandleVisibility=function(){d.isVisible()?d.gui_Avatar$hide():d.gui_Avatar$show()};
this.gui_Caret$showHandle=function(){d.gui_Avatar$show()};this.gui_Caret$hideHandle=function(){d.gui_Avatar$hide()};this.setOverlayElement=function(a){n=a;l.appendChild(a);A=!0;v.trigger()};this.ensureVisible=function(){J=!0;v.trigger()};this.gui_Caret$getBoundingClientRect=function(){return z.core_DomUtilsImpl$getBoundingClientRect(l)};this.destroy=function(a){core.Async.destroyAll([v.destroy,t.destroy,d.destroy,e],a)};(function(){var b=g.ops_OdtCursor$getDocument(),e=[b.createRootFilter(g.gui_ShadowCursor$getMemberId()),
b.getPositionFilter()],n=b.getDOMDocument();y=n.createRange();k=n.createElement("span");k.className="webodf-caretSizer";k.textContent="|";g.ops_OdtCursor$getNode().appendChild(k);l=n.createElement("div");l.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",g.gui_ShadowCursor$getMemberId());l.className="webodf-caretOverlay";a=n.createElement("div");a.className="caret";l.appendChild(a);d=new gui.Avatar(l,c);u.getSizer().appendChild(l);w=b.createStepIterator(g.ops_OdtCursor$getNode(),0,e,
b.getRootNode());v=core.Task.createRedrawTask(q);t=core.Task.createTimeoutTask(f,500);v.triggerImmediate()})()};
odf.TextSerializer=function(){function g(b){var f="",m=h.odf_TextSerializer$filter?h.odf_TextSerializer$filter.acceptNode(b):NodeFilter.FILTER_ACCEPT,r=b.nodeType,p;if((m===NodeFilter.FILTER_ACCEPT||m===NodeFilter.FILTER_SKIP)&&c.isTextContentContainingNode(b))for(p=b.firstChild;p;)f+=g(p),p=p.nextSibling;m===NodeFilter.FILTER_ACCEPT&&(r===Node.ELEMENT_NODE&&c.isParagraph(b)?f+="\n":r===Node.TEXT_NODE&&b.textContent&&(f+=b.textContent));return f}var h=this,c=odf.OdfUtils;this.odf_TextSerializer$filter=
null;this.odf_TextSerializer$writeToString=function(b){if(!b)return"";b=g(b);"\n"===b[b.length-1]&&(b=b.substr(0,b.length-1));return b}};gui.MimeDataExporter=function(){var g;this.exportRangeToDataTransfer=function(h,c){var b;b=c.startContainer.ownerDocument.createElement("span");b.appendChild(c.cloneContents());b=g.odf_TextSerializer$writeToString(b);try{h.setData("text/plain",b)}catch(f){h.setData("Text",b)}};g=new odf.TextSerializer;g.odf_TextSerializer$filter=new odf.OdfNodeFilter};
gui.Clipboard=function(g){this.setDataFromRange=function(h,c){var b,f=h.clipboardData;b=runtime.getWindow();!f&&b&&(f=b.clipboardData);f?(b=!0,g.exportRangeToDataTransfer(f,c),h.preventDefault()):b=!1;return b}};
gui.SessionContext=function(g,h){var c=g.ops_Session$getOdtDocument(),b=odf.OdfUtils;this.isLocalCursorWithinOwnAnnotation=function(){var f=c.ops_OdtDocument$getCursor(h),g;if(!f)return!1;g=f&&f.ops_OdtCursor$getNode();f=c.getMember(h).getProperties().fullName;return(g=b.getParentAnnotation(g,c.getRootNode()))&&b.getAnnotationCreator(g)===f?!0:!1}};
gui.StyleSummary=function(g){function h(b,c){var h=b+"|"+c,q;f.hasOwnProperty(h)||(q=[],g.forEach(function(e){e=(e=e.styleProperties[b])&&e[c];-1===q.indexOf(e)&&q.push(e)}),f[h]=q);return f[h]}function c(b,c,f){return function(){var g=h(b,c);return f.length>=g.length&&g.every(function(b){return-1!==f.indexOf(b)})}}function b(b,c){var f=h(b,c);return 1===f.length?f[0]:void 0}var f={};this.getPropertyValues=h;this.getCommonValue=b;this.isBold=c("style:text-properties","fo:font-weight",["bold"]);this.isItalic=
c("style:text-properties","fo:font-style",["italic"]);this.hasUnderline=c("style:text-properties","style:text-underline-style",["solid"]);this.hasStrikeThrough=c("style:text-properties","style:text-line-through-style",["solid"]);this.fontSize=function(){var c=b("style:text-properties","fo:font-size");return c&&parseFloat(c)};this.fontName=function(){return b("style:text-properties","style:font-name")};this.isAlignedLeft=c("style:paragraph-properties","fo:text-align",["left","start"]);this.isAlignedCenter=
c("style:paragraph-properties","fo:text-align",["center"]);this.isAlignedRight=c("style:paragraph-properties","fo:text-align",["right","end"]);this.isAlignedJustified=c("style:paragraph-properties","fo:text-align",["justify"]);this.text={isBold:this.isBold,isItalic:this.isItalic,hasUnderline:this.hasUnderline,hasStrikeThrough:this.hasStrikeThrough,fontSize:this.fontSize,fontName:this.fontName};this.paragraph={isAlignedLeft:this.isAlignedLeft,isAlignedCenter:this.isAlignedCenter,isAlignedRight:this.isAlignedRight,
isAlignedJustified:this.isAlignedJustified}};
gui.DirectFormattingController=function(g,h,c,b,f,m,r){function p(){return T.value().styleSummary}function q(){return T.value().gui_DirectFormattingController_SelectionInfo$enabledFeatures}function e(a){var b;a.collapsed?(b=a.startContainer,b.hasChildNodes()&&a.startOffset<b.childNodes.length&&(b=b.childNodes.item(a.startOffset)),a=[b]):a=W.getTextElements(a,!0,!1);return a}function l(){var a=N.ops_OdtDocument$getCursor(b),d=a&&a.ops_OdtCursor$getSelectedRange(),f;f=[];var k=!0,g={directTextStyling:!0,
directParagraphStyling:!0};d&&(f=e(d),f.length||(f=[d.startContainer,d.endContainer],k=!1),f=N.ops_OdtDocument$getFormatting().odf_Formatting$getAppliedStyles(f));f[0]&&ca&&(f[0].styleProperties=Y.mergeObjects(f[0].styleProperties,ca));!0===h.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(g.directTextStyling=g.directParagraphStyling=c.isLocalCursorWithinOwnAnnotation());g.directTextStyling&&(g.directTextStyling=k&&!!a&&"Range"===a.ops_OdtCursor$getSelectionType());return{gui_DirectFormattingController_SelectionInfo$enabledFeatures:g,
appliedStyles:f,styleSummary:new gui.StyleSummary(f)}}function a(a,b){var d={};Object.keys(a).forEach(function(c){var e=a[c](),f=b[c]();e!==f&&(d[c]=f)});return d}function d(){var b,d;d=ba.styleSummary;var c=T.value(),e=c.styleSummary,f=ba.gui_DirectFormattingController_SelectionInfo$enabledFeatures,k=c.gui_DirectFormattingController_SelectionInfo$enabledFeatures;b=a(d.text,e.text);d=a(d.paragraph,e.paragraph);f=!(k.directTextStyling===f.directTextStyling&&k.directParagraphStyling===f.directParagraphStyling);
ba=c;f&&fa.core_EventNotifier$emit("enabled/changed",k);0<Object.keys(b).length&&fa.core_EventNotifier$emit("textStyling/changed",b);0<Object.keys(d).length&&fa.core_EventNotifier$emit("paragraphStyling/changed",d)}function n(){T.core_LazyProperty$reset();d()}function k(a){("string"===typeof a?a:a.gui_ShadowCursor$getMemberId())===b&&T.core_LazyProperty$reset()}function y(){T.core_LazyProperty$reset()}function u(a){var d=N.ops_OdtDocument$getCursor(b);a=a.paragraphElement;d&&W.getParagraphElement(d.ops_OdtCursor$getNode())===
a&&T.core_LazyProperty$reset()}function z(a,b){b(!a());return!0}function x(a){if(q().directTextStyling){var d=N.getCursorSelection(b),c={"style:text-properties":a};d.length?(a=new ops.OpApplyDirectStyling,a.init({memberid:b,position:d.position,length:d.length,setProperties:c}),g.enqueue([a])):(ca=Y.mergeObjects(ca||{},c),T.core_LazyProperty$reset())}}function w(a,b){var d={};d[a]=b;x(d)}function v(a){a=a.spec();ca&&a.memberid===b&&"SplitParagraph"!==a.optype&&(ca=null,T.core_LazyProperty$reset())}
function t(a){w("fo:font-weight",a?"bold":"normal")}function D(a){w("fo:font-style",a?"italic":"normal")}function J(a){w("style:text-underline-style",a?"solid":"none")}function A(a){w("style:text-line-through-style",a?"solid":"none")}function L(a){if(q().directParagraphStyling){var d=N.ops_OdtDocument$getCursor(b).ops_OdtCursor$getSelectedRange(),d=W.getParagraphElements(d),c=N.ops_OdtDocument$getFormatting(),e=[],k={},n;d.forEach(function(d){var g=N.convertDomPointToCursorStep(d,0,X);d=d.getAttributeNS(odf.Namespaces.textns,
"style-name");var l,h;d?l=k.hasOwnProperty(d)?k[d]:void 0:l=n;l||(l=f.generateStyleName(),d?(k[d]=l,h=c.createDerivedStyleObject(d,"paragraph",{})):(n=l,h={}),h=a(h),d=new ops.OpAddStyle,d.init({memberid:b,styleName:l.toString(),styleFamily:"paragraph",isAutomaticStyle:!0,setProperties:h}),e.push(d));d=new ops.OpSetParagraphStyle;d.init({memberid:b,styleName:l.toString(),position:g});e.push(d)});g.enqueue(e)}}function S(a){L(function(b){return Y.mergeObjects(b,a)})}function K(a){S({"style:paragraph-properties":{"fo:text-align":a}})}
function R(a,b){var d=N.ops_OdtDocument$getFormatting().getDefaultTabStopDistance(),c=b["style:paragraph-properties"],e;c&&(c=c["fo:margin-left"],e=W.odf_OdfUtilsImpl$parseLength(c));return Y.mergeObjects(b,{"style:paragraph-properties":{"fo:margin-left":e&&e.unit===d.unit?e.value+a*d.value+e.unit:a*d.value+d.unit}})}function B(a,b){var d=e(a),d=d.length?d:[a.startContainer],d=N.ops_OdtDocument$getFormatting().odf_Formatting$getAppliedStyles(d),c=0<d.length?d[0].styleProperties:void 0,f=N.ops_OdtDocument$getFormatting().getAppliedStylesForElement(b).styleProperties;
if(!c||"text"!==c["style:family"]||!c["style:text-properties"])return!1;if(!f||!f["style:text-properties"])return!0;c=c["style:text-properties"];f=f["style:text-properties"];return!Object.keys(c).every(function(a){return c[a]===f[a]})}function V(){}function U(){return!1}function M(){return!1}var P=this,N=g.ops_Session$getOdtDocument(),Y=new core.Utils,W=odf.OdfUtils,fa=new core.EventNotifier(["enabled/changed","textStyling/changed","paragraphStyling/changed"]),C=odf.Namespaces.textns,X=core.StepDirection.NEXT,
ca=null,ba,T;this.gui_DirectFormattingController$enabledFeatures=q;this.formatTextSelection=x;this.createCursorStyleOp=function(a,d,c){var e=null,f=ca;c&&(f=(c=T.value().appliedStyles[0])&&c.styleProperties);f&&f["style:text-properties"]&&(e=new ops.OpApplyDirectStyling,e.init({memberid:b,position:a,length:d,setProperties:{"style:text-properties":f["style:text-properties"]}}),ca=null,T.core_LazyProperty$reset());return e};this.setBold=t;this.setItalic=D;this.setHasUnderline=J;this.setHasStrikethrough=
A;this.setFontSize=function(a){w("fo:font-size",a+"pt")};this.setFontName=function(a){w("style:font-name",a)};this.gui_DirectFormattingController$getAppliedStyles=function(){return T.value().appliedStyles};this.toggleBold=z.bind(P,function(){return p().isBold()},t);this.toggleItalic=z.bind(P,function(){return p().isItalic()},D);this.toggleUnderline=z.bind(P,function(){return p().hasUnderline()},J);this.toggleStrikethrough=z.bind(P,function(){return p().hasStrikeThrough()},A);this.isBold=function(){return p().isBold()};
this.isItalic=function(){return p().isItalic()};this.hasUnderline=function(){return p().hasUnderline()};this.hasStrikeThrough=function(){return p().hasStrikeThrough()};this.fontSize=function(){return p().fontSize()};this.fontName=function(){return p().fontName()};this.isAlignedLeft=function(){return p().isAlignedLeft()};this.isAlignedCenter=function(){return p().isAlignedCenter()};this.isAlignedRight=function(){return p().isAlignedRight()};this.isAlignedJustified=function(){return p().isAlignedJustified()};
this.alignParagraphLeft=function(){K("left");return!0};this.alignParagraphCenter=function(){K("center");return!0};this.alignParagraphRight=function(){K("right");return!0};this.alignParagraphJustified=function(){K("justify");return!0};this.indent=function(){L(R.bind(null,1));return!0};this.outdent=function(){L(R.bind(null,-1));return!0};this.createParagraphStyleOps=function(a){if(!q().directParagraphStyling)return[];var d=N.ops_OdtDocument$getCursor(b),c=d.ops_OdtCursor$getSelectedRange(),e=[],k,g;
d.hasForwardSelection()?(k=d.ops_OdtCursor$getAnchorNode(),g=d.ops_OdtCursor$getNode()):(k=d.ops_OdtCursor$getNode(),g=d.ops_OdtCursor$getAnchorNode());d=W.getParagraphElement(g);runtime.BrowserRuntime$assert(!!d,"DirectFormattingController: Cursor outside paragraph");var n=d,l=[N.getPositionFilter(),N.createRootFilter(b)];if(!1!==N.createStepIterator(c.endContainer,c.endOffset,l,n).nextStep())return e;g!==k&&(d=W.getParagraphElement(k));if(!ca&&!B(c,d))return e;c=(c=T.value().appliedStyles[0])&&
c.styleProperties;if(!c)return e;if(d=d.getAttributeNS(C,"style-name"))c={"style:text-properties":c["style:text-properties"]},c=N.ops_OdtDocument$getFormatting().createDerivedStyleObject(d,"paragraph",c);k=f.generateStyleName();d=new ops.OpAddStyle;d.init({memberid:b,styleName:k,styleFamily:"paragraph",isAutomaticStyle:!0,setProperties:c});e.push(d);d=new ops.OpSetParagraphStyle;d.init({memberid:b,styleName:k,position:a});e.push(d);return e};this.gui_DirectFormattingController$subscribe=function(a,
d){fa.core_EventNotifier$subscribe(a,d)};this.unsubscribe=function(a,d){fa.unsubscribe(a,d)};this.destroy=function(a){N.unsubscribe(ops.Document.signalCursorAdded,k);N.unsubscribe(ops.Document.signalCursorRemoved,k);N.unsubscribe(ops.Document.signalCursorMoved,k);N.unsubscribe("paragraphstyle/modified",y);N.unsubscribe("paragraph/changed",u);N.unsubscribe("operation/end",v);N.unsubscribe("router/batchend",d);h.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,n);a()};(function(){N.ops_Document_prototype$subscribe(ops.Document.signalCursorAdded,
k);N.ops_Document_prototype$subscribe(ops.Document.signalCursorRemoved,k);N.ops_Document_prototype$subscribe(ops.Document.signalCursorMoved,k);N.ops_Document_prototype$subscribe("paragraphstyle/modified",y);N.ops_Document_prototype$subscribe("paragraph/changed",u);N.ops_Document_prototype$subscribe("operation/end",v);N.ops_Document_prototype$subscribe("router/batchend",d);h.gui_SessionConstraints$subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,n);T=new core.LazyProperty(l);ba=T.value();m||(P.formatTextSelection=
V,P.setBold=V,P.setItalic=V,P.setHasUnderline=V,P.setHasStrikethrough=V,P.setFontSize=V,P.setFontName=V,P.toggleBold=M,P.toggleItalic=M,P.toggleUnderline=M,P.toggleStrikethrough=M);r||(P.alignParagraphCenter=U,P.alignParagraphJustified=U,P.alignParagraphLeft=U,P.alignParagraphRight=U,P.createParagraphStyleOps=function(){return[]},P.indent=U,P.outdent=U)})()};
gui.DirectFormattingController.function__new_gui_DirectFormattingController__ops_Session__gui_SessionConstraints__gui_SessionContext__string__odf_ObjectNameGenerator__boolean__boolean___undefined$enabledChanged="enabled/changed";gui.DirectFormattingController.textStylingChanged="textStyling/changed";gui.DirectFormattingController.paragraphStylingChanged="paragraphStyling/changed";gui.DirectFormattingController.SelectionInfo=function(){};
gui.KeyboardHandler=function(){function g(b,c){c||(c=h.None);switch(b){case gui.KeyboardHandler.KeyCode.LeftMeta:case gui.KeyboardHandler.KeyCode.RightMeta:case gui.KeyboardHandler.KeyCode.MetaInMozilla:c|=h.Meta;break;case gui.KeyboardHandler.KeyCode.Ctrl:c|=h.Ctrl;break;case gui.KeyboardHandler.KeyCode.Alt:c|=h.Alt;break;case gui.KeyboardHandler.KeyCode.Shift:c|=h.Shift}return b+":"+c}var h=gui.KeyboardHandler.Modifier,c=null,b={};this.setDefault=function(b){c=b};this.bind=function(c,h,r,p){c=g(c,
h);runtime.BrowserRuntime$assert(p||!1===b.hasOwnProperty(c),"tried to overwrite the callback handler of key combo: "+c);b[c]=r};this.unbind=function(c,h){var r=g(c,h);delete b[r]};this.gui_KeyboardHandler$reset=function(){c=null;b={}};this.gui_KeyboardHandler$handleEvent=function(f){var m=f.keyCode,r=h.None;f.metaKey&&(r|=h.Meta);f.ctrlKey&&(r|=h.Ctrl);f.altKey&&(r|=h.Alt);f.shiftKey&&(r|=h.Shift);m=g(m,r);m=b[m];r=!1;m?r=m():c&&(r=c(f));r&&(f.preventDefault?f.preventDefault():f.returnValue=!1)}};
gui.KeyboardHandler.Modifier={None:0,Meta:1,Ctrl:2,Alt:4,CtrlAlt:6,Shift:8,MetaShift:9,CtrlShift:10,AltShift:12};gui.KeyboardHandler.KeyCode={Backspace:8,Tab:9,Clear:12,Enter:13,Shift:16,Ctrl:17,Alt:18,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Delete:46,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,LeftMeta:91,RightMeta:93,MetaInMozilla:224};
gui.HyperlinkClickHandler=function(g,h,c){function b(){var a=g();runtime.BrowserRuntime$assert(!!a.classList,"Document container has no classList element");a.classList.remove("webodf-inactiveLinks")}function f(){var a=g();runtime.BrowserRuntime$assert(!!a.classList,"Document container has no classList element");a.classList.add("webodf-inactiveLinks")}function m(){a.removeEventListener("focus",f,!1);n.forEach(function(a){h.unbind(a.keyCode,a.modifier);c.unbind(a.keyCode,a.modifier)});n.length=0}function r(d){m();
if(d!==p.None){a.addEventListener("focus",f,!1);switch(d){case p.Ctrl:n.push({keyCode:q.Ctrl,modifier:p.None});break;case p.Meta:n.push({keyCode:q.LeftMeta,modifier:p.None}),n.push({keyCode:q.RightMeta,modifier:p.None}),n.push({keyCode:q.MetaInMozilla,modifier:p.None})}n.forEach(function(a){h.bind(a.keyCode,a.modifier,b);c.bind(a.keyCode,a.modifier,f)})}}var p=gui.KeyboardHandler.Modifier,q=gui.KeyboardHandler.KeyCode,e=xmldom.XPath,l=odf.OdfUtils,a=runtime.getWindow(),d=p.None,n=[];runtime.BrowserRuntime$assert(!!a,
"Expected to be run in an environment which has a global window, like a browser.");this.handleClick=function(b){var c=b.target||b.srcElement,f,n;b.ctrlKey?f=p.Ctrl:b.metaKey&&(f=p.Meta);if(d===p.None||d===f){a:{for(;c;){if(l.isHyperlink(c))break a;if(l.isParagraph(c))break;c=c.parentNode}c=null}c&&(c=l.getHyperlinkTarget(c),""!==c&&("#"===c[0]?(c=c.substring(1),f=g(),n=e.getODFElementsWithXPath(f,"//text:bookmark-start[@text:name='"+c+"']",odf.Namespaces.lookupNamespaceURI),n.length||(n=e.getODFElementsWithXPath(f,
"//text:bookmark[@text:name='"+c+"']",odf.Namespaces.lookupNamespaceURI)),0<n.length&&n[0].scrollIntoView(!0)):/^\s*(javascript|data):/.test(c)?runtime.log("WARN:","potentially malicious URL ignored"):a.open(c),b.preventDefault?b.preventDefault():b.returnValue=!1))}};this.setModifier=function(a){d!==a&&(runtime.BrowserRuntime$assert(a===p.None||a===p.Ctrl||a===p.Meta,"Unsupported KeyboardHandler.Modifier value: "+a),d=a,d!==p.None?f():b(),r(d))};this.getModifier=function(){return d};this.destroy=
function(a){f();m();a()}};
gui.EventManager=function(g){function h(a){function b(a,d,c){var e,f=!1;e="on"+d;a.attachEvent&&(a.attachEvent(e,c),f=!0);!f&&a.addEventListener&&(a.addEventListener(d,c,!1),f=!0);f&&!v[d]||!a.hasOwnProperty(e)||(a[e]=c)}function d(a,b,c){var e="on"+b;a.detachEvent&&a.detachEvent(e,c);a.removeEventListener&&a.removeEventListener(b,c,!1);a[e]===c&&(a[e]=null)}function c(b){if(-1===f.indexOf(b)){f.push(b);if(e.EventDelegate$filters.every(function(a){return a(b)}))try{k.core_EventNotifier$emit(a,b)}catch(d$7){runtime.log("Error occurred while processing "+
a+":\n"+d$7.message+"\n"+d$7.stack)}runtime.BrowserRuntime$setTimeout(function(){f.splice(f.indexOf(b),1)},0)}}var e=this,f=[],k=new core.EventNotifier([a]);this.EventDelegate$filters=[];this.CompoundEvent$subscribe=function(b){k.core_EventNotifier$subscribe(a,b)};this.unsubscribe=function(b){k.unsubscribe(a,b)};this.destroy=function(){d(w,a,c);d(A,a,c);d(L,a,c)};t[a]&&b(w,a,c);b(A,a,c);b(L,a,c)}function c(a,b,d){function c(b){d(b,e,function(b){b.type=a;f.core_EventNotifier$emit(a,b)})}var e={},f=
new core.EventNotifier([a]);this.CompoundEvent$subscribe=function(b){f.core_EventNotifier$subscribe(a,b)};this.unsubscribe=function(b){f.unsubscribe(a,b)};this.destroy=function(){b.forEach(function(a){S.unsubscribe(a,c)})};(function(){b.forEach(function(a){S.gui_EventManager$subscribe(a,c)})})()}function b(a){runtime.BrowserRuntime$clearTimeout(a);delete K[a]}function f(a,d){var c=runtime.BrowserRuntime$setTimeout(function(){a();b(c)},d);K[c]=!0;return c}function m(a,d,c){var e=a.touches.length,k=
a.touches[0],g=d.timer;"touchmove"===a.type||"touchend"===a.type?g&&b(g):"touchstart"===a.type&&(1!==e?runtime.BrowserRuntime$clearTimeout(g):g=f(function(){c({clientX:k.clientX,clientY:k.clientY,pageX:k.pageX,pageY:k.pageY,target:a.target||a.srcElement||null,detail:1})},400));d.timer=g}function r(a,b,d){var c=a.touches[0],e=a.target||a.srcElement||null,f=b.target;1!==a.touches.length||"touchend"===a.type?f=null:"touchstart"===a.type&&"webodf-draggable"===e.getAttribute("class")?f=e:"touchmove"===
a.type&&f&&(a.preventDefault(),a.stopPropagation(),d({clientX:c.clientX,clientY:c.clientY,pageX:c.pageX,pageY:c.pageY,target:f,detail:1}));b.target=f}function p(a,b,d){var c=a.target||a.srcElement||null,e=b.dragging;"drag"===a.type?e=!0:"touchend"===a.type&&e&&(e=!1,a=a.changedTouches[0],d({clientX:a.clientX,clientY:a.clientY,pageX:a.pageX,pageY:a.pageY,target:c,detail:1}));b.dragging=e}function q(){L.classList.add("webodf-touchEnabled");S.unsubscribe("touchstart",q)}function e(a){var b=a.scrollX,
d=a.scrollY;this.WindowScrollState$restore=function(){a.scrollX===b&&a.scrollY===d||a.scrollTo(b,d)}}function l(a){var b=a.scrollTop,d=a.scrollLeft;this.ElementScrollState$restore=function(){if(a.scrollTop!==b||a.scrollLeft!==d)a.scrollTop=b,a.scrollLeft=d}}function a(a,b){var d=J[a]||D[a]||null;!d&&b&&(d=J[a]=new h(a));return d}function d(b,d){a(b,!0).CompoundEvent$subscribe(d)}function n(b,d){var c=a(b,!1);c&&c.unsubscribe(d)}function k(){return g.getDOMDocument().activeElement===A}function y(){k()&&
A.blur();A.setAttribute("disabled","true")}function u(){A.removeAttribute("disabled")}function z(a){for(var b=[];a;)(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight)&&b.push(new l(a)),a=a.parentNode;b.push(new e(w));return b}function x(){var a;k()||(a=z(A),u(),A.focus(),a.forEach(function(a){a.WindowScrollState$restore()}))}var w=runtime.getWindow(),v={beforecut:!0,beforepaste:!0,longpress:!0,drag:!0,dragstop:!0},t={mousedown:!0,mouseup:!0,focus:!0},D={},J={},A,L=g.getCanvas().getElement(),
S=this,K={};this.gui_EventManager$addFilter=function(b,d){a(b,!0).EventDelegate$filters.push(d)};this.removeFilter=function(b,d){var c=a(b,!0),e=c.EventDelegate$filters.indexOf(d);-1!==e&&c.EventDelegate$filters.splice(e,1)};this.gui_EventManager$subscribe=d;this.unsubscribe=n;this.gui_EventManager$hasFocus=k;this.gui_EventManager$focus=x;this.getEventTrap=function(){return A};this.setEditing=function(a){var b=k();b&&A.blur();a?A.removeAttribute("readOnly"):A.setAttribute("readOnly","true");b&&x()};
this.destroy=function(a){n("touchstart",q);Object.keys(K).forEach(function(a){b(parseInt(a,10))});K.length=0;Object.keys(D).forEach(function(a){D[a].destroy()});D={};n("mousedown",y);n("mouseup",u);n("contextmenu",u);Object.keys(J).forEach(function(a){J[a].destroy()});J={};A.parentNode.removeChild(A);a()};(function(){var a=g.getOdfCanvas().getSizer(),b=a.ownerDocument;runtime.BrowserRuntime$assert(!!w,"EventManager requires a window object to operate correctly");A=b.createElement("textarea");A.id=
"eventTrap";A.setAttribute("tabindex","-1");A.setAttribute("readOnly","true");A.setAttribute("rows","1");a.appendChild(A);d("mousedown",y);d("mouseup",u);d("contextmenu",u);D.longpress=new c("longpress",["touchstart","touchmove","touchend"],m);D.drag=new c("drag",["touchstart","touchmove","touchend"],r);D.dragstop=new c("dragstop",["drag","touchend"],p);d("touchstart",q)})()};
gui.IOSSafariSupport=function(g){function h(){c.innerHeight!==c.outerHeight&&(b.style.display="none",runtime.BrowserRuntime$requestAnimationFrame(function(){b.style.display="block"}))}var c=runtime.getWindow(),b=g.getEventTrap();this.destroy=function(c){g.unsubscribe("focus",h);b.removeAttribute("autocapitalize");b.style.WebkitTransform="";c()};g.gui_EventManager$subscribe("focus",h);b.setAttribute("autocapitalize","off");b.style.WebkitTransform="translateX(-10000px)"};
gui.HyperlinkController=function(g,h,c,b){function f(){var b=!0;!0===h.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(b=c.isLocalCursorWithinOwnAnnotation());b!==e&&(e=b,q.core_EventNotifier$emit("enabled/changed",e))}function m(c){c.gui_ShadowCursor$getMemberId()===b&&f()}var r=odf.OdfUtils,p=g.ops_Session$getOdtDocument(),q=new core.EventNotifier(["enabled/changed"]),e=!1;this.gui_HyperlinkController$isEnabled=function(){return e};this.core_EventNotifier$subscribe=function(b,a){q.core_EventNotifier$subscribe(b,
a)};this.unsubscribe=function(b,a){q.unsubscribe(b,a)};this.addHyperlink=function(c,a){if(e){var d=p.getCursorSelection(b),f;new ops.OpApplyHyperlink;var k=[];if(!d.length||a)a=a||c,f=new ops.OpInsertText,f.init({memberid:b,position:d.position,text:a}),d.length=a.length,k.push(f);f=new ops.OpApplyHyperlink;f.init({memberid:b,position:d.position,length:d.length,hyperlink:c});k.push(f);g.enqueue(k)}};this.removeHyperlinks=function(){if(e){var c=p.createPositionIterator(p.getRootNode()),a=p.ops_OdtDocument$getCursor(b).ops_OdtCursor$getSelectedRange(),
d=r.getHyperlinkElements(a),f=a.collapsed&&1===d.length,k=p.getDOMDocument().createRange(),h=[],m,q;d.length&&(d.forEach(function(a){k.selectNodeContents(a);m=p.convertDomToCursorRange({anchorNode:k.startContainer,anchorOffset:k.startOffset,focusNode:k.endContainer,focusOffset:k.endOffset});q=new ops.OpRemoveHyperlink;q.init({memberid:b,position:m.position,length:m.length});h.push(q)}),f||(f=d[0],-1===a.comparePoint(f,0)&&(k.setStart(f,0),k.setEnd(a.startContainer,a.startOffset),m=p.convertDomToCursorRange({anchorNode:k.startContainer,
anchorOffset:k.startOffset,focusNode:k.endContainer,focusOffset:k.endOffset}),0<m.length&&(q=new ops.OpApplyHyperlink,q.init({memberid:b,position:m.position,length:m.length,hyperlink:r.getHyperlinkTarget(f)}),h.push(q))),d=d[d.length-1],c.moveToEndOfNode(d),c=c.unfilteredDomOffset(),1===a.comparePoint(d,c)&&(k.setStart(a.endContainer,a.endOffset),k.setEnd(d,c),m=p.convertDomToCursorRange({anchorNode:k.startContainer,anchorOffset:k.startOffset,focusNode:k.endContainer,focusOffset:k.endOffset}),0<m.length&&
(q=new ops.OpApplyHyperlink,q.init({memberid:b,position:m.position,length:m.length,hyperlink:r.getHyperlinkTarget(d)}),h.push(q)))),g.enqueue(h),k.detach())}};this.destroy=function(b){p.unsubscribe(ops.Document.signalCursorMoved,m);h.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,f);b()};p.ops_Document_prototype$subscribe(ops.Document.signalCursorMoved,m);h.gui_SessionConstraints$subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,f);f()};
gui.HyperlinkController.function__new_gui_HyperlinkController__ops_Session__gui_SessionConstraints__gui_SessionContext__string___undefined$enabledChanged="enabled/changed";
gui.ImageController=function(g,h,c,b,f){function m(){var a=!0;!0===h.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(a=c.isLocalCursorWithinOwnAnnotation());a!==n&&(n=a,d.core_EventNotifier$emit("enabled/changed",n))}function r(a){a.gui_ShadowCursor$getMemberId()===b&&m()}var p={"image/gif":".gif","image/jpeg":".jpg","image/png":".png"},q=odf.Namespaces.textns,e=g.ops_Session$getOdtDocument(),l=odf.OdfUtils,a=e.ops_OdtDocument$getFormatting(),d=new core.EventNotifier(["enabled/changed"]),n=!1;
this.gui_ImageController$isEnabled=function(){return n};this.gui_ImageController$subscribe=function(a,b){d.core_EventNotifier$subscribe(a,b)};this.unsubscribe=function(a,b){d.unsubscribe(a,b)};this.insertImage=function(d,c,h,m){if(n){var r=new core.CSSUnits;runtime.BrowserRuntime$assert(0<h&&0<m,"Both width and height of the image should be greater than 0px.");m={width:h,height:m};if(h=l.getParagraphElement(e.ops_OdtDocument$getCursor(b).ops_OdtCursor$getNode()).getAttributeNS(q,"style-name")){h=
a.getContentSize(h,"paragraph");var w=1,v=1;m.width>h.width&&(w=h.width/m.width);m.height>h.height&&(v=h.height/m.height);h=Math.min(w,v);m={width:m.width*h,height:m.height*h}}h=r.convert(m.width,"px","cm")+"cm";r=r.convert(m.height,"px","cm")+"cm";v=e.getOdfCanvas().odfContainer().rootElement.styles;m=d.toLowerCase();var w=p.hasOwnProperty(m)?p[m]:null,t;m=[];runtime.BrowserRuntime$assert(null!==w,"Image type is not supported: "+d);w="Pictures/"+f.generateImageName()+w;t=new ops.OpSetBlob;t.init({memberid:b,
filename:w,mimetype:d,content:c});m.push(t);a.getStyleElement("Graphics","graphic",[v])||(d=new ops.OpAddStyle,d.init({memberid:b,styleName:"Graphics",styleFamily:"graphic",isAutomaticStyle:!1,setProperties:{"style:graphic-properties":{"text:anchor-type":"paragraph","svg:x":"0cm","svg:y":"0cm","style:wrap":"dynamic","style:number-wrapped-paragraphs":"no-limit","style:wrap-contour":"false","style:vertical-pos":"top","style:vertical-rel":"paragraph","style:horizontal-pos":"center","style:horizontal-rel":"paragraph"}}}),
m.push(d));d=f.generateStyleName();c=new ops.OpAddStyle;c.init({memberid:b,styleName:d,styleFamily:"graphic",isAutomaticStyle:!0,setProperties:{"style:parent-style-name":"Graphics","style:graphic-properties":{"style:vertical-pos":"top","style:vertical-rel":"baseline","style:horizontal-pos":"center","style:horizontal-rel":"paragraph","fo:background-color":"transparent","style:background-transparency":"100%","style:shadow":"none","style:mirror":"none","fo:clip":"rect(0cm, 0cm, 0cm, 0cm)","draw:luminance":"0%",
"draw:contrast":"0%","draw:red":"0%","draw:green":"0%","draw:blue":"0%","draw:gamma":"100%","draw:color-inversion":"false","draw:image-opacity":"100%","draw:color-mode":"standard"}}});m.push(c);t=new ops.OpInsertImage;t.init({memberid:b,position:e.getCursorPosition(b),filename:w,frameWidth:h,frameHeight:r,frameStyleName:d,frameName:f.generateFrameName()});m.push(t);g.enqueue(m)}};this.destroy=function(a){e.unsubscribe(ops.Document.signalCursorMoved,r);h.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,
m);a()};e.ops_Document_prototype$subscribe(ops.Document.signalCursorMoved,r);h.gui_SessionConstraints$subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,m);m()};gui.ImageController.function__new_gui_ImageController__ops_Session__gui_SessionConstraints__gui_SessionContext__string__odf_ObjectNameGenerator___undefined$enabledChanged="enabled/changed";
gui.ImageSelector=function(g){function h(){var c=g.getSizer(),h=f.createElement("div");h.id="imageSelector";h.style.borderWidth="1px";c.appendChild(h);b.forEach(function(b){var c=f.createElement("div");c.className=b;h.appendChild(c)});return h}var c=odf.Namespaces.svgns,b="topLeft topRight bottomRight bottomLeft topMiddle rightMiddle bottomMiddle leftMiddle".split(" "),f=g.getElement().ownerDocument,m=!1;this.gui_ImageSelector$select=function(b){var p,q,e=f.getElementById("imageSelector");e||(e=h());
m=!0;p=e.parentNode;q=b.getBoundingClientRect();var l=p.getBoundingClientRect(),a=g.gui_AnnotatableCanvas_prototype$getZoomLevel();p=(q.left-l.left)/a-1;q=(q.top-l.top)/a-1;e.style.display="block";e.style.left=p+"px";e.style.top=q+"px";e.style.width=b.getAttributeNS(c,"width");e.style.height=b.getAttributeNS(c,"height")};this.clearSelection=function(){var b;m&&(b=f.getElementById("imageSelector"))&&(b.style.display="none");m=!1};this.isSelectorElement=function(b){var c=f.getElementById("imageSelector");
return c?b===c||b.parentNode===c:!1}};
(function(){function g(g){function c(b){r=b.which&&String.fromCharCode(b.which)===m;m=void 0;return!1===r}function b(){r=!1}function f(b){m=b.data;r=!1}var m,r=!1;this.destroy=function(m){g.unsubscribe("textInput",b);g.unsubscribe("compositionend",f);g.removeFilter("keypress",c);m()};g.gui_EventManager$subscribe("textInput",b);g.gui_EventManager$subscribe("compositionend",f);g.gui_EventManager$addFilter("keypress",c)}gui.InputMethodEditor=function(h,c){function b(b){a&&(b?a.ops_OdtCursor$getNode().setAttributeNS("urn:webodf:names:cursor",
"composing","true"):(a.ops_OdtCursor$getNode().removeAttributeNS("urn:webodf:names:cursor","composing"),k.textContent=""))}function f(){u&&(u=!1,b(!1),x.core_EventNotifier$emit(gui.InputMethodEditor.signalCompositionEnd,{data:z}),z="")}function m(){J||(J=!0,f(),a&&a.ops_OdtCursor$getSelectedRange().collapsed?d.value="":d.value=v.odf_TextSerializer$writeToString(a.ops_OdtCursor$getSelectedRange().cloneContents()),d.setSelectionRange(0,d.value.length),J=!1)}function r(){c.gui_EventManager$hasFocus()&&
y.trigger()}function p(){w=void 0;y.cancel();b(!0);u||x.core_EventNotifier$emit(gui.InputMethodEditor.signalCompositionStart,{data:""})}function q(a){a=w=a.data;u=!0;z+=a;y.trigger()}function e(a){a.data!==w&&(a=a.data,u=!0,z+=a,y.trigger());w=void 0}function l(){k.textContent=d.value}var a=null,d=c.getEventTrap(),n=d.ownerDocument,k,y,u=!1,z="",x=new core.EventNotifier([gui.InputMethodEditor.signalCompositionStart,gui.InputMethodEditor.signalCompositionEnd]),w,v,t=[],D,J=!1;this.gui_InputMethodEditor$subscribe=
x.core_EventNotifier$subscribe;this.unsubscribe=x.unsubscribe;this.gui_InputMethodEditor$registerCursor=function(b){b.gui_ShadowCursor$getMemberId()===h&&(a=b,a.ops_OdtCursor$getNode().appendChild(k),b.ops_OdtCursor$subscribe("cursorUpdated",r),c.gui_EventManager$subscribe("input",l),c.gui_EventManager$subscribe("compositionupdate",l))};this.gui_InputMethodEditor$removeCursor=function(b){a&&b===h&&(a.ops_OdtCursor$getNode().removeChild(k),a.unsubscribe("cursorUpdated",r),c.unsubscribe("input",l),
c.unsubscribe("compositionupdate",l),a=null)};this.destroy=function(a){c.unsubscribe("compositionstart",p);c.unsubscribe("compositionend",q);c.unsubscribe("textInput",e);c.unsubscribe("keypress",f);c.unsubscribe("focus",m);core.Async.destroyAll(D,a)};(function(){v=new odf.TextSerializer;v.odf_TextSerializer$filter=new odf.OdfNodeFilter;c.gui_EventManager$subscribe("compositionstart",p);c.gui_EventManager$subscribe("compositionend",q);c.gui_EventManager$subscribe("textInput",e);c.gui_EventManager$subscribe("keypress",
f);c.gui_EventManager$subscribe("focus",m);t.push(new g(c));D=t.map(function(a){return a.destroy});k=n.createElement("span");k.setAttribute("id","composer");y=core.Task.createTimeoutTask(m,1);D.push(y.destroy)})()};gui.InputMethodEditor.signalCompositionStart="input/compositionstart";gui.InputMethodEditor.signalCompositionEnd="input/compositionend"})();
gui.MetadataController=function(g,h){function c(b){m.core_EventNotifier$emit("metadata/changed",b)}function b(b){var c=-1===r.indexOf(b);c||runtime.log("Setting "+b+" is restricted.");return c}var f=g.ops_Session$getOdtDocument(),m=new core.EventNotifier(["metadata/changed"]),r=["dc:creator","dc:date","meta:editing-cycles","meta:editing-duration","meta:document-statistic"];this.gui_MetadataController$setMetadata=function(c,f){var e={},l="",a;c&&Object.keys(c).filter(b).forEach(function(a){e[a]=c[a]});
f&&(l=f.filter(b).join(","));if(0<l.length||0<Object.keys(e).length)a=new ops.OpUpdateMetadata,a.init({memberid:h,setProperties:e,removedProperties:0<l.length?{attributes:l}:null}),g.enqueue([a])};this.gui_MetadataController$getMetadata=function(b){var c;runtime.BrowserRuntime$assert("string"===typeof b,"Property must be a string");c=b.split(":");runtime.BrowserRuntime$assert(2===c.length,"Property must be a namespace-prefixed string");b=odf.Namespaces.lookupNamespaceURI(c[0]);runtime.BrowserRuntime$assert(!!b,
"Prefix must be for an ODF namespace.");return f.getOdfCanvas().odfContainer().odf_OdfContainer$getMetadata(b,c[1])};this.gui_MetadataController$subscribe=function(b,c){m.core_EventNotifier$subscribe(b,c)};this.unsubscribe=function(b,c){m.unsubscribe(b,c)};this.destroy=function(b){f.unsubscribe("metadata/updated",c);b()};f.ops_Document_prototype$subscribe("metadata/updated",c)};gui.MetadataController.signalMetadataChanged="metadata/changed";
gui.PasteController=function(g,h,c,b){function f(){p=!0===h.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)?c.isLocalCursorWithinOwnAnnotation():!0}function m(a){a.gui_ShadowCursor$getMemberId()===b&&f()}var r=g.ops_Session$getOdtDocument(),p=!1,q=odf.Namespaces.textns,e=core.StepDirection.NEXT,l=odf.OdfUtils;this.gui_PasteController$isEnabled=function(){return p};this.paste=function(a){if(p){var d=r.getCursorPosition(b),c=r.ops_OdtDocument$getCursor(b).ops_OdtCursor$getNode(),c=l.getParagraphElement(c),
f=c.getAttributeNS(q,"style-name")||"",h=d,m=[],z=r.convertDomPointToCursorStep(c,0,e);a.replace(/\r/g,"").split("\n").forEach(function(a){var d=new ops.OpInsertText,c=new ops.OpSplitParagraph;d.init({memberid:b,position:h,text:a,moveCursor:!0});m.push(d);h+=a.length;c.init({memberid:b,position:h,paragraphStyleName:f,sourceParagraphPosition:z,moveCursor:!0});m.push(c);z=h+=1});m.pop();g.enqueue(m)}};this.destroy=function(a){r.unsubscribe(ops.Document.signalCursorMoved,m);h.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,
f);a()};r.ops_Document_prototype$subscribe(ops.Document.signalCursorMoved,m);h.gui_SessionConstraints$subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,f);f()};
gui.ClosestXOffsetScanner=function(g){function h(b){return null!==b&&void 0!==f?Math.abs(b-g)>f:!1}function c(b){null!==b&&!1===h(b)&&(f=Math.abs(b-g))}var b=this,f,m=gui.StepInfo.VisualDirection.LEFT_TO_RIGHT;this.gui_ClosestXOffsetScanner$token=void 0;this.gui_ClosestXOffsetScanner$process=function(f,g,q){var e,l;f.visualDirection===m?(e=g&&g.right,l=q&&q.left):(e=g&&g.left,l=q&&q.right);if(h(e)||h(l))return!0;if(g||q)c(e),c(l),b.gui_ClosestXOffsetScanner$token=f.gui_StepInfo_prototype$token;return!1}};
gui.LineBoundaryScanner=function(){var g=this,h=null;this.gui_ClosestXOffsetScanner$token=void 0;this.gui_ClosestXOffsetScanner$process=function(c,b,f){var m;if(m=f)if(h){m=Math.min(h.bottom-h.top,f.bottom-f.top);var r=Math.max(h.top,f.top),p=Math.min(h.bottom,f.bottom);m=.4>=(0<m?(p-r)/m:0)}else m=!1;!b||f&&!m||(g.gui_ClosestXOffsetScanner$token=c.gui_StepInfo_prototype$token);if(m)return!0;h=(c=h)&&b?{left:Math.min(c.left,b.left),right:Math.max(c.right,b.right),top:Math.min(c.top,b.top),bottom:Math.min(c.bottom,
b.bottom)}:c||b;return!1}};gui.ParagraphBoundaryScanner=function(){var g=this,h=!1,c,b=odf.OdfUtils;this.gui_ParagraphBoundaryScanner$token=void 0;this.gui_ParagraphBoundaryScanner$process=function(f){var m=b.getParagraphElement(f.container());h||(c=m,h=!0);if(c!==m)return!0;g.gui_ParagraphBoundaryScanner$token=f.gui_StepInfo_prototype$token;return!1}};
odf.WordBoundaryFilter=function(g,h){function c(a,b,d){for(var c=null,e=g.getRootNode(),f;a!==e&&a&&!c;)f=0>b?a.previousSibling:a.nextSibling,d(f)===NodeFilter.FILTER_ACCEPT&&(c=f),a=a.parentNode;return c}function b(a,b){var d;return a?r.isCharacterElement(a)?n.SPACE_CHAR:a.nodeType===f||r.isTextSpan(a)||r.isHyperlink(a)?(d=a.textContent.charAt(b()),q.test(d)?n.SPACE_CHAR:p.test(d)?n.PUNCTUATION_CHAR:n.WORD_CHAR):n.OTHER:n.NO_NEIGHBOUR}var f=Node.TEXT_NODE,m=Node.ELEMENT_NODE,r=odf.OdfUtils,p=/[!-#%-*,-\/:-;?-@\[-\]_{}\u00a1\u00ab\u00b7\u00bb\u00bf;\u00b7\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0700-\u070d\u07f7-\u07f9\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u169b-\u169c\u16eb-\u16ed\u1735-\u1736\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u1944-\u1945\u19de-\u19df\u1a1e-\u1a1f\u1b5a-\u1b60\u1c3b-\u1c3f\u1c7e-\u1c7f\u2000-\u206e\u207d-\u207e\u208d-\u208e\u3008-\u3009\u2768-\u2775\u27c5-\u27c6\u27e6-\u27ef\u2983-\u2998\u29d8-\u29db\u29fc-\u29fd\u2cf9-\u2cfc\u2cfe-\u2cff\u2e00-\u2e7e\u3000-\u303f\u30a0\u30fb\ua60d-\ua60f\ua673\ua67e\ua874-\ua877\ua8ce-\ua8cf\ua92e-\ua92f\ua95f\uaa5c-\uaa5f\ufd3e-\ufd3f\ufe10-\ufe19\ufe30-\ufe52\ufe54-\ufe61\ufe63\ufe68\ufe6a-\ufe6b\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|\ud800[\udd00-\udd01\udf9f\udfd0]|\ud802[\udd1f\udd3f\ude50-\ude58]|\ud809[\udc00-\udc7e]/,
q=/\s/,e=core.PositionFilter.FilterResult.FILTER_ACCEPT,l=core.PositionFilter.FilterResult.FILTER_REJECT,a=odf.WordBoundaryFilter.IncludeWhitespace.TRAILING,d=odf.WordBoundaryFilter.IncludeWhitespace.LEADING,n={NO_NEIGHBOUR:0,SPACE_CHAR:1,PUNCTUATION_CHAR:2,WORD_CHAR:3,OTHER:4};this.acceptPosition=function(f){var g=f.container(),p=f.core_PositionIterator$leftNode(),r=f.rightNode(),q=f.unfilteredDomOffset,w=function(){return f.unfilteredDomOffset()-1};g.nodeType===m&&(r||(r=c(g,1,f.getNodeFilter())),
p||(p=c(g,-1,f.getNodeFilter())));g!==r&&(q=function(){return 0});g!==p&&p&&(w=function(){return p.textContent.length-1});g=b(p,w);r=b(r,q);return g===n.WORD_CHAR&&r===n.WORD_CHAR||g===n.PUNCTUATION_CHAR&&r===n.PUNCTUATION_CHAR||h===a&&g!==n.NO_NEIGHBOUR&&r===n.SPACE_CHAR||h===d&&g===n.SPACE_CHAR&&r!==n.NO_NEIGHBOUR?l:e}};odf.WordBoundaryFilter.IncludeWhitespace={None:0,TRAILING:1,LEADING:2};
gui.SelectionController=function(g,h){function c(a){var b=a.spec();if(a.isEdit||b.memberid===h)J=void 0,A.cancel()}function b(){var a=u.ops_OdtDocument$getCursor(h).ops_OdtCursor$getNode();return u.createStepIterator(a,0,[w,t],u.getRootElement(a))}function f(a,b,d){d=new odf.WordBoundaryFilter(u,d);var c=u.getRootElement(a)||u.getRootNode(),e=u.createRootFilter(c);return u.createStepIterator(a,b,[w,e,d],c)}function m(a,b){return b?{anchorNode:a.startContainer,anchorOffset:a.startOffset,focusNode:a.endContainer,
focusOffset:a.endOffset}:{anchorNode:a.endContainer,anchorOffset:a.endOffset,focusNode:a.startContainer,focusOffset:a.startOffset}}function r(a,b,d){var c=new ops.OpMoveCursor;c.init({memberid:h,position:a,length:b||0,selectionType:d});return c}function p(a,b,d){var c;c=u.ops_OdtDocument$getCursor(h);c=m(c.ops_OdtCursor$getSelectedRange(),c.hasForwardSelection());c.focusNode=a;c.focusOffset=b;d||(c.anchorNode=c.focusNode,c.anchorOffset=c.focusOffset);a=u.convertDomToCursorRange(c);g.enqueue([r(a.position,
a.length)])}function q(a){var b;b=f(a.startContainer,a.startOffset,L);b.roundToPreviousStep()&&a.setStart(b.container(),b.offset());b=f(a.endContainer,a.endOffset,S);b.roundToNextStep()&&a.setEnd(b.container(),b.offset())}function e(a){var b=x.getParagraphElements(a),d=b[0],b=b[b.length-1];d&&a.setStart(d,0);b&&(x.isParagraph(a.endContainer)&&!a.endOffset?a.setEndBefore(b):a.setEnd(b,b.childNodes.length))}function l(a,b,d,c){var e,f;c?(e=d.startContainer,f=d.startOffset):(e=d.endContainer,f=d.endOffset);
z.core_DomUtilsImpl$containsNode(a,e)||(f=0>z.comparePoints(a,0,e,f)?0:a.childNodes.length,e=a);a=u.createStepIterator(e,f,b,x.getParagraphElement(e)||a);a.roundToClosestStep()||runtime.BrowserRuntime$assert(!1,"No step found in requested range");c?d.setStart(a.container(),a.offset()):d.setEnd(a.container(),a.offset())}function a(a,d){var c=b();c.advanceStep(a)&&p(c.container(),c.offset(),d)}function d(a,d){var c,e=J,f=[new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner];void 0===e&&D&&
(e=D());isNaN(e)||(c=b(),v.moveToFilteredStep(c,a,f)&&c.advanceStep(a)&&(f=[new gui.ClosestXOffsetScanner(e),new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner],v.moveToFilteredStep(c,a,f)&&(p(c.container(),c.offset(),d),J=e,A.restart())))}function n(a,d){var c=b(),e=[new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner];v.moveToFilteredStep(c,a,e)&&p(c.container(),c.offset(),d)}function k(a,b){var d=u.ops_OdtDocument$getCursor(h),d=m(d.ops_OdtCursor$getSelectedRange(),d.hasForwardSelection()),
d=f(d.focusNode,d.focusOffset,L);d.advanceStep(a)&&p(d.container(),d.offset(),b)}function y(a,b,d){var c=u.ops_OdtDocument$getCursor(h),c=m(c.ops_OdtCursor$getSelectedRange(),c.hasForwardSelection()),e=u.getRootElement(c.focusNode);runtime.BrowserRuntime$assert(!!e,"SelectionController: Cursor outside root");c=u.createStepIterator(c.focusNode,c.focusOffset,[w,t],e);c.roundToClosestStep();c.advanceStep(a)&&(d=d(c.container()))&&(a===K?(c.setPosition(d,0),a=c.roundToNextStep()):(c.setPosition(d,d.childNodes.length),
a=c.roundToPreviousStep()),a&&p(c.container(),c.offset(),b))}var u=g.ops_Session$getOdtDocument(),z=core.DomUtils,x=odf.OdfUtils,w=u.getPositionFilter(),v=new gui.GuiStepUtils,t=u.createRootFilter(h),D=null,J,A,L=odf.WordBoundaryFilter.IncludeWhitespace.TRAILING,S=odf.WordBoundaryFilter.IncludeWhitespace.LEADING,K=core.StepDirection.PREVIOUS,R=core.StepDirection.NEXT;this.selectionToRange=function(a){var b=0<=z.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset),d=a.focusNode.ownerDocument.createRange();
b?(d.setStart(a.anchorNode,a.anchorOffset),d.setEnd(a.focusNode,a.focusOffset)):(d.setStart(a.focusNode,a.focusOffset),d.setEnd(a.anchorNode,a.anchorOffset));return{range:d,hasForwardSelection:b}};this.rangeToSelection=m;this.selectImage=function(a){var b=u.getRootElement(a),d=u.createRootFilter(b),b=u.createStepIterator(a,0,[d,u.getPositionFilter()],b),c;b.roundToPreviousStep()||runtime.BrowserRuntime$assert(!1,"No walkable position before frame");d=b.container();c=b.offset();b.setPosition(a,a.childNodes.length);
b.roundToNextStep()||runtime.BrowserRuntime$assert(!1,"No walkable position after frame");a=u.convertDomToCursorRange({anchorNode:d,anchorOffset:c,focusNode:b.container(),focusOffset:b.offset()});a=r(a.position,a.length,"Region");g.enqueue([a])};this.expandToWordBoundaries=q;this.expandToParagraphBoundaries=e;this.selectRange=function(a,b,d){var c=u.getOdfCanvas().getElement(),f,k=[w];f=z.core_DomUtilsImpl$containsNode(c,a.startContainer);c=z.core_DomUtilsImpl$containsNode(c,a.endContainer);if(f||
c)if(f&&c&&(2===d?q(a):3<=d&&e(a)),(d=b?u.getRootElement(a.startContainer):u.getRootElement(a.endContainer))||(d=u.getRootNode()),k.push(u.createRootFilter(d)),l(d,k,a,!0),l(d,k,a,!1),a=m(a,b),b=u.convertDomToCursorRange(a),a=u.getCursorSelection(h),b.position!==a.position||b.length!==a.length)a=r(b.position,b.length,"Range"),g.enqueue([a])};this.moveCursorToLeft=function(){a(K,!1);return!0};this.moveCursorToRight=function(){a(R,!1);return!0};this.extendSelectionToLeft=function(){a(K,!0);return!0};
this.extendSelectionToRight=function(){a(R,!0);return!0};this.setCaretXPositionLocator=function(a){D=a};this.moveCursorUp=function(){d(K,!1);return!0};this.moveCursorDown=function(){d(R,!1);return!0};this.extendSelectionUp=function(){d(K,!0);return!0};this.extendSelectionDown=function(){d(R,!0);return!0};this.moveCursorBeforeWord=function(){k(K,!1);return!0};this.moveCursorPastWord=function(){k(R,!1);return!0};this.extendSelectionBeforeWord=function(){k(K,!0);return!0};this.extendSelectionPastWord=
function(){k(R,!0);return!0};this.moveCursorToLineStart=function(){n(K,!1);return!0};this.moveCursorToLineEnd=function(){n(R,!1);return!0};this.extendSelectionToLineStart=function(){n(K,!0);return!0};this.extendSelectionToLineEnd=function(){n(R,!0);return!0};this.extendSelectionToParagraphStart=function(){y(K,!0,x.getParagraphElement);return!0};this.extendSelectionToParagraphEnd=function(){y(R,!0,x.getParagraphElement);return!0};this.moveCursorToParagraphStart=function(){y(K,!1,x.getParagraphElement);
return!0};this.moveCursorToParagraphEnd=function(){y(R,!1,x.getParagraphElement);return!0};this.moveCursorToDocumentStart=function(){y(K,!1,u.getRootElement);return!0};this.moveCursorToDocumentEnd=function(){y(R,!1,u.getRootElement);return!0};this.extendSelectionToDocumentStart=function(){y(K,!0,u.getRootElement);return!0};this.extendSelectionToDocumentEnd=function(){y(R,!0,u.getRootElement);return!0};this.extendSelectionToEntireDocument=function(){var a=u.ops_OdtDocument$getCursor(h),a=u.getRootElement(a.ops_OdtCursor$getNode()),
b,d,c;runtime.BrowserRuntime$assert(!!a,"SelectionController: Cursor outside root");c=u.createStepIterator(a,0,[w,t],a);c.roundToClosestStep();b=c.container();d=c.offset();c.setPosition(a,a.childNodes.length);c.roundToClosestStep();a=u.convertDomToCursorRange({anchorNode:b,anchorOffset:d,focusNode:c.container(),focusOffset:c.offset()});g.enqueue([r(a.position,a.length)]);return!0};this.destroy=function(a){u.unsubscribe("operation/start",c);core.Async.destroyAll([A.destroy],a)};(function(){A=core.Task.createTimeoutTask(function(){J=
void 0},2E3);u.ops_Document_prototype$subscribe("operation/start",c)})()};
gui.TextController=function(g,h,c,b,f,m){function r(){y=!0===h.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)?c.isLocalCursorWithinOwnAnnotation():!0}function p(a){a.gui_ShadowCursor$getMemberId()===b&&r()}function q(a,b,c){var e=[d.getPositionFilter()];c&&e.push(d.createRootFilter(a.startContainer));c=d.createStepIterator(a.startContainer,a.startOffset,e,b);c.roundToClosestStep()||runtime.BrowserRuntime$assert(!1,"No walkable step found in paragraph element at range start");b=d.convertDomPointToCursorStep(c.container(),
c.offset());a.collapsed?a=b:(c.setPosition(a.endContainer,a.endOffset),c.roundToClosestStep()||runtime.BrowserRuntime$assert(!1,"No walkable step found in paragraph element at range end"),a=d.convertDomPointToCursorStep(c.container(),c.offset()));return{position:b,length:a-b}}function e(a){var d,c,e,f=n.getParagraphElements(a),g=a.cloneRange(),h=[];d=f[0];1<f.length&&(n.hasNoODFContent(d)&&(d=f[f.length-1]),c=d.getAttributeNS(odf.Namespaces.textns,"style-name")||"");f.forEach(function(d,f){var n,
l;g.setStart(d,0);g.collapse(!0);n=q(g,d,!1).position;0<f&&(l=new ops.OpMergeParagraph,l.init({memberid:b,paragraphStyleName:c,destinationStartPosition:e,sourceStartPosition:n,moveCursor:1===f}),h.unshift(l));e=n;g.selectNodeContents(d);if(n=k.rangeIntersection(g,a))n=q(n,d,!0),0<n.length&&(l=new ops.OpRemoveText,l.init({memberid:b,position:n.position,length:n.length}),h.unshift(l))});return h}function l(a){0>a.length&&(a.position+=a.length,a.length=-a.length);return a}function a(a){if(!y)return!1;
var c,f=d.ops_OdtDocument$getCursor(b).ops_OdtCursor$getSelectedRange().cloneRange(),k=l(d.getCursorSelection(b)),h;if(!k.length){k=void 0;c=d.ops_OdtDocument$getCursor(b).ops_OdtCursor$getNode();h=d.getRootElement(c);var n=[d.getPositionFilter(),d.createRootFilter(h)];h=d.createStepIterator(c,0,n,h);h.roundToClosestStep()&&(a?h.nextStep():h.previousStep())&&(k=l(d.convertDomToCursorRange({anchorNode:c,anchorOffset:0,focusNode:h.container(),focusOffset:h.offset()})),a?(f.setStart(c,0),f.setEnd(h.container(),
h.offset())):(f.setStart(h.container(),h.offset()),f.setEnd(c,0)))}k&&g.enqueue(e(f));return!!k}var d=g.ops_Session$getOdtDocument(),n=odf.OdfUtils,k=core.DomUtils,y=!1,u=odf.Namespaces.textns,z=core.StepDirection.NEXT;this.gui_TextController$isEnabled=function(){return y};this.enqueueParagraphSplittingOps=function(){if(!y)return!1;var a=d.ops_OdtDocument$getCursor(b),c=a.ops_OdtCursor$getSelectedRange(),f=l(d.getCursorSelection(b)),k=[],a=n.getParagraphElement(a.ops_OdtCursor$getNode()),h=a.getAttributeNS(u,
"style-name")||"";0<f.length&&(k=k.concat(e(c)));c=new ops.OpSplitParagraph;c.init({memberid:b,position:f.position,paragraphStyleName:h,sourceParagraphPosition:d.convertDomPointToCursorStep(a,0,z),moveCursor:!0});k.push(c);m&&(f=m(f.position+1),k=k.concat(f));g.enqueue(k);return!0};this.removeTextByBackspaceKey=function(){return a(!1)};this.removeTextByDeleteKey=function(){return a(!0)};this.removeCurrentSelection=function(){if(!y)return!1;var a=d.ops_OdtDocument$getCursor(b).ops_OdtCursor$getSelectedRange();
g.enqueue(e(a));return!0};this.insertText=function(a){if(y){var c=d.ops_OdtDocument$getCursor(b).ops_OdtCursor$getSelectedRange(),k=l(d.getCursorSelection(b)),h=[],n=!1;0<k.length&&(h=h.concat(e(c)),n=!0);c=new ops.OpInsertText;c.init({memberid:b,position:k.position,text:a,moveCursor:!0});h.push(c);f&&(a=f(k.position,a.length,n))&&h.push(a);g.enqueue(h)}};this.destroy=function(a){d.unsubscribe(ops.Document.signalCursorMoved,p);h.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,r);a()};d.ops_Document_prototype$subscribe(ops.Document.signalCursorMoved,
p);h.gui_SessionConstraints$subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,r);r()};gui.UndoManager=function(){};gui.UndoManager.prototype.gui_TrivialUndoManager$subscribe=function(g,h){};gui.UndoManager.prototype.unsubscribe=function(g,h){};gui.UndoManager.prototype.setDocument=function(g){};gui.UndoManager.prototype.setInitialState=function(){};gui.UndoManager.prototype.initialize=function(){};gui.UndoManager.prototype.purgeInitialState=function(){};
gui.UndoManager.prototype.gui_TrivialUndoManager$setPlaybackFunction=function(g){};gui.UndoManager.prototype.hasUndoStates=function(){};gui.UndoManager.prototype.hasRedoStates=function(){};gui.UndoManager.prototype.moveForward=function(g){};gui.UndoManager.prototype.moveBackward=function(g){};gui.UndoManager.prototype.onOperationExecuted=function(g){};gui.UndoManager.prototype.isDocumentModified=function(){};gui.UndoManager.prototype.setDocumentModified=function(g){};
gui.UndoManager.function__this_gui_UndoManager____$signalUndoStackChanged="undoStackChanged";gui.UndoManager.signalUndoStateCreated="undoStateCreated";gui.UndoManager.signalUndoStateModified="undoStateModified";gui.UndoManager.signalDocumentModifiedChanged="documentModifiedChanged";gui.SessionControllerOptions=function(){this.annotationsEnabled=this.directParagraphStylingEnabled=this.directTextStylingEnabled=!1};
(function(){var g=core.PositionFilter.FilterResult.FILTER_ACCEPT;gui.SessionController=function(h,c,b,f){function m(a,b){var d=M.getDOMDocument(),c=null;d.caretRangeFromPoint?(d=d.caretRangeFromPoint(a,b),c={container:d.startContainer,offset:d.startOffset}):d.caretPositionFromPoint&&(d=d.caretPositionFromPoint(a,b))&&d.offsetNode&&(c={container:d.offsetNode,offset:d.offset});return c}function r(a){var b=M.ops_OdtDocument$getCursor(c).ops_OdtCursor$getSelectedRange();b.collapsed?a.preventDefault():
fa.setDataFromRange(a,b)?aa.removeCurrentSelection():runtime.log("Cut operation failed")}function p(){return!1!==M.ops_OdtDocument$getCursor(c).ops_OdtCursor$getSelectedRange().collapsed}function q(a){var b=M.ops_OdtDocument$getCursor(c).ops_OdtCursor$getSelectedRange();b.collapsed?a.preventDefault():fa.setDataFromRange(a,b)||runtime.log("Copy operation failed")}function e(a){var b;U.clipboardData&&U.clipboardData.getData?b=U.clipboardData.getData("Text"):a.clipboardData&&a.clipboardData.getData&&
(b=a.clipboardData.getData("text/plain"));b&&(aa.removeCurrentSelection(),oa.paste(b));a.preventDefault?a.preventDefault():a.returnValue=!1}function l(){return!1}function a(a){if(H)H.onOperationExecuted(a)}function d(a){M.ops_OdtDocument$emit("undo/changed",a)}function n(){var a;return H?(a=F.gui_EventManager$hasFocus(),H.moveBackward(1),a&&F.gui_EventManager$focus(),!0):!1}function k(){var a;return H?(a=F.gui_EventManager$hasFocus(),H.moveForward(1),a&&F.gui_EventManager$focus(),!0):!1}function y(a){var d=
M.ops_OdtDocument$getCursor(c).ops_OdtCursor$getSelectedRange(),e=(a.target||a.srcElement||null).getAttribute("end");d&&e&&(a=m(a.clientX,a.clientY))&&(ja.setUnfilteredPosition(a.container,a.offset),E.acceptPosition(ja)===g&&(d=d.cloneRange(),"left"===e?d.setStart(ja.container(),ja.unfilteredDomOffset()):d.setEnd(ja.container(),ja.unfilteredDomOffset()),b.ops_OdtCursor$setSelectedRange(d,"right"===e),M.ops_OdtDocument$emit(ops.Document.signalCursorMoved,b)))}function u(){Q.selectRange(b.ops_OdtCursor$getSelectedRange(),
b.hasForwardSelection(),1)}function z(){var a=U.getSelection(),d=0<a.rangeCount&&Q.selectionToRange(a);ba&&d&&(ea=!0,la.clearSelection(),ja.setUnfilteredPosition(a.focusNode,a.focusOffset),E.acceptPosition(ja)===g&&(2===da?Q.expandToWordBoundaries(d.range):3<=da&&Q.expandToParagraphBoundaries(d.range),b.ops_OdtCursor$setSelectedRange(d.range,d.hasForwardSelection),M.ops_OdtDocument$emit(ops.Document.signalCursorMoved,b)))}function x(a){var b=a.target||a.srcElement||null,d=M.ops_OdtDocument$getCursor(c);
if(ba=!!b&&N.core_DomUtilsImpl$containsNode(M.getOdfCanvas().getElement(),b))ea=!1,b=M.getRootElement(b)||M.getRootNode(),E=M.createRootFilter(b),da=a.button?0:a.detail,d&&a.shiftKey?U.getSelection().collapse(d.ops_OdtCursor$getAnchorNode(),0):(a=U.getSelection(),b=d.ops_OdtCursor$getSelectedRange(),a.extend?d.hasForwardSelection()?(a.collapse(b.startContainer,b.startOffset),a.extend(b.endContainer,b.endOffset)):(a.collapse(b.endContainer,b.endOffset),a.extend(b.startContainer,b.startOffset)):(a.removeAllRanges(),
a.addRange(b.cloneRange()))),1<da&&z()}function w(a){var b=M.getRootElement(a),d=M.createRootFilter(b),b=M.createStepIterator(a,0,[d,M.getPositionFilter()],b);b.setPosition(a,a.childNodes.length);return b.roundToNextStep()?{container:b.container(),offset:b.offset()}:null}function v(a){var b;b=(b=U.getSelection())?{anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}:null;var d=U.getSelection().isCollapsed,c,e;b.anchorNode||b.focusNode||!(c=m(a.clientX,
a.clientY))||(b.anchorNode=c.container,b.anchorOffset=c.offset,b.focusNode=b.anchorNode,b.focusOffset=b.anchorOffset);if(Y.isImage(b.focusNode)&&!b.focusOffset&&Y.isCharacterFrame(b.focusNode.parentNode)){if(e=b.focusNode.parentNode,c=e.getBoundingClientRect(),a.clientX>c.left&&(c=w(e)))b.focusNode=c.container,b.focusOffset=c.offset,d&&(b.anchorNode=b.focusNode,b.anchorOffset=b.focusOffset)}else Y.isImage(b.focusNode.firstChild)&&1===b.focusOffset&&Y.isCharacterFrame(b.focusNode)&&(c=w(b.focusNode))&&
(b.anchorNode=b.focusNode=c.container,b.anchorOffset=b.focusOffset=c.offset);b.anchorNode&&b.focusNode&&(b=Q.selectionToRange(b),Q.selectRange(b.range,b.hasForwardSelection,a.button?0:a.detail));F.gui_EventManager$focus()}function t(a){var b;if(b=m(a.clientX,a.clientY))a=b.container,b=b.offset,a={anchorNode:a,anchorOffset:b,focusNode:a,focusOffset:b},a=Q.selectionToRange(a),Q.selectRange(a.range,a.hasForwardSelection,2),F.gui_EventManager$focus()}function D(a){var d=a.target||a.srcElement||null,c,
e,f;ka.processRequests();ba&&(Y.isImage(d)&&Y.isCharacterFrame(d.parentNode)&&U.getSelection().isCollapsed?(Q.selectImage(d.parentNode),F.gui_EventManager$focus()):la.isSelectorElement(d)?F.gui_EventManager$focus():ea?(d=b.ops_OdtCursor$getSelectedRange(),e=d.collapsed,Y.isImage(d.endContainer)&&!d.endOffset&&Y.isCharacterFrame(d.endContainer.parentNode)&&(f=d.endContainer.parentNode,f=w(f))&&(d.setEnd(f.container,f.offset),e&&d.collapse(!1)),Q.selectRange(d,b.hasForwardSelection(),a.button?0:a.detail),
F.gui_EventManager$focus()):ta?v(a):(c=N.cloneEvent(a),Z=runtime.BrowserRuntime$setTimeout(function(){v(c)},0)),da=0,ea=ba=!1)}function J(a){var b=M.ops_OdtDocument$getCursor(c).ops_OdtCursor$getSelectedRange();b.collapsed||W.exportRangeToDataTransfer(a.dataTransfer,b)}function A(){ba&&F.gui_EventManager$focus();da=0;ea=ba=!1}function L(a){D(a)}function S(a){var b=a.target||a.srcElement||null;"annotationRemoveButton"===b.className?(runtime.BrowserRuntime$assert(!1,"Remove buttons are displayed on annotations while annotation editing is disabled in the controller."),
a=b.parentNode.getElementsByTagNameNS(odf.Namespaces.officens,"annotation").item(0),ia.removeAnnotation(a),F.gui_EventManager$focus()):"webodf-draggable"!==b.getAttribute("class")&&D(a)}function K(a){(a=a.data)&&(-1===a.indexOf("\n")?aa.insertText(a):oa.paste(a))}function R(a){return function(){a();return!0}}function B(a){return function(b){return"Range"===M.ops_OdtDocument$getCursor(c).ops_OdtCursor$getSelectionType()?a(b):!0}}function V(b){F.unsubscribe("keydown",C.gui_KeyboardHandler$handleEvent);
F.unsubscribe("keypress",X.gui_KeyboardHandler$handleEvent);F.unsubscribe("keyup",ca.gui_KeyboardHandler$handleEvent);F.unsubscribe("copy",q);F.unsubscribe("mousedown",x);F.unsubscribe("mousemove",ka.trigger);F.unsubscribe("mouseup",S);F.unsubscribe("contextmenu",L);F.unsubscribe("dragstart",J);F.unsubscribe("dragend",A);F.unsubscribe("click",na.handleClick);F.unsubscribe("longpress",t);F.unsubscribe("drag",y);F.unsubscribe("dragstop",u);M.unsubscribe("operation/end",ma.trigger);M.unsubscribe(ops.Document.signalCursorAdded,
ha.gui_InputMethodEditor$registerCursor);M.unsubscribe(ops.Document.signalCursorRemoved,ha.gui_InputMethodEditor$removeCursor);M.unsubscribe("operation/end",a);b()}var U=runtime.getWindow(),M=h.ops_Session$getOdtDocument(),P=new gui.SessionConstraints;f=new gui.SessionContext(h,c);var N=core.DomUtils,Y=odf.OdfUtils,W=new gui.MimeDataExporter,fa=new gui.Clipboard(W),C=new gui.KeyboardHandler,X=new gui.KeyboardHandler,ca=new gui.KeyboardHandler,ba=!1,T=new odf.ObjectNameGenerator(M.getOdfCanvas().odfContainer(),
c),ea=!1,E=null,Z,H=null,F=new gui.EventManager(M),ia=new gui.AnnotationController(h,P,c),O=new gui.DirectFormattingController(h,P,f,c,T,!1,!1),aa=new gui.TextController(h,P,f,c,O.createCursorStyleOp,O.createParagraphStyleOps),ga=new gui.ImageController(h,P,f,c,T),la=new gui.ImageSelector(M.getOdfCanvas()),ja=M.createPositionIterator(M.getRootNode()),ka,ma,oa=new gui.PasteController(h,P,f,c),ha=new gui.InputMethodEditor(c,F),da=0,na=new gui.HyperlinkClickHandler(M.getOdfCanvas().getElement,C,ca),
ra=new gui.HyperlinkController(h,P,f,c),Q=new gui.SelectionController(h,c),sa=new gui.MetadataController(h,c),G=gui.KeyboardHandler.Modifier,I=gui.KeyboardHandler.KeyCode,pa=-1!==U.navigator.appVersion.toLowerCase().indexOf("mac"),ta=-1!==["iPad","iPod","iPhone"].indexOf(U.navigator.platform),qa;runtime.BrowserRuntime$assert(!!U,"Expected to be run in an environment which has a global window, like a browser.");this.undo=n;this.redo=k;this.insertLocalCursor=function(){runtime.BrowserRuntime$assert(!h.ops_Session$getOdtDocument().ops_OdtDocument$getCursor(c),
"Inserting local cursor a second time.");var a=new ops.OpAddCursor;a.init({memberid:c});h.enqueue([a]);F.gui_EventManager$focus()};this.removeLocalCursor=function(){runtime.BrowserRuntime$assert(!!h.ops_Session$getOdtDocument().ops_OdtDocument$getCursor(c),"Removing local cursor without inserting before.");var a=new ops.OpRemoveCursor;a.init({memberid:c});h.enqueue([a])};this.startEditing=function(){ha.gui_InputMethodEditor$subscribe(gui.InputMethodEditor.signalCompositionStart,aa.removeCurrentSelection);
ha.gui_InputMethodEditor$subscribe(gui.InputMethodEditor.signalCompositionEnd,K);F.gui_EventManager$subscribe("beforecut",p);F.gui_EventManager$subscribe("cut",r);F.gui_EventManager$subscribe("beforepaste",l);F.gui_EventManager$subscribe("paste",e);H&&H.initialize();F.setEditing(!0);na.setModifier(pa?G.Meta:G.Ctrl);C.bind(I.Backspace,G.None,R(aa.removeTextByBackspaceKey),!0);C.bind(I.Delete,G.None,aa.removeTextByDeleteKey);C.bind(I.Tab,G.None,B(function(){aa.insertText("\t");return!0}));pa?(C.bind(I.Clear,
G.None,aa.removeCurrentSelection),C.bind(I.B,G.Meta,B(O.toggleBold)),C.bind(I.I,G.Meta,B(O.toggleItalic)),C.bind(I.U,G.Meta,B(O.toggleUnderline)),C.bind(I.L,G.MetaShift,B(O.alignParagraphLeft)),C.bind(I.E,G.MetaShift,B(O.alignParagraphCenter)),C.bind(I.R,G.MetaShift,B(O.alignParagraphRight)),C.bind(I.J,G.MetaShift,B(O.alignParagraphJustified)),C.bind(I.Z,G.Meta,n),C.bind(I.Z,G.MetaShift,k)):(C.bind(I.B,G.Ctrl,B(O.toggleBold)),C.bind(I.I,G.Ctrl,B(O.toggleItalic)),C.bind(I.U,G.Ctrl,B(O.toggleUnderline)),
C.bind(I.L,G.CtrlShift,B(O.alignParagraphLeft)),C.bind(I.E,G.CtrlShift,B(O.alignParagraphCenter)),C.bind(I.R,G.CtrlShift,B(O.alignParagraphRight)),C.bind(I.J,G.CtrlShift,B(O.alignParagraphJustified)),C.bind(I.Z,G.Ctrl,n),C.bind(I.Z,G.CtrlShift,k));X.setDefault(B(function(a){var b;b=null===a.which||void 0===a.which?String.fromCharCode(a.keyCode):a.which&&a.charCode?String.fromCharCode(a.which):null;return!b||a.altKey||a.ctrlKey||a.metaKey?!1:(aa.insertText(b),!0)}));X.bind(I.Enter,G.None,B(aa.enqueueParagraphSplittingOps))};
this.endEditing=function(){ha.unsubscribe(gui.InputMethodEditor.signalCompositionStart,aa.removeCurrentSelection);ha.unsubscribe(gui.InputMethodEditor.signalCompositionEnd,K);F.unsubscribe("cut",r);F.unsubscribe("beforecut",p);F.unsubscribe("paste",e);F.unsubscribe("beforepaste",l);F.setEditing(!1);na.setModifier(G.None);C.bind(I.Backspace,G.None,function(){return!0},!0);C.unbind(I.Delete,G.None);C.unbind(I.Tab,G.None);pa?(C.unbind(I.Clear,G.None),C.unbind(I.B,G.Meta),C.unbind(I.I,G.Meta),C.unbind(I.U,
G.Meta),C.unbind(I.L,G.MetaShift),C.unbind(I.E,G.MetaShift),C.unbind(I.R,G.MetaShift),C.unbind(I.J,G.MetaShift),C.unbind(I.Z,G.Meta),C.unbind(I.Z,G.MetaShift)):(C.unbind(I.B,G.Ctrl),C.unbind(I.I,G.Ctrl),C.unbind(I.U,G.Ctrl),C.unbind(I.L,G.CtrlShift),C.unbind(I.E,G.CtrlShift),C.unbind(I.R,G.CtrlShift),C.unbind(I.J,G.CtrlShift),C.unbind(I.Z,G.Ctrl),C.unbind(I.Z,G.CtrlShift));X.setDefault(null);X.unbind(I.Enter,G.None)};this.getInputMemberId=function(){return c};this.gui_SessionController$getSession=
function(){return h};this.getSessionConstraints=function(){return P};this.setUndoManager=function(a){H&&H.unsubscribe(gui.UndoManager.function__this_gui_UndoManager____$signalUndoStackChanged,d);if(H=a)H.setDocument(M),H.gui_TrivialUndoManager$setPlaybackFunction(h.enqueue),H.gui_TrivialUndoManager$subscribe(gui.UndoManager.function__this_gui_UndoManager____$signalUndoStackChanged,d)};this.getUndoManager=function(){return H};this.getMetadataController=function(){return sa};this.getAnnotationController=
function(){return ia};this.getDirectFormattingController=function(){return O};this.getHyperlinkClickHandler=function(){return na};this.getHyperlinkController=function(){return ra};this.getImageController=function(){return ga};this.getSelectionController=function(){return Q};this.getTextController=function(){return aa};this.getEventManager=function(){return F};this.getKeyboardHandlers=function(){return{keydown:C,keypress:X}};this.destroy=function(a){var b=[ka.destroy,ma.destroy,O.destroy,ha.destroy,
F.destroy,na.destroy,ra.destroy,sa.destroy,Q.destroy,aa.destroy,V];qa&&b.unshift(qa.destroy);runtime.BrowserRuntime$clearTimeout(Z);core.Async.destroyAll(b,a)};ka=core.Task.createRedrawTask(z);ma=core.Task.createRedrawTask(function(){var a=M.ops_OdtDocument$getCursor(c);if(a&&"Region"===a.ops_OdtCursor$getSelectionType()&&(a=Y.getImageElements(a.ops_OdtCursor$getSelectedRange())[0])){la.gui_ImageSelector$select(a.parentNode);return}la.clearSelection()});C.bind(I.Left,G.None,B(Q.moveCursorToLeft));
C.bind(I.Right,G.None,B(Q.moveCursorToRight));C.bind(I.Up,G.None,B(Q.moveCursorUp));C.bind(I.Down,G.None,B(Q.moveCursorDown));C.bind(I.Left,G.Shift,B(Q.extendSelectionToLeft));C.bind(I.Right,G.Shift,B(Q.extendSelectionToRight));C.bind(I.Up,G.Shift,B(Q.extendSelectionUp));C.bind(I.Down,G.Shift,B(Q.extendSelectionDown));C.bind(I.Home,G.None,B(Q.moveCursorToLineStart));C.bind(I.End,G.None,B(Q.moveCursorToLineEnd));C.bind(I.Home,G.Ctrl,B(Q.moveCursorToDocumentStart));C.bind(I.End,G.Ctrl,B(Q.moveCursorToDocumentEnd));
C.bind(I.Home,G.Shift,B(Q.extendSelectionToLineStart));C.bind(I.End,G.Shift,B(Q.extendSelectionToLineEnd));C.bind(I.Up,G.CtrlShift,B(Q.extendSelectionToParagraphStart));C.bind(I.Down,G.CtrlShift,B(Q.extendSelectionToParagraphEnd));C.bind(I.Home,G.CtrlShift,B(Q.extendSelectionToDocumentStart));C.bind(I.End,G.CtrlShift,B(Q.extendSelectionToDocumentEnd));pa?(C.bind(I.Left,G.Alt,B(Q.moveCursorBeforeWord)),C.bind(I.Right,G.Alt,B(Q.moveCursorPastWord)),C.bind(I.Left,G.Meta,B(Q.moveCursorToLineStart)),C.bind(I.Right,
G.Meta,B(Q.moveCursorToLineEnd)),C.bind(I.Home,G.Meta,B(Q.moveCursorToDocumentStart)),C.bind(I.End,G.Meta,B(Q.moveCursorToDocumentEnd)),C.bind(I.Left,G.AltShift,B(Q.extendSelectionBeforeWord)),C.bind(I.Right,G.AltShift,B(Q.extendSelectionPastWord)),C.bind(I.Left,G.MetaShift,B(Q.extendSelectionToLineStart)),C.bind(I.Right,G.MetaShift,B(Q.extendSelectionToLineEnd)),C.bind(I.Up,G.AltShift,B(Q.extendSelectionToParagraphStart)),C.bind(I.Down,G.AltShift,B(Q.extendSelectionToParagraphEnd)),C.bind(I.Up,G.MetaShift,
B(Q.extendSelectionToDocumentStart)),C.bind(I.Down,G.MetaShift,B(Q.extendSelectionToDocumentEnd)),C.bind(I.A,G.Meta,B(Q.extendSelectionToEntireDocument))):(C.bind(I.Left,G.Ctrl,B(Q.moveCursorBeforeWord)),C.bind(I.Right,G.Ctrl,B(Q.moveCursorPastWord)),C.bind(I.Left,G.CtrlShift,B(Q.extendSelectionBeforeWord)),C.bind(I.Right,G.CtrlShift,B(Q.extendSelectionPastWord)),C.bind(I.A,G.Ctrl,B(Q.extendSelectionToEntireDocument)));ta&&(qa=new gui.IOSSafariSupport(F));F.gui_EventManager$subscribe("keydown",C.gui_KeyboardHandler$handleEvent);
F.gui_EventManager$subscribe("keypress",X.gui_KeyboardHandler$handleEvent);F.gui_EventManager$subscribe("keyup",ca.gui_KeyboardHandler$handleEvent);F.gui_EventManager$subscribe("copy",q);F.gui_EventManager$subscribe("mousedown",x);F.gui_EventManager$subscribe("mousemove",ka.trigger);F.gui_EventManager$subscribe("mouseup",S);F.gui_EventManager$subscribe("contextmenu",L);F.gui_EventManager$subscribe("dragstart",J);F.gui_EventManager$subscribe("dragend",A);F.gui_EventManager$subscribe("click",na.handleClick);
F.gui_EventManager$subscribe("longpress",t);F.gui_EventManager$subscribe("drag",y);F.gui_EventManager$subscribe("dragstop",u);M.ops_Document_prototype$subscribe("operation/end",ma.trigger);M.ops_Document_prototype$subscribe(ops.Document.signalCursorAdded,ha.gui_InputMethodEditor$registerCursor);M.ops_Document_prototype$subscribe(ops.Document.signalCursorRemoved,ha.gui_InputMethodEditor$removeCursor);M.ops_Document_prototype$subscribe("operation/end",a)}})();
gui.CaretManager=function(g,h){function c(b){return m.hasOwnProperty(b)?m[b]:null}function b(){return Object.keys(m).map(function(b){return m[b]})}function f(b){var c=m[b];c&&(delete m[b],b===g.getInputMemberId()?(p.unsubscribe("router/batchend",c.ensureVisible),p.unsubscribe(ops.Document.signalCursorMoved,c.refreshCursorBlinking),q.unsubscribe("compositionupdate",c.handleUpdate),q.unsubscribe("compositionend",c.handleUpdate),q.unsubscribe("focus",c.setFocus),q.unsubscribe("blur",c.removeFocus),r.removeEventListener("focus",
c.gui_Caret$show,!1),r.removeEventListener("blur",c.gui_Caret$hide,!1)):p.unsubscribe("router/batchend",c.handleUpdate),c.destroy(function(){}))}var m={},r=runtime.getWindow(),p=g.gui_SessionController$getSession().ops_Session$getOdtDocument(),q=g.getEventManager();this.gui_CaretManager$registerCursor=function(b,c,a){var d=b.gui_ShadowCursor$getMemberId();b=new gui.Caret(b,h,c,a);m[d]=b;d===g.getInputMemberId()?(runtime.log("Starting to track input on new cursor of "+d),p.ops_Document_prototype$subscribe("router/batchend",
b.ensureVisible),p.ops_Document_prototype$subscribe(ops.Document.signalCursorMoved,b.refreshCursorBlinking),q.gui_EventManager$subscribe("compositionupdate",b.handleUpdate),q.gui_EventManager$subscribe("compositionend",b.handleUpdate),q.gui_EventManager$subscribe("focus",b.setFocus),q.gui_EventManager$subscribe("blur",b.removeFocus),r.addEventListener("focus",b.gui_Caret$show,!1),r.addEventListener("blur",b.gui_Caret$hide,!1),b.setOverlayElement(q.getEventTrap())):p.ops_Document_prototype$subscribe("router/batchend",
b.handleUpdate);return b};this.gui_CaretManager$getCaret=c;this.getCarets=b;this.destroy=function(c){var h=b().map(function(a){return a.destroy});g.getSelectionController().setCaretXPositionLocator(null);p.unsubscribe(ops.Document.signalCursorRemoved,f);m={};core.Async.destroyAll(h,c)};g.getSelectionController().setCaretXPositionLocator(function(){var b=c(g.getInputMemberId()),f;b&&(f=b.gui_Caret$getBoundingClientRect());return f?f.right:void 0});p.ops_Document_prototype$subscribe(ops.Document.signalCursorRemoved,
f)};
gui.EditInfoHandle=function(g){var h=[],c,b=g.ownerDocument,f=b.documentElement.namespaceURI;this.setEdits=function(g){h=g;var r,p,q,e;core.DomUtils.removeAllChildNodes(c);for(g=0;g<h.length;g+=1)r=b.createElementNS(f,"div"),r.className="editInfo",p=b.createElementNS(f,"span"),p.className="editInfoColor",p.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",h[g].memberid),q=b.createElementNS(f,"span"),q.className="editInfoAuthor",q.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",h[g].memberid),
e=b.createElementNS(f,"span"),e.className="editInfoTime",e.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",h[g].memberid),e.appendChild(b.createTextNode(h[g].time.toString())),r.appendChild(p),r.appendChild(q),r.appendChild(e),c.appendChild(r)};this.gui_EditInfoHandle$show=function(){c.style.display="block"};this.gui_EditInfoHandle$hide=function(){c.style.display="none"};this.destroy=function(b){g.removeChild(c);b()};c=b.createElementNS(f,"div");c.setAttribute("class","editInfoHandle");
c.style.display="none";g.appendChild(c)};
ops.EditInfo=function(g,h){function c(){var b=[],c;for(c in f)f.hasOwnProperty(c)&&b.push({memberid:c,time:f[c].time});b.sort(function(b,c){return b.time-c.time});return b}var b,f={};this.ops_EditInfo$getNode=function(){return b};this.ops_EditInfo$getOdtDocument=function(){return h};this.ops_EditInfo$getEdits=function(){return f};this.getSortedEdits=function(){return c()};this.ops_EditInfo$addEdit=function(b,c){f[b]={time:c}};this.ops_EditInfo$clearEdits=function(){f={}};this.destroy=function(c){g.parentNode&&
g.removeChild(b);c()};b=h.getDOMDocument().createElementNS("urn:webodf:names:editinfo","editinfo");g.insertBefore(b,g.firstChild)};
gui.EditInfoMarker=function(g,h){function c(b,a){return runtime.BrowserRuntime$setTimeout(function(){r.style.opacity=b},a)}var b=this,f,m,r,p,q,e;this.gui_EditInfoMarker$addEdit=function(b,a){var d=Date.now()-a;g.ops_EditInfo$addEdit(b,a);m.setEdits(g.getSortedEdits());r.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",b);runtime.BrowserRuntime$clearTimeout(q);runtime.BrowserRuntime$clearTimeout(e);1E4>d?(p=c(1,0),q=c(.5,1E4-d),e=c(.2,2E4-d)):1E4<=d&&2E4>d?(p=c(.5,0),e=c(.2,2E4-d)):
p=c(.2,0)};this.gui_EditInfoMarker$getEdits=function(){return g.ops_EditInfo$getEdits()};this.gui_EditInfoMarker$clearEdits=function(){g.ops_EditInfo$clearEdits();m.setEdits([]);r.hasAttributeNS("urn:webodf:names:editinfo","editinfo:memberid")&&r.removeAttributeNS("urn:webodf:names:editinfo","editinfo:memberid")};this.getEditInfo=function(){return g};this.gui_EditInfoMarker$show=function(){r.style.display="block"};this.gui_EditInfoMarker$hide=function(){b.gui_EditInfoMarker$hideHandle();r.style.display=
"none"};this.gui_EditInfoMarker$showHandle=function(){m.gui_EditInfoHandle$show()};this.gui_EditInfoMarker$hideHandle=function(){m.gui_EditInfoHandle$hide()};this.destroy=function(b){runtime.BrowserRuntime$clearTimeout(p);runtime.BrowserRuntime$clearTimeout(q);runtime.BrowserRuntime$clearTimeout(e);f.removeChild(r);m.destroy(function(a){a?b(a):g.destroy(b)})};(function(){var c=g.ops_EditInfo$getOdtDocument().getDOMDocument();r=c.createElementNS(c.documentElement.namespaceURI,"div");r.setAttribute("class",
"editInfoMarker");r.onmouseover=function(){b.gui_EditInfoMarker$showHandle()};r.onmouseout=function(){b.gui_EditInfoMarker$hideHandle()};f=g.ops_EditInfo$getNode();f.appendChild(r);m=new gui.EditInfoHandle(f);h||b.gui_EditInfoMarker$hide()})()};
gui.HyperlinkTooltipView=function(g,h){var c=core.DomUtils,b=odf.OdfUtils,f=runtime.getWindow(),m,r,p;runtime.BrowserRuntime$assert(!!f,"Expected to be run in an environment which has a global window, like a browser.");this.showTooltip=function(q){var e=q.target||q.srcElement,l=g.getSizer(),a=g.gui_AnnotatableCanvas_prototype$getZoomLevel(),d;a:{for(;e;){if(b.isHyperlink(e))break a;if(b.isParagraph(e)||b.isInlineRoot(e))break;e=e.parentNode}e=null}if(e){c.core_DomUtilsImpl$containsNode(l,p)||l.appendChild(p);
d=r;var n;switch(h()){case gui.KeyboardHandler.Modifier.Ctrl:n=runtime.tr("Ctrl-click to follow link");break;case gui.KeyboardHandler.Modifier.Meta:n=runtime.tr("\u2318-click to follow link");break;default:n=""}d.textContent=n;m.textContent=b.getHyperlinkTarget(e);p.style.display="block";d=f.innerWidth-p.offsetWidth-15;e=q.clientX>d?d:q.clientX+15;d=f.innerHeight-p.offsetHeight-10;q=q.clientY>d?d:q.clientY+10;l=l.getBoundingClientRect();e=(e-l.left)/a;q=(q-l.top)/a;p.style.left=e+"px";p.style.top=
q+"px"}};this.hideTooltip=function(){p.style.display="none"};this.destroy=function(b){p.parentNode&&p.parentNode.removeChild(p);b()};(function(){var b=g.getElement().ownerDocument;m=b.createElement("span");r=b.createElement("span");m.className="webodf-hyperlinkTooltipLink";r.className="webodf-hyperlinkTooltipText";p=b.createElement("div");p.className="webodf-hyperlinkTooltip";p.appendChild(m);p.appendChild(r);g.getElement().appendChild(p)})()};
gui.OdfFieldView=function(g){function h(){var b=odf.OdfSchema.getFields().map(function(b){return b.replace(":","|")}),c=b.join(",\n")+"\n{ background-color: #D0D0D0; }\n",b=b.map(function(b){return b+":empty::after"}).join(",\n")+"\n{ content:' '; white-space: pre; }\n";return c+"\n"+b}var c,b=g.getElement().ownerDocument;this.showFieldHighlight=function(){c.appendChild(b.createTextNode(h()))};this.hideFieldHighlight=function(){for(var b=c.sheet,g=b.cssRules;g.length;)b.deleteRule(g.length-1)};this.destroy=
function(b){c.parentNode&&c.parentNode.removeChild(c);b()};c=function(){var c=b.getElementsByTagName("head").item(0),g=b.createElement("style"),h="";g.type="text/css";g.media="screen, print, handheld, projection";odf.Namespaces.forEachPrefix(function(b,c){h+="@namespace "+b+" url("+c+");\n"});g.appendChild(b.createTextNode(h));c.appendChild(g);return g}()};
gui.ShadowCursor=function(g){var h=g.getDOMDocument().createRange(),c=!0;this.gui_ShadowCursor$removeFromDocument=function(){};this.gui_ShadowCursor$getMemberId=function(){return gui.ShadowCursor.ShadowCursorMemberId};this.gui_ShadowCursor$getSelectedRange=function(){return h};this.gui_ShadowCursor$setSelectedRange=function(b,f){h=b;c=!1!==f};this.hasForwardSelection=function(){return c};this.gui_ShadowCursor$getDocument=function(){return g};this.gui_ShadowCursor$getSelectionType=function(){return"Range"};
h.setStart(g.getRootNode(),0)};gui.ShadowCursor.ShadowCursorMemberId="";gui.SelectionView=function(g){};gui.SelectionView.prototype.rerender=function(){};gui.SelectionView.prototype.gui_SelectionView_prototype$show=function(){};gui.SelectionView.prototype.gui_SelectionView_prototype$hide=function(){};gui.SelectionView.prototype.destroy=function(g){};
gui.SelectionViewManager=function(g){function h(){return Object.keys(c).map(function(b){return c[b]})}var c={};this.getSelectionView=function(b){return c.hasOwnProperty(b)?c[b]:null};this.getSelectionViews=h;this.removeSelectionView=function(b){c.hasOwnProperty(b)&&(c[b].destroy(function(){}),delete c[b])};this.hideSelectionView=function(b){c.hasOwnProperty(b)&&c[b].gui_SelectionView_prototype$hide()};this.showSelectionView=function(b){c.hasOwnProperty(b)&&c[b].gui_SelectionView_prototype$show()};
this.rerenderSelectionViews=function(){Object.keys(c).forEach(function(b){c[b].rerender()})};this.gui_SelectionViewManager$registerCursor=function(b,f){var h=b.gui_ShadowCursor$getMemberId(),r=new g(b);f?r.gui_SelectionView_prototype$show():r.gui_SelectionView_prototype$hide();return c[h]=r};this.destroy=function(b){function c(h,p){p?b(p):h<g.length?g[h].destroy(function(b){c(h+1,b)}):b()}var g=h();c(0,void 0)}};
gui.SessionViewOptions=function(){this.caretBlinksOnRangeSelect=this.caretAvatarsInitiallyVisible=this.editInfoMarkersInitiallyVisible=!0};
(function(){gui.SessionView=function(g,h,c,b,f,m){function r(a){a.memberId===h&&D.getViewport().gui_SingleScrollViewport$scrollIntoView(a.annotation.getBoundingClientRect())}function p(){var a=document.getElementsByTagName("head").item(0),b=document.createElement("style");b.type="text/css";b.media="screen, print, handheld, projection";a.appendChild(b);return b}function q(a,b,d){function c(b,d,e){d=b+'[editinfo|memberid="'+a+'"]'+e+d;a:{var f=x.firstChild;for(b=b+'[editinfo|memberid="'+a+'"]'+e+"{";f;){if(f.nodeType===
Node.TEXT_NODE&&!f.data.indexOf(b)){b=f;break a}f=f.nextSibling}b=null}b?b.data=d:x.appendChild(document.createTextNode(d))}c("div.editInfoMarker","{ background-color: "+d+"; }","");c("span.editInfoColor","{ background-color: "+d+"; }","");c("span.editInfoAuthor",'{ content: "'+b+'"; }',":before");c("dc|creator","{ background-color: "+d+"; }","");c(".webodf-selectionOverlay","{ fill: "+d+"; stroke: "+d+";}","");a===h&&(c(".webodf-touchEnabled .webodf-selectionOverlay","{ display: block; }"," > .webodf-draggable"),
a=gui.ShadowCursor.ShadowCursorMemberId,c(".webodf-selectionOverlay","{ fill: "+d+"; stroke: "+d+";}",""),c(".webodf-touchEnabled .webodf-selectionOverlay","{ display: block; }"," > .webodf-draggable"))}function e(a){var b,d;for(d in v)v.hasOwnProperty(d)&&(b=v[d],a?b.gui_EditInfoMarker$show():b.gui_EditInfoMarker$hide())}function l(a){f.getCarets().forEach(function(b){a?b.gui_Caret$showHandle():b.gui_Caret$hideHandle()})}function a(a){var b=a.ops_Member$getMemberId();a=a.getProperties();q(b,a.fullName,
a.ops_MemberProperties$color)}function d(a){var b=a.gui_ShadowCursor$getMemberId(),d=c.ops_Session$getOdtDocument().getMember(b).getProperties();f.gui_CaretManager$registerCursor(a,L,!0);m.gui_SelectionViewManager$registerCursor(a,!0);if(a=f.gui_CaretManager$getCaret(b))a.setAvatarImageUrl(d.imageUrl),a.gui_Caret$setColor(d.ops_MemberProperties$color);runtime.log("+++ View here +++ eagerly created an Caret for '"+b+"'! +++")}function n(a){a=a.gui_ShadowCursor$getMemberId();var b=m.getSelectionView(h),
d=m.getSelectionView(gui.ShadowCursor.ShadowCursorMemberId),c=f.gui_CaretManager$getCaret(h);a===h?(d.gui_SelectionView_prototype$hide(),b&&b.gui_SelectionView_prototype$show(),c&&c.gui_Caret$show()):a===gui.ShadowCursor.ShadowCursorMemberId&&(d.gui_SelectionView_prototype$show(),b&&b.gui_SelectionView_prototype$hide(),c&&c.gui_Caret$hide())}function k(a){m.removeSelectionView(a)}function y(a){var b=a.paragraphElement,d=a.memberId;a=a.timeStamp;var e,f,g=b.getElementsByTagNameNS("urn:webodf:names:editinfo",
"editinfo").item(0);g?(f=g.getAttributeNS("urn:webodf:names:editinfo","id"),e=v[f]):(f=Math.random().toString(),e=new ops.EditInfo(b,c.ops_Session$getOdtDocument()),e=new gui.EditInfoMarker(e,A),g=b.getElementsByTagNameNS("urn:webodf:names:editinfo","editinfo").item(0),g.setAttributeNS("urn:webodf:names:editinfo","id",f),v[f]=e);e.gui_EditInfoMarker$addEdit(d,new Date(a));J.trigger()}function u(){var a;w.hasChildNodes()&&core.DomUtils.removeAllChildNodes(w);!0===b.getState(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN)&&
(a=c.ops_Session$getOdtDocument().getMember(h))&&(a=a.getProperties().fullName,w.appendChild(document.createTextNode(".annotationWrapper:not([creator = '"+a+"']) .annotationRemoveButton { display: none; }")))}function z(c){var e=Object.keys(v).map(function(a){return v[a]});t.unsubscribe(ops.Document.signalMemberAdded,a);t.unsubscribe(ops.Document.signalMemberUpdated,a);t.unsubscribe(ops.Document.signalCursorAdded,d);t.unsubscribe(ops.Document.signalCursorRemoved,k);t.unsubscribe("paragraph/changed",
y);t.unsubscribe(ops.Document.signalCursorMoved,n);t.unsubscribe("paragraph/changed",m.rerenderSelectionViews);t.unsubscribe("table/added",m.rerenderSelectionViews);t.unsubscribe("paragraphstyle/modified",m.rerenderSelectionViews);b.unsubscribe(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN,u);t.unsubscribe(ops.Document.signalMemberAdded,u);t.unsubscribe(ops.Document.signalMemberUpdated,u);x.parentNode.removeChild(x);w.parentNode.removeChild(w);(function B(a,b){b?c(b):a<e.length?e[a].destroy(function(b){B(a+
1,b)}):c()})(0,void 0)}var x,w,v={},t,D,J,A=!0,L=!0;this.showEditInfoMarkers=function(){A||(A=!0,e(A))};this.hideEditInfoMarkers=function(){A&&(A=!1,e(A))};this.showCaretAvatars=function(){L||(L=!0,l(L))};this.hideCaretAvatars=function(){L&&(L=!1,l(L))};this.gui_SessionView$getSession=function(){return c};this.gui_SessionView$getCaret=function(a){return f.gui_CaretManager$getCaret(a)};this.destroy=function(a){var b=[J.destroy,z];t.unsubscribe("annotation/added",r);core.Async.destroyAll(b,a)};t=c.ops_Session$getOdtDocument();
D=t.getOdfCanvas();t.ops_Document_prototype$subscribe("annotation/added",r);t.ops_Document_prototype$subscribe(ops.Document.signalMemberAdded,a);t.ops_Document_prototype$subscribe(ops.Document.signalMemberUpdated,a);t.ops_Document_prototype$subscribe(ops.Document.signalCursorAdded,d);t.ops_Document_prototype$subscribe(ops.Document.signalCursorRemoved,k);t.ops_Document_prototype$subscribe("paragraph/changed",y);t.ops_Document_prototype$subscribe(ops.Document.signalCursorMoved,n);t.ops_Document_prototype$subscribe("paragraph/changed",
m.rerenderSelectionViews);t.ops_Document_prototype$subscribe("table/added",m.rerenderSelectionViews);t.ops_Document_prototype$subscribe("paragraphstyle/modified",m.rerenderSelectionViews);b.gui_SessionConstraints$subscribe(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN,u);t.ops_Document_prototype$subscribe(ops.Document.signalMemberAdded,u);t.ops_Document_prototype$subscribe(ops.Document.signalMemberUpdated,u);x=p();x.appendChild(document.createTextNode("@namespace editinfo url(urn:webodf:names:editinfo);"));
x.appendChild(document.createTextNode("@namespace dc url(http://purl.org/dc/elements/1.1/);"));w=p();u();J=core.Task.createRedrawTask(function(){var a=D.getAnnotationViewManager();a&&(a.rehighlightAnnotations(),t.fixCursorPositions())})}})();
gui.SvgSelectionView=function(g){function h(){var a=d.getRootNode();n!==a&&(n=a,k=d.getCanvas().getSizer(),k.appendChild(u),u.setAttribute("class","webodf-selectionOverlay"),x.setAttribute("class","webodf-draggable"),w.setAttribute("class","webodf-draggable"),x.setAttribute("end","left"),w.setAttribute("end","right"),x.setAttribute("r",8),w.setAttribute("r",8),u.appendChild(z),u.appendChild(x),u.appendChild(w))}function c(a){a=a.getBoundingClientRect();return!(!a||!a.height)}function b(a){var b=v.getTextElements(a,
!0,!1),d=a.cloneRange(),e=a.cloneRange();a=a.cloneRange();if(!b.length)return null;var f;a:{f=0;var g=b[f],k=d.startContainer===g?d.startOffset:0,h=k;d.setStart(g,k);for(d.setEnd(g,h);!c(d);){if(g.nodeType===Node.ELEMENT_NODE&&h<g.childNodes.length)h=g.childNodes.length;else if(g.nodeType===Node.TEXT_NODE&&h<g.length)h+=1;else if(b[f])g=b[f],f+=1,k=h=0;else{f=!1;break a}d.setStart(g,k);d.setEnd(g,h)}f=!0}if(!f)return null;a:{f=b.length-1;g=b[f];h=k=e.endContainer===g?e.endOffset:g.nodeType===Node.TEXT_NODE?
g.length:g.childNodes.length;e.setStart(g,k);for(e.setEnd(g,h);!c(e);){if(g.nodeType===Node.ELEMENT_NODE&&0<k)k=0;else if(g.nodeType===Node.TEXT_NODE&&0<k)--k;else if(b[f])g=b[f],--f,k=h=g.length||g.childNodes.length;else{b=!1;break a}e.setStart(g,k);e.setEnd(g,h)}b=!0}if(!b)return null;a.setStart(d.startContainer,d.startOffset);a.setEnd(e.endContainer,e.endOffset);return{firstRange:d,lastRange:e,fillerRange:a}}function f(a,b){var d={};d.top=Math.min(a.top,b.top);d.left=Math.min(a.left,b.left);d.right=
Math.max(a.right,b.right);d.bottom=Math.max(a.bottom,b.bottom);d.width=d.right-d.left;d.height=d.bottom-d.top;return d}function m(a,b){b&&0<b.width&&0<b.height&&(a=a?f(a,b):b);return a}function r(a){function b(a){A.setUnfilteredPosition(a,0);return w.acceptNode(a)===L&&u.acceptPosition(A)===L?L:S}function c(a){var d=null;b(a)===L&&(d=t.core_DomUtilsImpl$getBoundingClientRect(a));return d}var e=a.commonAncestorContainer,f=a.startContainer,g=a.endContainer,k=a.startOffset,h=a.endOffset,n,l,p=null,r,
q=y.createRange(),u,w=new odf.OdfNodeFilter,x;if(f===e||g===e)return q=a.cloneRange(),p=q.getBoundingClientRect(),q.detach(),p;for(a=f;a.parentNode!==e;)a=a.parentNode;for(l=g;l.parentNode!==e;)l=l.parentNode;u=d.createRootFilter(f);for(e=a.nextSibling;e&&e!==l;)r=c(e),p=m(p,r),e=e.nextSibling;if(v.isParagraph(a))p=m(p,t.core_DomUtilsImpl$getBoundingClientRect(a));else if(a.nodeType===Node.TEXT_NODE)e=a,q.setStart(e,k),q.setEnd(e,e===l?h:e.length),r=q.getBoundingClientRect(),p=m(p,r);else for(x=y.createTreeWalker(a,
NodeFilter.SHOW_TEXT,b,!1),e=x.currentNode=f;e&&e!==g;)q.setStart(e,k),q.setEnd(e,e.length),r=q.getBoundingClientRect(),p=m(p,r),n=e,k=0,e=x.nextNode();n||(n=f);if(v.isParagraph(l))p=m(p,t.core_DomUtilsImpl$getBoundingClientRect(l));else if(l.nodeType===Node.TEXT_NODE)e=l,q.setStart(e,e===a?k:0),q.setEnd(e,h),r=q.getBoundingClientRect(),p=m(p,r);else for(x=y.createTreeWalker(l,NodeFilter.SHOW_TEXT,b,!1),e=x.currentNode=g;e&&e!==n;)if(q.setStart(e,0),q.setEnd(e,h),r=q.getBoundingClientRect(),p=m(p,
r),e=x.previousNode())h=e.length;return p}function p(a,b){var d=a.getBoundingClientRect(),c={width:0};c.top=d.top;c.bottom=d.bottom;c.height=d.height;c.left=c.right=b?d.right:d.left;return c}function q(){var a=g.ops_OdtCursor$getSelectedRange(),d;if(d=J&&"Range"===g.ops_OdtCursor$getSelectionType()&&!a.collapsed){h();var c=t.core_DomUtilsImpl$getBoundingClientRect(k),e=D.gui_ZoomHelper$getZoomLevel(),a=b(a),n,l,m,q,y,v;if(a){d=a.firstRange;n=a.lastRange;l=a.fillerRange;m=t.translateRect(p(d,!1),c,
e);y=t.translateRect(p(n,!0),c,e);q=(q=r(l))?t.translateRect(q,c,e):f(m,y);v=q.left;q=m.left+Math.max(0,q.width-(m.left-q.left));c=Math.min(m.top,y.top);e=y.top+y.height;v=[{x:m.left,y:c+m.height},{x:m.left,y:c},{x:q,y:c},{x:q,y:e-y.height},{x:y.right,y:e-y.height},{x:y.right,y:e},{x:v,y:e},{x:v,y:c+m.height},{x:m.left,y:c+m.height}];q="";var A;for(A=0;A<v.length;A+=1)q+=v[A].x+","+v[A].y+" ";z.setAttribute("points",q);x.setAttribute("cx",m.left);x.setAttribute("cy",c+m.height/2);w.setAttribute("cx",
y.right);w.setAttribute("cy",e-y.height/2);d.detach();n.detach();l.detach()}d=!!a}u.style.display=d?"block":"none"}function e(a){J&&a===g&&K.trigger()}function l(a){a=8/a;x.setAttribute("r",a);w.setAttribute("r",a)}function a(a){k.removeChild(u);k.classList.remove("webodf-virtualSelections");g.ops_OdtCursor$getDocument().unsubscribe(ops.Document.signalCursorMoved,e);D.unsubscribe(gui.ZoomHelper.signalZoomChanged,l);a()}var d=g.ops_OdtCursor$getDocument(),n,k,y=d.getDOMDocument(),u=y.createElementNS("http://www.w3.org/2000/svg",
"svg"),z=y.createElementNS("http://www.w3.org/2000/svg","polygon"),x=y.createElementNS("http://www.w3.org/2000/svg","circle"),w=y.createElementNS("http://www.w3.org/2000/svg","circle"),v=odf.OdfUtils,t=core.DomUtils,D=d.getCanvas().getZoomHelper(),J=!0,A=g.ops_OdtCursor$getDocument().createPositionIterator(d.getRootNode()),L=NodeFilter.FILTER_ACCEPT,S=NodeFilter.FILTER_REJECT,K;this.rerender=function(){J&&K.trigger()};this.gui_SelectionView_prototype$show=function(){J=!0;K.trigger()};this.gui_SelectionView_prototype$hide=
function(){J=!1;K.trigger()};this.destroy=function(b){core.Async.destroyAll([K.destroy,a],b)};(function(){var a=g.gui_ShadowCursor$getMemberId();K=core.Task.createRedrawTask(q);h();u.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",a);k.classList.add("webodf-virtualSelections");g.ops_OdtCursor$getDocument().ops_Document_prototype$subscribe(ops.Document.signalCursorMoved,e);D.gui_ZoomHelper$subscribe(gui.ZoomHelper.signalZoomChanged,l);l(D.gui_ZoomHelper$getZoomLevel())})()};
gui.UndoStateRules=function(){function g(b,c){var g=b.length;this.previous=function(){for(--g;0<=g;--g)if(c(b[g]))return b[g];return null}}function h(b){b=b.spec();var c;b.hasOwnProperty("position")&&(c=b.position);return c}function c(b){return b.isEdit}function b(b,c,g){if(!g)return g=h(b)-h(c),!g||1===Math.abs(g);b=h(b);c=h(c);g=h(g);return b-c===c-g}this.isEditOperation=c;this.isPartOfOperationSet=function(f,h){var r=void 0!==f.group,p;if(!f.isEdit||!h.length)return!0;p=h[h.length-1];if(r&&f.group===
p.group)return!0;a:switch(f.spec().optype){case "RemoveText":case "InsertText":p=!0;break a;default:p=!1}if(p&&h.some(c)){if(r){var q;r=f.spec().optype;p=new g(h,c);var e=p.previous(),l=null,a,d;runtime.BrowserRuntime$assert(!!e,"No edit operations found in state");d=e.group;runtime.BrowserRuntime$assert(void 0!==d,"Operation has no group");for(a=1;e&&e.group===d;){if(r===e.spec().optype){q=e;break}e=p.previous()}if(q){for(e=p.previous();e;){if(e.group!==d){if(2===a)break;d=e.group;a+=1}if(r===e.spec().optype){l=
e;break}e=p.previous()}q=b(f,q,l)}else q=!1;return q}q=f.spec().optype;r=new g(h,c);p=r.previous();runtime.BrowserRuntime$assert(!!p,"No edit operations found in state");q=q===p.spec().optype?b(f,p,r.previous()):!1;return q}return!1}};
(function(){function g(b,c){this.mainId=void 0!==b?b:-1;this.subId=void 0!==c?c:-1}function h(b,f,h){function r(c,a){return c+(b.isEditOperation(a)?1:0)}var p,q,e;this.addOperation=function(c){b.isEditOperation(c)&&(e+=1);q.push(c)};this.isNextStateId=function(b){return b.mainId===p&&b.subId===e};this.getNextStateId=function(){return new g(p,e)};this.getOperations=function(){return q};p=c+=1;q=f||[];e=f&&h?f.reduce(r,0):0}var c=0;gui.TrivialUndoManager=function(b){function c(){return!0!==v.isNextStateId(w)}
function m(a){a=a.getOperations();0<a.length&&(L=!0,z(a),L=!1)}function r(){J.core_EventNotifier$emit(gui.UndoManager.function__this_gui_UndoManager____$signalUndoStackChanged,{undoAvailable:n.hasUndoStates(),redoAvailable:n.hasRedoStates()})}function p(a){var b=c();a!==b&&J.core_EventNotifier$emit(gui.UndoManager.signalDocumentModifiedChanged,b)}function q(){v!==u&&v!==t[t.length-1]&&t.push(v)}function e(a){var b=a.previousSibling||a.nextSibling;a.parentNode.removeChild(a);k.normalizeTextNodes(b)}
function l(a){return Object.keys(a).map(function(b){return a[b]})}function a(a){function b(a){var g=a.spec();if(e[g.memberid])switch(g.optype){case "AddCursor":d[g.memberid]||(d[g.memberid]=a,delete e[g.memberid],--f);break;case "MoveCursor":c[g.memberid]||(c[g.memberid]=a)}}var d={},c={},e={},f,g;g=a.pop();x.getMemberIds().forEach(function(a){e[a]=!0});for(f=Object.keys(e).length;g&&0<f;)g=g.getOperations(),g.reverse(),g.forEach(b),g=a.pop();return new h(A,l(d).concat(l(c)))}function d(){var b=c(),
d=y=x.cloneDocumentElement();k.core_DomUtilsImpl$getElementsByTagNameNS(d,"urn:webodf:names:cursor","cursor").forEach(e);k.core_DomUtilsImpl$getElementsByTagNameNS(d,"urn:webodf:names:cursor","anchor").forEach(e);q();v=u=a([u].concat(t));t.length=0;D.length=0;b||(w=v.getNextStateId());r();p(b)}var n=this,k=core.DomUtils,y,u,z,x,w,v,t=[],D=[],J=new core.EventNotifier([gui.UndoManager.function__this_gui_UndoManager____$signalUndoStackChanged,gui.UndoManager.signalUndoStateCreated,gui.UndoManager.signalUndoStateModified,
gui.UndoManager.signalDocumentModifiedChanged,gui.TrivialUndoManager.signalDocumentRootReplaced]),A=b||new gui.UndoStateRules,L=!1;this.gui_TrivialUndoManager$subscribe=function(a,b){J.core_EventNotifier$subscribe(a,b)};this.unsubscribe=function(a,b){J.unsubscribe(a,b)};this.isDocumentModified=c;this.setDocumentModified=function(a){c()!==a&&(w=a?new g:v.getNextStateId(),J.core_EventNotifier$emit(gui.UndoManager.signalDocumentModifiedChanged,a))};this.hasUndoStates=function(){return 0<t.length};this.hasRedoStates=
function(){return 0<D.length};this.setDocument=function(a){x=a};this.purgeInitialState=function(){var a=c();t.length=0;D.length=0;v=u=new h(A);w=v.getNextStateId();y=null;r();p(a)};this.setInitialState=d;this.initialize=function(){y||d()};this.gui_TrivialUndoManager$setPlaybackFunction=function(a){z=a};this.onOperationExecuted=function(a){if(!L){var b=c();A.isEditOperation(a)&&(v===u||0<D.length)||!A.isPartOfOperationSet(a,v.getOperations())?(D.length=0,q(),v=new h(A,[a],!0),t.push(v),J.core_EventNotifier$emit(gui.UndoManager.signalUndoStateCreated,
{operations:v.getOperations()}),r()):(v.addOperation(a),J.core_EventNotifier$emit(gui.UndoManager.signalUndoStateModified,{operations:v.getOperations()}));p(b)}};this.moveForward=function(a){for(var b=0,d=c(),e;a&&D.length;)e=D.pop(),t.push(e),m(e),--a,b+=1;b&&(v=t[t.length-1],r(),p(d));return b};this.moveBackward=function(a){for(var b=0,d=c();a&&t.length;)D.push(t.pop()),--a,b+=1;b&&(x.getMemberIds().forEach(function(a){x.hasCursor(a)&&x.ops_Document_prototype$removeCursor(a)}),x.setDocumentElement(y.cloneNode(!0)),
J.core_EventNotifier$emit(gui.TrivialUndoManager.signalDocumentRootReplaced,{}),m(u),t.forEach(m),v=t[t.length-1]||u,r(),p(d));return b};v=u=new h(A);w=v.getNextStateId()};gui.TrivialUndoManager.signalDocumentRootReplaced="documentRootReplaced"})();
odf.GraphicProperties=function(g,h,c){var b=this,f=odf.Namespaces.stylens,m=odf.Namespaces.svgns;this.verticalPos=function(){return b.data.value("verticalPos")};this.verticalRel=function(){return b.data.value("verticalRel")};this.horizontalPos=function(){return b.data.value("horizontalPos")};this.horizontalRel=function(){return b.data.value("horizontalRel")};this.strokeWidth=function(){return b.data.value("strokeWidth")};b.data=new odf.LazyStyleProperties(c?c.data:void 0,{verticalPos:function(){var b=
g.getAttributeNS(f,"vertical-pos");return""===b?void 0:b},verticalRel:function(){var b=g.getAttributeNS(f,"vertical-rel");return""===b?void 0:b},horizontalPos:function(){var b=g.getAttributeNS(f,"horizontal-pos");return""===b?void 0:b},horizontalRel:function(){var b=g.getAttributeNS(f,"horizontal-rel");return""===b?void 0:b},strokeWidth:function(){var b=g.getAttributeNS(m,"stroke-width");return h.odf_StyleParseUtils$parseLength(b)}})};
odf.ComputedGraphicProperties=function(){var g;this.setGraphicProperties=function(h){g=h};this.verticalPos=function(){return g&&g.verticalPos()||"from-top"};this.verticalRel=function(){return g&&g.verticalRel()||"page"};this.horizontalPos=function(){return g&&g.horizontalPos()||"from-left"};this.horizontalRel=function(){return g&&g.horizontalRel()||"page"}};
odf.PageLayoutProperties=function(g,h,c){var b=this,f=odf.Namespaces.fons;this.pageHeight=function(){return b.data.value("pageHeight")||1123};this.pageWidth=function(){return b.data.value("pageWidth")||794};b.data=new odf.LazyStyleProperties(c?c.data:void 0,{pageHeight:function(){var b;g&&(b=g.getAttributeNS(f,"page-height"),b=h.odf_StyleParseUtils$parseLength(b));return b},pageWidth:function(){var b;g&&(b=g.getAttributeNS(f,"page-width"),b=h.odf_StyleParseUtils$parseLength(b));return b}})};
odf.PageLayout=function(g,h,c){var b=null;g&&(b=h.getPropertiesElement("page-layout-properties",g));this.odf_PageLayout$pageLayout=new odf.PageLayoutProperties(b,h,c&&c.odf_PageLayout$pageLayout)};odf.PageLayoutCache=function(){};odf.PageLayoutCache.prototype.getPageLayout=function(g){};odf.PageLayoutCache.prototype.getDefaultPageLayout=function(){};
odf.ParagraphProperties=function(g,h,c){var b=this,f=odf.Namespaces.fons;this.marginTop=function(){return b.data.value("marginTop")};b.data=new odf.LazyStyleProperties(c?c.data:void 0,{marginTop:function(){var b=g.getAttributeNS(f,"margin-top");return h.parsePositiveLengthOrPercent(b,"marginTop",c&&c.data)}})};
odf.ComputedParagraphProperties=function(){var g={},h=[];this.odf_ComputedParagraphProperties$setStyleChain=function(c){h=c;g={}};this.marginTop=function(){var c,b;if(g.hasOwnProperty("marginTop"))c=g.marginTop;else{for(b=0;void 0===c&&b<h.length;b+=1)c=h[b].marginTop();g.marginTop=c}return c||0}};
odf.TextProperties=function(g,h,c){var b=this,f=odf.Namespaces.fons;this.fontSize=function(){return b.data.value("fontSize")};b.data=new odf.LazyStyleProperties(c?c.data:void 0,{fontSize:function(){var b=g.getAttributeNS(f,"font-size");return h.parsePositiveLengthOrPercent(b,"fontSize",c&&c.data)}})};
odf.ComputedTextProperties=function(){var g={},h=[];this.odf_ComputedTextProperties$setStyleChain=function(c){h=c;g={}};this.fontSize=function(){var c,b;if(g.hasOwnProperty("fontSize"))c=g.fontSize;else{for(b=0;void 0===c&&b<h.length;b+=1)c=h[b].fontSize();g.fontSize=c}return c||12}};odf.MasterPage=function(g,h){var c;g?(c=g.getAttributeNS(odf.Namespaces.stylens,"page-layout-name"),this.odf_MasterPage$pageLayout=h.getPageLayout(c)):this.odf_MasterPage$pageLayout=h.getDefaultPageLayout()};
odf.MasterPageCache=function(){};odf.MasterPageCache.prototype.getMasterPage=function(g){};
odf.StylePileEntry=function(g,h,c,b){this.masterPage=function(){var b=g.getAttributeNS(odf.Namespaces.stylens,"master-page-name"),h=null;b&&(h=c.getMasterPage(b));return h};(function(c){var m=g.getAttributeNS(odf.Namespaces.stylens,"family"),r=null;if("graphic"===m||"chart"===m)if(c.graphic=b?b.graphic:void 0,r=h.getPropertiesElement("graphic-properties",g,r))c.graphic=new odf.GraphicProperties(r,h,c.graphic);if("paragraph"===m||"table-cell"===m||"graphic"===m||"presentation"===m||"chart"===m)if(c.paragraph=
b?b.paragraph:void 0,r=h.getPropertiesElement("paragraph-properties",g,r))c.paragraph=new odf.ParagraphProperties(r,h,c.paragraph);if("text"===m||"paragraph"===m||"table-cell"===m||"graphic"===m||"presentation"===m||"chart"===m)if(c.text=b?b.text:void 0,r=h.getPropertiesElement("text-properties",g,r))c.text=new odf.TextProperties(r,h,c.text)})(this)};
odf.StylePile=function(g,h){function c(c,a){var d,f;c.hasAttributeNS(b,"parent-style-name")&&(f=c.getAttributeNS(b,"parent-style-name"),-1===a.indexOf(f)&&(d=e(f,a)));return new odf.StylePileEntry(c,g,h,d)}var b=odf.Namespaces.stylens,f={},m={},r,p={},q={},e;e=function(b,a){var d=p[b],e;!d&&(e=f[b])&&(a.push(b),d=c(e,a),p[b]=d);return d};this.getStyle=function(b){var a=q[b]||p[b],d,e=[];a||(d=m[b],d||(d=f[b])&&e.push(b),d&&(a=c(d,e)));return a};this.addCommonStyle=function(c){var a;c.hasAttributeNS(b,
"name")&&(a=c.getAttributeNS(b,"name"),f.hasOwnProperty(a)||(f[a]=c))};this.addAutomaticStyle=function(c){var a;c.hasAttributeNS(b,"name")&&(a=c.getAttributeNS(b,"name"),m.hasOwnProperty(a)||(m[a]=c))};this.setDefaultStyle=function(b){r||(r=c(b,[]))};this.getDefaultStyle=function(){return r}};odf.ComputedGraphicStyle=function(){this.text=new odf.ComputedTextProperties;this.paragraph=new odf.ComputedParagraphProperties;this.graphic=new odf.ComputedGraphicProperties};
odf.ComputedParagraphStyle=function(){this.text=new odf.ComputedTextProperties;this.paragraph=new odf.ComputedParagraphProperties};odf.ComputedTextStyle=function(){this.text=new odf.ComputedTextProperties};
odf.StyleCache=function(g){function h(a,b,d,c){b=d.getAttributeNS(b,"class-names");var e;if(b)for(b=b.split(" "),e=0;e<b.length;e+=1)if(d=b[e])c.push(a),c.push(d)}function c(a,b){var d=u.getStyleName("paragraph",a);void 0!==d&&(b.push("paragraph"),b.push(d));a.namespaceURI!==k||"h"!==a.localName&&"p"!==a.localName||h("paragraph",k,a,b);return b}function b(a,b,d){var c=[],e,f,g,k;for(e=0;e<a.length;e+=2)g=a[e],k=a[e+1],g=p[g],(k=g.getStyle(k))&&(k=k[b])&&k!==f&&(c.push(k),f=k);g=p[d];(k=g.getDefaultStyle())&&
(k=k[b])&&k!==f&&c.push(k);return c}function f(a,b){var d=u.getStyleName("text",a),e=a.parentNode;void 0!==d&&(b.push("text"),b.push(d));"span"===a.localName&&a.namespaceURI===k&&h("text",k,a,b);if(!e||e===g)return b;e.namespaceURI!==k||"p"!==e.localName&&"h"!==e.localName?f(e,b):c(e,b);return b}function m(a){a=a.getAttributeNS(y,"family");return p[a]}var r=this,p,q,e,l,a,d,n,k=odf.Namespaces.textns,y=odf.Namespaces.stylens,u=new odf.StyleInfo,z=new odf.StyleParseUtils,x,w,v,t,D,J;this.getComputedGraphicStyle=
function(a){var d=[];a=u.getStyleName("graphic",a);void 0!==a&&(d.push("graphic"),d.push(a));a=d.join("/");var c=l[a];runtime.BrowserRuntime$assert(!(d.length%2),"Invalid style chain.");c||(c=new odf.ComputedGraphicStyle,c.graphic.setGraphicProperties(b(d,"graphic","graphic")[0]),c.text.odf_ComputedTextProperties$setStyleChain(b(d,"text","graphic")),c.paragraph.odf_ComputedParagraphProperties$setStyleChain(b(d,"paragraph","graphic")),l[a]=c);return c};this.getComputedParagraphStyle=function(a){a=
c(a,[]);var d=a.join("/"),f=e[d];runtime.BrowserRuntime$assert(!(a.length%2),"Invalid style chain.");f||(f=new odf.ComputedParagraphStyle,f.text.odf_ComputedTextProperties$setStyleChain(b(a,"text","paragraph")),f.paragraph.odf_ComputedParagraphProperties$setStyleChain(b(a,"paragraph","paragraph")),e[d]=f);return f};this.getComputedTextStyle=function(a){a=f(a,[]);var d=a.join("/"),c=q[d];runtime.BrowserRuntime$assert(!(a.length%2),"Invalid style chain.");c||(c=new odf.ComputedTextStyle,c.text.odf_ComputedTextProperties$setStyleChain(b(a,
"text","text")),q[d]=c);return c};this.getPageLayout=function(a){var b=J[a];b||((b=D[a])?(b=new odf.PageLayout(b,z,t),J[a]=b):b=t);return b};this.getDefaultPageLayout=function(){return t};this.getMasterPage=function(a){var b=w[a];b||((b=x[a])?(b=new odf.MasterPage(b,r),w[a]=b):b=null);return b};this.getDefaultMasterPage=function(){return v};this.odf_StyleCache$update=function(){var b,c,f=null,k=null;q={};e={};l={};x={};w={};J={};D={};a=new odf.StylePile(z,r);d=new odf.StylePile(z,r);n=new odf.StylePile(z,
r);p={text:a,paragraph:d,graphic:n};for(b=g.styles.firstElementChild;b;)b.namespaceURI===y&&((c=m(b))?"style"===b.localName?c.addCommonStyle(b):"default-style"===b.localName&&c.setDefaultStyle(b):"default-page-layout"===b.localName&&(f=b)),b=b.nextElementSibling;t=new odf.PageLayout(f,z);for(b=g.automaticStyles.firstElementChild;b;)b.namespaceURI===y&&((c=m(b))&&"style"===b.localName?c.addAutomaticStyle(b):"page-layout"===b.localName&&(D[b.getAttributeNS(y,"name")]=b)),b=b.nextElementSibling;for(b=
g.masterStyles.firstElementChild;b;)b.namespaceURI===y&&"master-page"===b.localName&&(k=k||b,c=b,f=c.getAttributeNS(y,"name"),0<f.length&&!x.hasOwnProperty(f)&&(x[f]=c)),b=b.nextElementSibling;v=new odf.MasterPage(k,r)}};
ops.OperationTransformMatrix=function(){function g(a){a.position+=a.length;a.length*=-1}function h(a){var b=0>a.length;b&&g(a);return b}function c(a,b){function c(f){a[f]===b&&e.push(f)}var e=[];a&&["style:parent-style-name","style:next-style-name"].forEach(c);return e}function b(a,b){function c(e){a[e]===b&&delete a[e]}a&&["style:parent-style-name","style:next-style-name"].forEach(c)}function f(a){var b={};Object.keys(a).forEach(function(c){b[c]="object"===typeof a[c]?f(a[c]):a[c]});return b}function m(a,
b,c,e){var f,g=!1,h=!1,l,m=[];e&&e.attributes&&(m=e.attributes.split(","));a&&(c||0<m.length)&&Object.keys(a).forEach(function(b){var d=a[b],e;"object"!==typeof d&&(c&&(e=c[b]),void 0!==e?(delete a[b],h=!0,e===d&&(delete c[b],g=!0)):-1!==m.indexOf(b)&&(delete a[b],h=!0))});if(b&&b.attributes&&(c||0<m.length)){l=b.attributes.split(",");for(e=0;e<l.length;e+=1)if(f=l[e],c&&void 0!==c[f]||m&&-1!==m.indexOf(f))l.splice(e,1),--e,h=!0;0<l.length?b.attributes=l.join(","):delete b.attributes}return{majorChanged:g,
minorChanged:h}}function r(a){for(var b in a)if(a.hasOwnProperty(b))return!0;return!1}function p(a){for(var b in a)if(a.hasOwnProperty(b)&&("attributes"!==b||0<a.attributes.length))return!0;return!1}function q(a,b,c,e,f){var g=a?a[f]:null,h=b?b[f]:null,l=c?c[f]:null,q=e?e[f]:null,v;v=m(g,h,l,q);g&&!r(g)&&delete a[f];h&&!p(h)&&delete b[f];l&&!r(l)&&delete c[f];q&&!p(q)&&delete e[f];return v}function e(a,b){return{opSpecsA:[a],opSpecsB:[b]}}var l;l={AddAnnotation:{AddAnnotation:function(a,b,c){var e;
a.position<b.position?(e=a,c=b):b.position<a.position?(e=b,c=a):(e=c?a:b,c=c?b:a);c.position<e.position+e.length&&(e.length+=2);c.position+=2;return{opSpecsA:[a],opSpecsB:[b]}},AddCursor:e,AddMember:e,AddStyle:e,ApplyDirectStyling:function(a,b){a.position<=b.position?b.position+=2:a.position<=b.position+b.length&&(b.length+=2);return{opSpecsA:[a],opSpecsB:[b]}},InsertText:function(a,b){b.position<=a.position?a.position+=b.text.length:(void 0!==a.length&&b.position<=a.position+a.length&&(a.length+=
b.text.length),b.position+=2);return{opSpecsA:[a],opSpecsB:[b]}},MergeParagraph:function(a,b){b.sourceStartPosition<=a.position?--a.position:(void 0!==a.length&&b.sourceStartPosition<=a.position+a.length&&--a.length,b.sourceStartPosition+=2,a.position<b.destinationStartPosition&&(b.destinationStartPosition+=2));return{opSpecsA:[a],opSpecsB:[b]}},MoveCursor:function(a,b){var c=h(b);a.position<b.position?b.position+=2:a.position<b.position+b.length&&(b.length+=2);c&&g(b);return{opSpecsA:[a],opSpecsB:[b]}},
RemoveAnnotation:function(a,b){a.position<b.position?(b.position<a.position+a.length&&(a.length-=b.length+2),b.position+=2):a.position-=b.length+2;return{opSpecsA:[a],opSpecsB:[b]}},RemoveCursor:e,RemoveMember:e,RemoveStyle:e,RemoveText:function(a,b){var c=b.position,e=b.position+b.length,f,g=[a],h=[b];a.position<=b.position?b.position+=2:a.position<e&&(b.length=a.position-b.position,f={optype:"RemoveText",memberid:b.memberid,timestamp:b.timestamp,position:a.position+2,length:e-a.position},h.unshift(f));
b.position+b.length<=a.position?(a.position-=b.length,void 0!==a.length&&f&&(a.length=f.length>=a.length?0:a.length-f.length)):void 0!==a.length&&(f=a.position+a.length,e<=f?a.length-=b.length:c<f&&(a.length=c-a.position));return{opSpecsA:g,opSpecsB:h}},SetParagraphStyle:function(a,b){a.position<b.position&&(b.position+=2);return{opSpecsA:[a],opSpecsB:[b]}},SplitParagraph:function(a,b){a.position<b.sourceParagraphPosition&&(b.sourceParagraphPosition+=2);b.position<=a.position?a.position+=1:(void 0!==
a.length&&b.position<=a.position+a.length&&(a.length+=1),b.position+=2);return{opSpecsA:[a],opSpecsB:[b]}},UpdateMember:e,UpdateMetadata:e,UpdateParagraphStyle:e},AddCursor:{AddCursor:e,AddMember:e,AddStyle:e,ApplyDirectStyling:e,InsertText:e,MergeParagraph:e,MoveCursor:e,RemoveAnnotation:e,RemoveCursor:e,RemoveMember:e,RemoveStyle:e,RemoveText:e,SetParagraphStyle:e,SplitParagraph:e,UpdateMember:e,UpdateMetadata:e,UpdateParagraphStyle:e},AddMember:{AddStyle:e,ApplyDirectStyling:e,InsertText:e,MergeParagraph:e,
MoveCursor:e,RemoveAnnotation:e,RemoveCursor:e,RemoveStyle:e,RemoveText:e,SetParagraphStyle:e,SplitParagraph:e,UpdateMetadata:e,UpdateParagraphStyle:e},AddStyle:{AddStyle:e,ApplyDirectStyling:e,InsertText:e,MergeParagraph:e,MoveCursor:e,RemoveAnnotation:e,RemoveCursor:e,RemoveMember:e,RemoveStyle:function(a,d){var e,f=[a],g=[d];a.styleFamily===d.styleFamily&&(e=c(a.setProperties,d.styleName),0<e.length&&(e={optype:"UpdateParagraphStyle",memberid:d.memberid,timestamp:d.timestamp,styleName:a.styleName,
removedProperties:{attributes:e.join(",")}},g.unshift(e)),b(a.setProperties,d.styleName));return{opSpecsA:f,opSpecsB:g}},RemoveText:e,SetParagraphStyle:e,SplitParagraph:e,UpdateMember:e,UpdateMetadata:e,UpdateParagraphStyle:e},ApplyDirectStyling:{ApplyDirectStyling:function(a,b,c){var e,g,h,l,m,p,v,t;l=[a];h=[b];if(!(a.position+a.length<=b.position||a.position>=b.position+b.length)){e=c?a:b;g=c?b:a;if(a.position!==b.position||a.length!==b.length)p=f(e),v=f(g);b=q(g.setProperties,null,e.setProperties,
null,"style:text-properties");if(b.majorChanged||b.minorChanged)h=[],a=[],l=e.position+e.length,m=g.position+g.length,g.position<e.position?b.minorChanged&&(t=f(v),t.length=e.position-g.position,a.push(t),g.position=e.position,g.length=m-g.position):e.position<g.position&&b.majorChanged&&(t=f(p),t.length=g.position-e.position,h.push(t),e.position=g.position,e.length=l-e.position),m>l?b.minorChanged&&(p=v,p.position=l,p.length=m-l,a.push(p),g.length=l-g.position):l>m&&b.majorChanged&&(p.position=m,
p.length=l-m,h.push(p),e.length=m-e.position),e.setProperties&&r(e.setProperties)&&h.push(e),g.setProperties&&r(g.setProperties)&&a.push(g),c?(l=h,h=a):l=a}return{opSpecsA:l,opSpecsB:h}},InsertText:function(a,b){b.position<=a.position?a.position+=b.text.length:b.position<=a.position+a.length&&(a.length+=b.text.length);return{opSpecsA:[a],opSpecsB:[b]}},MergeParagraph:function(a,b){var c=a.position,e=a.position+a.length;c>=b.sourceStartPosition&&--c;e>=b.sourceStartPosition&&--e;a.position=c;a.length=
e-c;return{opSpecsA:[a],opSpecsB:[b]}},MoveCursor:e,RemoveAnnotation:function(a,b){var c=a.position,e=a.position+a.length,f=b.position+b.length,g=[a],h=[b];b.position<=c&&e<=f?g=[]:(f<c&&(c-=b.length+2),f<e&&(e-=b.length+2),a.position=c,a.length=e-c);return{opSpecsA:g,opSpecsB:h}},RemoveCursor:e,RemoveMember:e,RemoveStyle:e,RemoveText:function(a,b){var c=a.position+a.length,e=b.position+b.length,f=[a],g=[b];e<=a.position?a.position-=b.length:b.position<c&&(a.position<b.position?a.length=e<c?a.length-
b.length:b.position-a.position:(a.position=b.position,e<c?a.length=c-e:f=[]));return{opSpecsA:f,opSpecsB:g}},SetParagraphStyle:e,SplitParagraph:function(a,b){b.position<a.position?a.position+=1:b.position<a.position+a.length&&(a.length+=1);return{opSpecsA:[a],opSpecsB:[b]}},UpdateMember:e,UpdateMetadata:e,UpdateParagraphStyle:e},InsertText:{InsertText:function(a,b,c){a.position<b.position?b.position+=a.text.length:a.position>b.position?a.position+=b.text.length:c?b.position+=a.text.length:a.position+=
b.text.length;return{opSpecsA:[a],opSpecsB:[b]}},MergeParagraph:function(a,b){a.position>=b.sourceStartPosition?--a.position:(a.position<b.sourceStartPosition&&(b.sourceStartPosition+=a.text.length),a.position<b.destinationStartPosition&&(b.destinationStartPosition+=a.text.length));return{opSpecsA:[a],opSpecsB:[b]}},MoveCursor:function(a,b){var c=h(b);a.position<b.position?b.position+=a.text.length:a.position<b.position+b.length&&(b.length+=a.text.length);c&&g(b);return{opSpecsA:[a],opSpecsB:[b]}},
RemoveAnnotation:function(a,b){var c=a.position,e=b.position+b.length,f=[a],g=[b];b.position<=c&&c<=e?(f=[],b.length+=a.text.length):e<a.position?a.position-=b.length+2:b.position+=a.text.length;return{opSpecsA:f,opSpecsB:g}},RemoveCursor:e,RemoveMember:e,RemoveStyle:e,RemoveText:function(a,b){var c;c=b.position+b.length;var e=[a],f=[b];c<=a.position?a.position-=b.length:a.position<=b.position?b.position+=a.text.length:(b.length=a.position-b.position,c={optype:"RemoveText",memberid:b.memberid,timestamp:b.timestamp,
position:a.position+a.text.length,length:c-a.position},f.unshift(c),a.position=b.position);return{opSpecsA:e,opSpecsB:f}},SetParagraphStyle:function(a,b){b.position>a.position&&(b.position+=a.text.length);return{opSpecsA:[a],opSpecsB:[b]}},SplitParagraph:function(a,b){a.position<b.sourceParagraphPosition&&(b.sourceParagraphPosition+=a.text.length);a.position<=b.position?b.position+=a.text.length:a.position+=1;return{opSpecsA:[a],opSpecsB:[b]}},UpdateMember:e,UpdateMetadata:e,UpdateParagraphStyle:e},
MergeParagraph:{MergeParagraph:function(a,b,c){var e=[a],f=[b],g;a.destinationStartPosition===b.destinationStartPosition?(e=[],f=[],a.moveCursor&&(g={optype:"MoveCursor",memberid:a.memberid,timestamp:a.timestamp,position:a.sourceStartPosition-1},e.push(g)),b.moveCursor&&(g={optype:"MoveCursor",memberid:b.memberid,timestamp:b.timestamp,position:b.sourceStartPosition-1},f.push(g)),a=c?a:b,a={optype:"SetParagraphStyle",memberid:a.memberid,timestamp:a.timestamp,position:a.destinationStartPosition,styleName:a.paragraphStyleName},
c?e.push(a):f.push(a)):b.sourceStartPosition===a.destinationStartPosition?(a.destinationStartPosition=b.destinationStartPosition,--a.sourceStartPosition,a.paragraphStyleName=b.paragraphStyleName):a.sourceStartPosition===b.destinationStartPosition?(b.destinationStartPosition=a.destinationStartPosition,--b.sourceStartPosition,b.paragraphStyleName=a.paragraphStyleName):a.destinationStartPosition<b.destinationStartPosition?(--b.destinationStartPosition,--b.sourceStartPosition):(--a.destinationStartPosition,
--a.sourceStartPosition);return{opSpecsA:e,opSpecsB:f}},MoveCursor:function(a,b){var c=b.position,e=b.position+b.length,f=Math.min(c,e),c=Math.max(c,e);f>=a.sourceStartPosition&&--f;c>=a.sourceStartPosition&&--c;0<=b.length?(b.position=f,b.length=c-f):(b.position=c,b.length=f-c);return{opSpecsA:[a],opSpecsB:[b]}},RemoveAnnotation:function(a,b){var c=b.position+b.length,e=[a],f=[b];b.position<=a.destinationStartPosition&&a.sourceStartPosition<=c?(e=[],--b.length):a.sourceStartPosition<b.position?--b.position:
(c<a.destinationStartPosition&&(a.destinationStartPosition-=b.length+2),c<a.sourceStartPosition&&(a.sourceStartPosition-=b.length+2));return{opSpecsA:e,opSpecsB:f}},RemoveCursor:e,RemoveMember:e,RemoveStyle:e,RemoveText:function(a,b){b.position>=a.sourceStartPosition?--b.position:(b.position<a.destinationStartPosition&&(a.destinationStartPosition-=b.length),b.position<a.sourceStartPosition&&(a.sourceStartPosition-=b.length));return{opSpecsA:[a],opSpecsB:[b]}},SetParagraphStyle:function(a,b){var c=
[a],e=[b];if(b.position>a.sourceStartPosition)--b.position;else if(b.position===a.destinationStartPosition||b.position===a.sourceStartPosition)b.position=a.destinationStartPosition,a.paragraphStyleName=b.styleName;return{opSpecsA:c,opSpecsB:e}},SplitParagraph:function(a,b){var c,e=[a],f=[b];b.position<a.destinationStartPosition?(a.destinationStartPosition+=1,a.sourceStartPosition+=1):b.position>=a.destinationStartPosition&&b.position<a.sourceStartPosition?(b.paragraphStyleName=a.paragraphStyleName,
c={optype:"SetParagraphStyle",memberid:a.memberid,timestamp:a.timestamp,position:a.destinationStartPosition,styleName:a.paragraphStyleName},e.push(c),b.position===a.sourceStartPosition-1&&a.moveCursor&&(c={optype:"MoveCursor",memberid:a.memberid,timestamp:a.timestamp,position:b.position,length:0},e.push(c)),a.destinationStartPosition=b.position+1,a.sourceStartPosition+=1):b.position>=a.sourceStartPosition&&(--b.position,--b.sourceParagraphPosition);return{opSpecsA:e,opSpecsB:f}},UpdateMember:e,UpdateMetadata:e,
UpdateParagraphStyle:e},MoveCursor:{MoveCursor:e,RemoveAnnotation:function(a,b){var c=h(a),e=a.position+a.length,f=b.position+b.length;b.position<=a.position&&e<=f?(a.position=b.position-1,a.length=0):(f<a.position?a.position-=b.length+2:f<e&&(a.length-=b.length+2),c&&g(a));return{opSpecsA:[a],opSpecsB:[b]}},RemoveCursor:function(a,b){return{opSpecsA:a.memberid===b.memberid?[]:[a],opSpecsB:[b]}},RemoveMember:e,RemoveStyle:e,RemoveText:function(a,b){var c=h(a),e=a.position+a.length,f=b.position+b.length;
f<=a.position?a.position-=b.length:b.position<e&&(a.position<b.position?a.length=f<e?a.length-b.length:b.position-a.position:(a.position=b.position,a.length=f<e?e-f:0));c&&g(a);return{opSpecsA:[a],opSpecsB:[b]}},SetParagraphStyle:e,SplitParagraph:function(a,b){var c=h(a);b.position<a.position?a.position+=1:b.position<a.position+a.length&&(a.length+=1);c&&g(a);return{opSpecsA:[a],opSpecsB:[b]}},UpdateMember:e,UpdateMetadata:e,UpdateParagraphStyle:e},RemoveAnnotation:{RemoveAnnotation:function(a,b){var c=
[a],e=[b];a.position===b.position&&a.length===b.length?(c=[],e=[]):a.position<b.position?b.position-=a.length+2:a.position-=b.length+2;return{opSpecsA:c,opSpecsB:e}},RemoveCursor:e,RemoveMember:e,RemoveStyle:e,RemoveText:function(a,b){var c=a.position+a.length,e=b.position+b.length,f=[a],g=[b];a.position<=b.position&&e<=c?(g=[],a.length-=b.length):e<a.position?a.position-=b.length:b.position<a.position?(a.position=b.position+1,b.length-=a.length+2):b.position-=a.length+2;return{opSpecsA:f,opSpecsB:g}},
SetParagraphStyle:function(a,b){var c=b.position,e=a.position+a.length,f=[a],g=[b];a.position<=c&&c<=e?g=[]:e<c&&(b.position-=a.length+2);return{opSpecsA:f,opSpecsB:g}},SplitParagraph:function(a,b){var c=b.position,e=a.position+a.length,f=[a],g=[b];a.position<=c&&c<=e?(g=[],a.length+=1):(e<b.sourceParagraphPosition&&(b.sourceParagraphPosition-=a.length+2),e<c?b.position-=a.length+2:a.position+=1);return{opSpecsA:f,opSpecsB:g}},UpdateMember:e,UpdateMetadata:e,UpdateParagraphStyle:e},RemoveCursor:{RemoveCursor:function(a,
b){var c=a.memberid===b.memberid;return{opSpecsA:c?[]:[a],opSpecsB:c?[]:[b]}},RemoveMember:e,RemoveStyle:e,RemoveText:e,SetParagraphStyle:e,SplitParagraph:e,UpdateMember:e,UpdateMetadata:e,UpdateParagraphStyle:e},RemoveMember:{RemoveStyle:e,RemoveText:e,SetParagraphStyle:e,SplitParagraph:e,UpdateMetadata:e,UpdateParagraphStyle:e},RemoveStyle:{RemoveStyle:function(a,b){var c=a.styleName===b.styleName&&a.styleFamily===b.styleFamily;return{opSpecsA:c?[]:[a],opSpecsB:c?[]:[b]}},RemoveText:e,SetParagraphStyle:function(a,
b){var c,e=[a],f=[b];"paragraph"===a.styleFamily&&a.styleName===b.styleName&&(c={optype:"SetParagraphStyle",memberid:a.memberid,timestamp:a.timestamp,position:b.position,styleName:""},e.unshift(c),b.styleName="");return{opSpecsA:e,opSpecsB:f}},SplitParagraph:e,UpdateMember:e,UpdateMetadata:e,UpdateParagraphStyle:function(a,d){var e,f=[a],g=[d];"paragraph"===a.styleFamily&&(e=c(d.setProperties,a.styleName),0<e.length&&(e={optype:"UpdateParagraphStyle",memberid:a.memberid,timestamp:a.timestamp,styleName:d.styleName,
removedProperties:{attributes:e.join(",")}},f.unshift(e)),a.styleName===d.styleName?g=[]:b(d.setProperties,a.styleName));return{opSpecsA:f,opSpecsB:g}}},RemoveText:{RemoveText:function(a,b){var c=a.position+a.length,e=b.position+b.length,f=[a],g=[b];e<=a.position?a.position-=b.length:c<=b.position?b.position-=a.length:b.position<c&&(a.position<b.position?(a.length=e<c?a.length-b.length:b.position-a.position,c<e?(b.position=a.position,b.length=e-c):g=[]):(c<e?b.length-=a.length:b.position<a.position?
b.length=a.position-b.position:g=[],e<c?(a.position=b.position,a.length=c-e):f=[]));return{opSpecsA:f,opSpecsB:g}},SetParagraphStyle:function(a,b){a.position<b.position&&(b.position-=a.length);return{opSpecsA:[a],opSpecsB:[b]}},SplitParagraph:function(a,b){var c=a.position+a.length,e=[a],f=[b];b.position<=a.position?a.position+=1:b.position<c&&(a.length=b.position-a.position,c={optype:"RemoveText",memberid:a.memberid,timestamp:a.timestamp,position:b.position+1,length:c-b.position},e.unshift(c));a.position+
a.length<=b.position?b.position-=a.length:a.position<b.position&&(b.position=a.position);a.position+a.length<b.sourceParagraphPosition&&(b.sourceParagraphPosition-=a.length);return{opSpecsA:e,opSpecsB:f}},UpdateMember:e,UpdateMetadata:e,UpdateParagraphStyle:e},SetParagraphStyle:{SetParagraphStyle:function(a,b,c){a.position===b.position&&(c?b.styleName=a.styleName:a.styleName=b.styleName);return{opSpecsA:[a],opSpecsB:[b]}},SplitParagraph:function(a,b){var c=[a],e=[b],g;a.position>b.position?a.position+=
1:a.position===b.sourceParagraphPosition&&(b.paragraphStyleName=a.styleName,g=f(a),g.position=b.position+1,c.push(g));return{opSpecsA:c,opSpecsB:e}},UpdateMember:e,UpdateMetadata:e,UpdateParagraphStyle:e},SplitParagraph:{SplitParagraph:function(a,b,c){var e,f;a.position<b.position?e=!0:b.position<a.position?f=!0:a.position===b.position&&(c?e=!0:f=!0);e?(b.position+=1,b.sourceParagraphPosition=a.position<b.sourceParagraphPosition?b.sourceParagraphPosition+1:a.position+1):f&&(a.position+=1,a.sourceParagraphPosition=
b.position<b.sourceParagraphPosition?a.sourceParagraphPosition+1:b.position+1);return{opSpecsA:[a],opSpecsB:[b]}},UpdateMember:e,UpdateMetadata:e,UpdateParagraphStyle:e},UpdateMember:{UpdateMetadata:e,UpdateParagraphStyle:e},UpdateMetadata:{UpdateMetadata:function(a,b,c){var e,f=[a],g=[b];e=c?a:b;a=c?b:a;m(a.setProperties||null,a.removedProperties||null,e.setProperties||null,e.removedProperties||null);e.setProperties&&r(e.setProperties)||e.removedProperties&&p(e.removedProperties)||(c?f=[]:g=[]);
a.setProperties&&r(a.setProperties)||a.removedProperties&&p(a.removedProperties)||(c?g=[]:f=[]);return{opSpecsA:f,opSpecsB:g}},UpdateParagraphStyle:e},UpdateParagraphStyle:{UpdateParagraphStyle:function(a,b,c){var e,f=[a],g=[b];a.styleName===b.styleName&&(e=c?a:b,a=c?b:a,q(a.setProperties,a.removedProperties,e.setProperties,e.removedProperties,"style:paragraph-properties"),q(a.setProperties,a.removedProperties,e.setProperties,e.removedProperties,"style:text-properties"),m(a.setProperties||null,a.removedProperties||
null,e.setProperties||null,e.removedProperties||null),e.setProperties&&r(e.setProperties)||e.removedProperties&&p(e.removedProperties)||(c?f=[]:g=[]),a.setProperties&&r(a.setProperties)||a.removedProperties&&p(a.removedProperties)||(c?g=[]:f=[]));return{opSpecsA:f,opSpecsB:g}}}};this.passUnchanged=e;this.extendTransformations=function(a){Object.keys(a).forEach(function(b){var c=a[b],e,f=l.hasOwnProperty(b);runtime.log((f?"Extending":"Adding")+" map for optypeA: "+b);f||(l[b]={});e=l[b];Object.keys(c).forEach(function(a){var f=
e.hasOwnProperty(a);runtime.BrowserRuntime$assert(b<=a,"Wrong order:"+b+", "+a);runtime.log("  "+(f?"Overwriting":"Adding")+" entry for optypeB: "+a);e[a]=c[a]})})};this.transformOpspecVsOpspec=function(a,b){var c=a.optype<=b.optype,e;runtime.log("Crosstransforming:");runtime.log(runtime.BrowserRuntime$toJson(a));runtime.log(runtime.BrowserRuntime$toJson(b));c||(e=a,a=b,b=e);(e=(e=l[a.optype])&&e[b.optype])?(e=e(a,b,!c),!c&&e&&(e={opSpecsA:e.opSpecsB,opSpecsB:e.opSpecsA})):e=null;runtime.log("result:");
e?(runtime.log(runtime.BrowserRuntime$toJson(e.opSpecsA)),runtime.log(runtime.BrowserRuntime$toJson(e.opSpecsB))):runtime.log("null");return e}};
ops.OperationTransformer=function(){function g(c,b){for(var f,m,r=[],p=[];0<c.length&&b;){f=c.shift();f=h.transformOpspecVsOpspec(f,b);if(!f)return null;r=r.concat(f.opSpecsA);if(!f.opSpecsB.length){r=r.concat(c);b=null;break}for(;1<f.opSpecsB.length;){m=g(c,f.opSpecsB.shift());if(!m)return null;p=p.concat(m.opSpecsB);c=m.opSpecsA}b=f.opSpecsB.pop()}b&&p.push(b);return{opSpecsA:r,opSpecsB:p}}var h=new ops.OperationTransformMatrix;this.getOperationTransformMatrix=function(){return h};this.ops_OperationTransformer$transform=
function(c,b){for(var f,h=[];0<b.length;){f=g(c,b.shift());if(!f)return null;c=f.opSpecsA;h=h.concat(f.opSpecsB)}return{opSpecsA:c,opSpecsB:h}}};var webodf_css='@namespace draw url(urn:oasis:names:tc:opendocument:xmlns:drawing:1.0);@namespace fo url(urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0);@namespace office url(urn:oasis:names:tc:opendocument:xmlns:office:1.0);@namespace presentation url(urn:oasis:names:tc:opendocument:xmlns:presentation:1.0);@namespace style url(urn:oasis:names:tc:opendocument:xmlns:style:1.0);@namespace svg url(urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0);@namespace table url(urn:oasis:names:tc:opendocument:xmlns:table:1.0);@namespace text url(urn:oasis:names:tc:opendocument:xmlns:text:1.0);@namespace webodfhelper url(urn:webodf:names:helper);@namespace cursor url(urn:webodf:names:cursor);@namespace editinfo url(urn:webodf:names:editinfo);@namespace annotation url(urn:webodf:names:annotation);@namespace dc url(http://purl.org/dc/elements/1.1/);@namespace svgns url(http://www.w3.org/2000/svg);office|document > *, office|document-content > * {display: none;}office|body, office|document {display: inline-block;position: relative;}text|p, text|h {display: block;padding: 0;margin: 0;line-height: normal;position: relative;}text|p::after, text|h::after {content: "\\200B";white-space: pre;}*[webodfhelper|containsparagraphanchor] {position: relative;}text|s {white-space: pre;}text|tab {display: inline;white-space: pre;}text|tracked-changes {display: none;}office|binary-data {display: none;}office|text {display: block;text-align: left;overflow: visible;word-wrap: break-word;}office|text::selection {background: transparent;}.webodf-virtualSelections *::selection {background: transparent;}.webodf-virtualSelections *::-moz-selection {background: transparent;}office|text * draw|text-box {display: block;border: 1px solid #d3d3d3;}office|text draw|frame {z-index: 1;}office|spreadsheet {display: block;border-collapse: collapse;empty-cells: show;font-family: sans-serif;font-size: 10pt;text-align: left;page-break-inside: avoid;overflow: hidden;}office|presentation {display: inline-block;text-align: left;}#shadowContent {display: inline-block;text-align: left;}draw|page {display: block;position: relative;overflow: hidden;}presentation|notes, presentation|footer-decl, presentation|date-time-decl {display: none;}@media print {draw|page {border: 1pt solid black;page-break-inside: avoid;}presentation|notes {}}office|spreadsheet text|p {border: 0px;padding: 1px;margin: 0px;}office|spreadsheet table|table {margin: 3px;}office|spreadsheet table|table:after {}office|spreadsheet table|table-row {counter-increment: row;}office|spreadsheet table|table-row:before {width: 3em;background: #cccccc;border: 1px solid black;text-align: center;content: counter(row);display: table-cell;}office|spreadsheet table|table-cell {border: 1px solid #cccccc;}table|table {display: table;}draw|frame table|table {width: 100%;height: 100%;background: white;}table|table-header-rows {display: table-header-group;}table|table-row {display: table-row;}table|table-column {display: table-column;}table|table-cell {width: 0.889in;display: table-cell;word-break: break-all;}draw|frame {display: block;}draw|image {display: block;width: 100%;height: 100%;top: 0px;left: 0px;background-repeat: no-repeat;background-size: 100% 100%;-moz-background-size: 100% 100%;}draw|frame > draw|image:nth-of-type(n+2) {display: none;}text|list:before {display: none;content:"";}text|list {display: block;}text|list-item {display: block;}text|number {display:none;}text|a {color: blue;text-decoration: underline;cursor: pointer;}.webodf-inactiveLinks text|a {cursor: text;}text|note-citation {vertical-align: super;font-size: smaller;}text|note-body {display: none;}text|note:hover text|note-citation {background: #dddddd;}text|note:hover text|note-body {display: block;left:1em;max-width: 80%;position: absolute;background: #ffffaa;}text|bibliography-source {display: none;}svg|title, svg|desc {display: none;}video {width: 100%;height: 100%}cursor|anchor {display: none;}cursor|cursor {display: none;}.webodf-caretOverlay {position: absolute;top: 5%;height: 1em;z-index: 10;padding-left: 1px;pointer-events: none;}.webodf-caretOverlay .caret {position: absolute;border-left: 2px solid black;top: 0;bottom: 0;right: 0;}.webodf-caretOverlay .handle {position: absolute;margin-top: 5px;padding-top: 3px;margin-left: auto;margin-right: auto;width: 64px;height: 68px;border-radius: 5px;opacity: 0.3;text-align: center;background-color: black;box-shadow: 0px 0px 5px rgb(90, 90, 90);border: 1px solid black;top: -85px;right: -32px;}.webodf-caretOverlay .handle > img {box-shadow: 0px 0px 5px rgb(90, 90, 90) inset;background-color: rgb(200, 200, 200);border-radius: 5px;border: 2px solid;height: 60px;width: 60px;display: block;margin: auto;}.webodf-caretOverlay .handle.active {opacity: 0.8;}.webodf-caretOverlay .handle:after {content: " ";position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: black transparent transparent transparent;top: 100%;left: 43%;}.webodf-caretSizer {display: inline-block;width: 0;visibility: hidden;}#eventTrap {display: block;position: absolute;bottom: 0;left: 0;outline: none;opacity: 0;color: rgba(255, 255, 255, 0);pointer-events: none;white-space: pre;overflow: hidden;}cursor|cursor > #composer {text-decoration: underline;}cursor|cursor[cursor|caret-sizer-active="true"],cursor|cursor[cursor|composing="true"] {display: inline;}editinfo|editinfo {display: inline-block;}.editInfoMarker {position: absolute;width: 10px;height: 100%;left: -20px;opacity: 0.8;top: 0;border-radius: 5px;background-color: transparent;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);}.editInfoMarker:hover {box-shadow: 0px 0px 8px rgba(0, 0, 0, 1);}.editInfoHandle {position: absolute;background-color: black;padding: 5px;border-radius: 5px;opacity: 0.8;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);bottom: 100%;margin-bottom: 10px;z-index: 3;left: -25px;}.editInfoHandle:after {content: " ";position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: black transparent transparent transparent;top: 100%;left: 5px;}.editInfo {font-family: sans-serif;font-weight: normal;font-style: normal;text-decoration: none;color: white;width: 100%;height: 12pt;}.editInfoColor {float: left;width: 10pt;height: 10pt;border: 1px solid white;}.editInfoAuthor {float: left;margin-left: 5pt;font-size: 10pt;text-align: left;height: 12pt;line-height: 12pt;}.editInfoTime {float: right;margin-left: 30pt;font-size: 8pt;font-style: italic;color: yellow;height: 12pt;line-height: 12pt;}.annotationWrapper {display: inline;position: relative;}.annotationRemoveButton:before {content: "\u00d7";color: white;padding: 5px;line-height: 1em;}.annotationRemoveButton {width: 20px;height: 20px;border-radius: 10px;background-color: black;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);position: absolute;top: -10px;left: -10px;z-index: 3;text-align: center;font-family: sans-serif;font-style: normal;font-weight: normal;text-decoration: none;font-size: 15px;}.annotationRemoveButton:hover {cursor: pointer;box-shadow: 0px 0px 5px rgba(0, 0, 0, 1);}.annotationNote {width: 4cm;position: absolute;display: inline;z-index: 10;top: 0;}.annotationNote > office|annotation {display: block;text-align: left;}.annotationConnector {position: absolute;display: inline;top: 0;z-index: 2;border-top: 1px dashed brown;}.annotationConnector.angular {-moz-transform-origin: left top;-webkit-transform-origin: left top;-ms-transform-origin: left top;transform-origin: left top;}.annotationConnector.horizontal {left: 0;}.annotationConnector.horizontal:before {content: "";display: inline;position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: brown transparent transparent transparent;top: -1px;left: -5px;}office|annotation {width: 100%;height: 100%;display: none;background: rgb(198, 238, 184);background: -moz-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -webkit-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -o-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -ms-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: linear-gradient(180deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);box-shadow: 0 3px 4px -3px #ccc;}office|annotation > dc|creator {display: block;font-size: 10pt;font-weight: normal;font-style: normal;font-family: sans-serif;color: white;background-color: brown;padding: 4px;}office|annotation > dc|date {display: block;font-size: 10pt;font-weight: normal;font-style: normal;font-family: sans-serif;border: 4px solid transparent;color: black;}office|annotation > text|list {display: block;padding: 5px;}office|annotation text|p {font-size: 10pt;color: black;font-weight: normal;font-style: normal;text-decoration: none;font-family: sans-serif;}#annotationsPane {background-color: #EAEAEA;width: 4cm;height: 100%;display: none;position: absolute;outline: 1px solid #ccc;}.webodf-annotationHighlight {background-color: yellow;position: relative;}.webodf-selectionOverlay {position: absolute;pointer-events: none;top: 0;left: 0;top: 0;left: 0;width: 100%;height: 100%;z-index: 15;}.webodf-selectionOverlay > polygon {fill-opacity: 0.3;stroke-opacity: 0.8;stroke-width: 1;fill-rule: evenodd;}.webodf-selectionOverlay > .webodf-draggable {fill-opacity: 0.8;stroke-opacity: 0;stroke-width: 8;pointer-events: all;display: none;-moz-transform-origin: center center;-webkit-transform-origin: center center;-ms-transform-origin: center center;transform-origin: center center;}#imageSelector {display: none;position: absolute;border-style: solid;border-color: black;}#imageSelector > div {width: 5px;height: 5px;display: block;position: absolute;border: 1px solid black;background-color: #ffffff;}#imageSelector > .topLeft {top: -4px;left: -4px;}#imageSelector > .topRight {top: -4px;right: -4px;}#imageSelector > .bottomRight {right: -4px;bottom: -4px;}#imageSelector > .bottomLeft {bottom: -4px;left: -4px;}#imageSelector > .topMiddle {top: -4px;left: 50%;margin-left: -2.5px;}#imageSelector > .rightMiddle {top: 50%;right: -4px;margin-top: -2.5px;}#imageSelector > .bottomMiddle {bottom: -4px;left: 50%;margin-left: -2.5px;}#imageSelector > .leftMiddle {top: 50%;left: -4px;margin-top: -2.5px;}div.webodf-customScrollbars::-webkit-scrollbar{width: 8px;height: 8px;background-color: transparent;}div.webodf-customScrollbars::-webkit-scrollbar-track{background-color: transparent;}div.webodf-customScrollbars::-webkit-scrollbar-thumb{background-color: #444;border-radius: 4px;}.webodf-hyperlinkTooltip {display: none;color: white;background-color: black;border-radius: 5px;box-shadow: 2px 2px 5px gray;padding: 3px;position: absolute;max-width: 210px;text-align: left;word-break: break-all;z-index: 16;}.webodf-hyperlinkTooltipText {display: block;font-weight: bold;}';/*

 @licstart
JSZip - A Javascript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2014 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/master/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/master/LICENSE
 @licend
*/
!function(e){var globalScope=typeof window!=="undefined"?window:typeof global!=="undefined"?global:{},externs=globalScope.externs||(globalScope.externs={});externs.JSZip=e()}(function(){var define,module,exports;if(define||module||exports)console.log("");return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'");}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=
t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){var _keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";exports.encode=function(input,utf8){var output="";var chr1,chr2,chr3,enc1,enc2,enc3,enc4;var i=0;while(i<input.length){chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=(chr1&3)<<
4|chr2>>4;enc3=(chr2&15)<<2|chr3>>6;enc4=chr3&63;if(isNaN(chr2))enc3=enc4=64;else if(isNaN(chr3))enc4=64;output=output+_keyStr.charAt(enc1)+_keyStr.charAt(enc2)+_keyStr.charAt(enc3)+_keyStr.charAt(enc4)}return output};exports.decode=function(input,utf8){var output="";var chr1,chr2,chr3;var enc1,enc2,enc3,enc4;var i=0;input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(i<input.length){enc1=_keyStr.indexOf(input.charAt(i++));enc2=_keyStr.indexOf(input.charAt(i++));enc3=_keyStr.indexOf(input.charAt(i++));
enc4=_keyStr.indexOf(input.charAt(i++));chr1=enc1<<2|enc2>>4;chr2=(enc2&15)<<4|enc3>>2;chr3=(enc3&3)<<6|enc4;output=output+String.fromCharCode(chr1);if(enc3!=64)output=output+String.fromCharCode(chr2);if(enc4!=64)output=output+String.fromCharCode(chr3)}return output}},{}],2:[function(_dereq_,module,exports){function CompressedObject(){this.compressedSize=0;this.uncompressedSize=0;this.crc32=0;this.compressionMethod=null;this.compressedContent=null}CompressedObject.prototype={getContent:function(){return null},
getCompressedContent:function(){return null}};module.exports=CompressedObject},{}],3:[function(_dereq_,module,exports){exports.STORE={magic:"\x00\x00",compress:function(content){return content},uncompress:function(content){return content},compressInputType:null,uncompressInputType:null};exports.DEFLATE=_dereq_("./flate")},{"./flate":8}],4:[function(_dereq_,module,exports){var utils=_dereq_("./utils");var table=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,
2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,
671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,
3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,
426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,
3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,
3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];module.exports=function crc32(input,crc){if(typeof input==="undefined"||!input.length)return 0;var isArray=utils.getTypeOf(input)!=="string";if(typeof crc=="undefined")crc=0;var x=0;var y=0;var b=0;crc=crc^-1;for(var i=0,iTop=input.length;i<iTop;i++){b=isArray?input[i]:input.charCodeAt(i);y=(crc^b)&255;x=table[y];crc=crc>>>8^x}return crc^-1}},{"./utils":21}],5:[function(_dereq_,
module,exports){var utils=_dereq_("./utils");function DataReader(data){this.data=null;this.length=0;this.index=0}DataReader.prototype={checkOffset:function(offset){this.checkIndex(this.index+offset)},checkIndex:function(newIndex){if(this.length<newIndex||newIndex<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+newIndex+"). Corrupted zip ?");},setIndex:function(newIndex){this.checkIndex(newIndex);this.index=newIndex},skip:function(n){this.setIndex(this.index+
n)},byteAt:function(i){},readInt:function(size){var result=0,i;this.checkOffset(size);for(i=this.index+size-1;i>=this.index;i--)result=(result<<8)+this.byteAt(i);this.index+=size;return result},readString:function(size){return utils.transformTo("string",this.readData(size))},readData:function(size){},lastIndexOfSignature:function(sig){},readDate:function(){var dostime=this.readInt(4);return new Date((dostime>>25&127)+1980,(dostime>>21&15)-1,dostime>>16&31,dostime>>11&31,dostime>>5&63,(dostime&31)<<
1)}};module.exports=DataReader},{"./utils":21}],6:[function(_dereq_,module,exports){exports.base64=false;exports.binary=false;exports.dir=false;exports.createFolders=false;exports.date=null;exports.compression=null;exports.comment=null},{}],7:[function(_dereq_,module,exports){var utils=_dereq_("./utils");exports.string2binary=function(str){return utils.string2binary(str)};exports.string2Uint8Array=function(str){return utils.transformTo("uint8array",str)};exports.uint8Array2String=function(array){return utils.transformTo("string",
array)};exports.string2Blob=function(str){var buffer=utils.transformTo("arraybuffer",str);return utils.arrayBuffer2Blob(buffer)};exports.arrayBuffer2Blob=function(buffer){return utils.arrayBuffer2Blob(buffer)};exports.transformTo=function(outputType,input){return utils.transformTo(outputType,input)};exports.getTypeOf=function(input){return utils.getTypeOf(input)};exports.checkSupport=function(type){return utils.checkSupport(type)};exports.MAX_VALUE_16BITS=utils.MAX_VALUE_16BITS;exports.MAX_VALUE_32BITS=
utils.MAX_VALUE_32BITS;exports.pretty=function(str){return utils.pretty(str)};exports.findCompression=function(compressionMethod){return utils.findCompression(compressionMethod)};exports.isRegExp=function(object){return utils.isRegExp(object)}},{"./utils":21}],8:[function(_dereq_,module,exports){var USE_TYPEDARRAY=typeof Uint8Array!=="undefined"&&typeof Uint16Array!=="undefined"&&typeof Uint32Array!=="undefined";var pako=_dereq_("pako");exports.uncompressInputType=USE_TYPEDARRAY?"uint8array":"array";
exports.compressInputType=USE_TYPEDARRAY?"uint8array":"array";exports.magic="\b\x00";exports.compress=function(input){return pako.deflateRaw(input)};exports.uncompress=function(input){return pako.inflateRaw(input)}},{"pako":24}],9:[function(_dereq_,module,exports){var base64=_dereq_("./base64");function JSZip(data,options){if(!(this instanceof JSZip))return new JSZip(data,options);this.files={};this.comment=null;this.root="";if(data)this.load(data,options);this.clone=function(){var newObj=new JSZip;
for(var i in this)if(typeof this[i]!=="function")newObj[i]=this[i];return newObj}}JSZip.prototype=_dereq_("./object");JSZip.prototype.load=_dereq_("./load");JSZip.support=_dereq_("./support");JSZip.defaults=_dereq_("./defaults");JSZip.utils=_dereq_("./deprecatedPublicUtils");JSZip.base64={encode:function(input){return base64.encode(input)},decode:function(input){return base64.decode(input)}};JSZip.compressions=_dereq_("./compressions");module.exports=JSZip},{"./base64":1,"./compressions":3,"./defaults":6,
"./deprecatedPublicUtils":7,"./load":10,"./object":13,"./support":17}],10:[function(_dereq_,module,exports){var base64=_dereq_("./base64");var ZipEntries=_dereq_("./zipEntries");module.exports=function(data,options){var files,zipEntries,i,input;options=options||{};if(options.base64)data=base64.decode(data);zipEntries=new ZipEntries(data,options);files=zipEntries.files;for(i=0;i<files.length;i++){input=files[i];this.file(input.fileName,input.decompressed,{binary:true,optimizedBinaryString:true,date:input.date,
dir:input.dir,comment:input.fileComment.length?input.fileComment:null,createFolders:options.createFolders})}if(zipEntries.zipComment.length)this.comment=zipEntries.zipComment;return this}},{"./base64":1,"./zipEntries":22}],11:[function(_dereq_,module,exports){(function(Buffer){module.exports=function(data,encoding){return new Buffer(data,encoding)};module.exports.test=function(b){return Buffer.isBuffer(b)}}).call(this,typeof Buffer!=="undefined"?Buffer:undefined)},{}],12:[function(_dereq_,module,
exports){var Uint8ArrayReader=_dereq_("./uint8ArrayReader");function NodeBufferReader(data){this.data=data;this.length=this.data.length;this.index=0}NodeBufferReader.prototype=new Uint8ArrayReader;NodeBufferReader.prototype.readData=function(size){this.checkOffset(size);var result=this.data.slice(this.index,this.index+size);this.index+=size;return result};module.exports=NodeBufferReader},{"./uint8ArrayReader":18}],13:[function(_dereq_,module,exports){var support=_dereq_("./support");var utils=_dereq_("./utils");
var crc32=_dereq_("./crc32");var signature=_dereq_("./signature");var defaults=_dereq_("./defaults");var base64=_dereq_("./base64");var compressions=_dereq_("./compressions");var CompressedObject=_dereq_("./compressedObject");var nodeBuffer=_dereq_("./nodeBuffer");var utf8=_dereq_("./utf8");var StringWriter=_dereq_("./stringWriter");var Uint8ArrayWriter=_dereq_("./uint8ArrayWriter");var getRawData=function(file){if(file._data instanceof CompressedObject){file._data=file._data.getContent();file.options.binary=
true;file.options.base64=false;if(utils.getTypeOf(file._data)==="uint8array"){var copy=file._data;file._data=new Uint8Array(copy.length);if(copy.length!==0)file._data.set(copy,0)}}return file._data};var getBinaryData=function(file){var result=getRawData(file),type=utils.getTypeOf(result);if(type==="string"){if(!file.options.binary)if(support.nodebuffer)return nodeBuffer(result,"utf-8");return file.asBinary()}return result};var dataToString=function(asUTF8){var result=getRawData(this);if(result===
null||typeof result==="undefined")return"";if(this.options.base64)result=base64.decode(result);if(asUTF8&&this.options.binary)result=out.utf8decode(result);else result=utils.transformTo("string",result);if(!asUTF8&&!this.options.binary)result=utils.transformTo("string",out.utf8encode(result));return result};var ZipObject=function(name,data,options){this.name=name;this.dir=options.dir;this.date=options.date;this.comment=options.comment;this._data=data;this.options=options;this._initialMetadata={dir:options.dir,
date:options.date}};ZipObject.prototype={asText:function(){return dataToString.call(this,true)},asBinary:function(){return dataToString.call(this,false)},asNodeBuffer:function(){var result=getBinaryData(this);return utils.transformTo("nodebuffer",result)},asUint8Array:function(){var result=getBinaryData(this);return utils.transformTo("uint8array",result)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var decToHex=function(dec,bytes){var hex="",i;for(i=0;i<bytes;i++){hex+=String.fromCharCode(dec&
255);dec=dec>>>8}return hex};var extend=function(){var result={},i,attr;for(i=0;i<arguments.length;i++)for(attr in arguments[i])if(arguments[i].hasOwnProperty(attr)&&typeof result[attr]==="undefined")result[attr]=arguments[i][attr];return result};var prepareFileAttrs=function(o){o=o||{};if(o.base64===true&&(o.binary===null||o.binary===undefined))o.binary=true;o=extend(o,defaults);o.date=o.date||new Date;if(o.compression!==null)o.compression=o.compression.toUpperCase();return o};var fileAdd=function(name,
data,o){var dataType=utils.getTypeOf(data),parent;o=prepareFileAttrs(o);if(o.createFolders&&(parent=parentFolder(name)))folderAdd.call(this,parent,true);if(o.dir||data===null||typeof data==="undefined"){o.base64=false;o.binary=false;data=null}else if(dataType==="string"){if(o.binary&&!o.base64)if(o.optimizedBinaryString!==true)data=utils.string2binary(data)}else{o.base64=false;o.binary=true;if(!dataType&&!(data instanceof CompressedObject))throw new Error("The data of '"+name+"' is in an unsupported format !");
if(dataType==="arraybuffer")data=utils.transformTo("uint8array",data)}var object=new ZipObject(name,data,o);this.files[name]=object;return object};var parentFolder=function(path){if(path.slice(-1)=="/")path=path.substring(0,path.length-1);var lastSlash=path.lastIndexOf("/");return lastSlash>0?path.substring(0,lastSlash):""};var folderAdd=function(name,createFolders){if(name.slice(-1)!="/")name+="/";createFolders=typeof createFolders!=="undefined"?createFolders:false;if(!this.files[name])fileAdd.call(this,
name,null,{dir:true,createFolders:createFolders});return this.files[name]};var generateCompressedObjectFrom=function(file,compression){var result=new CompressedObject,content;if(file._data instanceof CompressedObject){result.uncompressedSize=file._data.uncompressedSize;result.crc32=file._data.crc32;if(result.uncompressedSize===0||file.dir){compression=compressions["STORE"];result.compressedContent="";result.crc32=0}else if(file._data.compressionMethod===compression.magic)result.compressedContent=
file._data.getCompressedContent();else{content=file._data.getContent();result.compressedContent=compression.compress(utils.transformTo(compression.compressInputType,content))}}else{content=getBinaryData(file);if(!content||content.length===0||file.dir){compression=compressions["STORE"];content=""}result.uncompressedSize=content.length;result.crc32=crc32(content);result.compressedContent=compression.compress(utils.transformTo(compression.compressInputType,content))}result.compressedSize=result.compressedContent.length;
result.compressionMethod=compression.magic;return result};var generateZipParts=function(name,file,compressedObject,offset){var utfEncodedFileName=utils.transformTo("string",utf8.utf8encode(file.name)),comment=file.comment||"",utfEncodedComment=utils.transformTo("string",utf8.utf8encode(comment)),useUTF8ForFileName=utfEncodedFileName.length!==file.name.length,useUTF8ForComment=utfEncodedComment.length!==comment.length,o=file.options,dosTime,dosDate,extraFields="",unicodePathExtraField="",unicodeCommentExtraField=
"",dir,date;if(file._initialMetadata.dir!==file.dir)dir=file.dir;else dir=o.dir;if(file._initialMetadata.date!==file.date)date=file.date;else date=o.date;dosTime=date.getHours();dosTime=dosTime<<6;dosTime=dosTime|date.getMinutes();dosTime=dosTime<<5;dosTime=dosTime|date.getSeconds()/2;dosDate=date.getFullYear()-1980;dosDate=dosDate<<4;dosDate=dosDate|date.getMonth()+1;dosDate=dosDate<<5;dosDate=dosDate|date.getDate();if(useUTF8ForFileName){unicodePathExtraField=decToHex(1,1)+decToHex(crc32(utfEncodedFileName),
4)+utfEncodedFileName;extraFields+="up"+decToHex(unicodePathExtraField.length,2)+unicodePathExtraField}if(useUTF8ForComment){unicodeCommentExtraField=decToHex(1,1)+decToHex(this.crc32(utfEncodedComment),4)+utfEncodedComment;extraFields+="uc"+decToHex(unicodeCommentExtraField.length,2)+unicodeCommentExtraField}var header="";header+="\n\x00";header+=useUTF8ForFileName||useUTF8ForComment?"\x00\b":"\x00\x00";header+=compressedObject.compressionMethod;header+=decToHex(dosTime,2);header+=decToHex(dosDate,
2);header+=decToHex(compressedObject.crc32,4);header+=decToHex(compressedObject.compressedSize,4);header+=decToHex(compressedObject.uncompressedSize,4);header+=decToHex(utfEncodedFileName.length,2);header+=decToHex(extraFields.length,2);var fileRecord=signature.LOCAL_FILE_HEADER+header+utfEncodedFileName+extraFields;var dirRecord=signature.CENTRAL_FILE_HEADER+"\u0014\x00"+header+decToHex(utfEncodedComment.length,2)+"\x00\x00"+"\x00\x00"+(dir===true?"\u0010\x00\x00\x00":"\x00\x00\x00\x00")+decToHex(offset,
4)+utfEncodedFileName+extraFields+utfEncodedComment;return{fileRecord:fileRecord,dirRecord:dirRecord,compressedObject:compressedObject}};var out={load:function(stream,options){throw new Error("Load method is not defined. Is the file jszip-load.js included ?");},filter:function(search){var result=[],filename,relativePath,file,fileClone;for(filename in this.files){if(!this.files.hasOwnProperty(filename))continue;file=this.files[filename];fileClone=new ZipObject(file.name,file._data,extend(file.options));
relativePath=filename.slice(this.root.length,filename.length);if(filename.slice(0,this.root.length)===this.root&&search(relativePath,fileClone))result.push(fileClone)}return result},file:function(name,data,o){if(arguments.length===1)if(utils.isRegExp(name)){var regexp=name;return this.filter(function(relativePath,file){return!file.dir&&regexp.test(relativePath)})}else return this.filter(function(relativePath,file){return!file.dir&&relativePath===name})[0]||null;else{name=this.root+name;fileAdd.call(this,
name,data,o)}return this},folder:function(arg){if(!arg)return this;if(utils.isRegExp(arg))return this.filter(function(relativePath,file){return file.dir&&arg.test(relativePath)});var name=this.root+arg;var newFolder=folderAdd.call(this,name);var ret=this.clone();ret.root=newFolder.name;return ret},remove:function(name){name=this.root+name;var file=this.files[name];if(!file){if(name.slice(-1)!="/")name+="/";file=this.files[name]}if(file&&!file.dir)delete this.files[name];else{var kids=this.filter(function(relativePath,
file){return file.name.slice(0,name.length)===name});for(var i=0;i<kids.length;i++)delete this.files[kids[i].name]}return this},generate:function(options){options=extend(options||{},{base64:true,compression:"STORE",type:"base64",comment:null});utils.checkSupport(options.type);var zipData=[],localDirLength=0,centralDirLength=0,writer,i,utfEncodedComment=utils.transformTo("string",this.utf8encode(options.comment||this.comment||""));for(var name in this.files){if(!this.files.hasOwnProperty(name))continue;
var file=this.files[name];var compressionName=file.options.compression||options.compression.toUpperCase();var compression=compressions[compressionName];if(!compression)throw new Error(compressionName+" is not a valid compression method !");var compressedObject=generateCompressedObjectFrom.call(this,file,compression);var zipPart=generateZipParts.call(this,name,file,compressedObject,localDirLength);localDirLength+=zipPart.fileRecord.length+compressedObject.compressedSize;centralDirLength+=zipPart.dirRecord.length;
zipData.push(zipPart)}var dirEnd="";dirEnd=signature.CENTRAL_DIRECTORY_END+"\x00\x00"+"\x00\x00"+decToHex(zipData.length,2)+decToHex(zipData.length,2)+decToHex(centralDirLength,4)+decToHex(localDirLength,4)+decToHex(utfEncodedComment.length,2)+utfEncodedComment;var typeName=options.type.toLowerCase();if(typeName==="uint8array"||typeName==="arraybuffer"||typeName==="blob"||typeName==="nodebuffer")writer=new Uint8ArrayWriter(localDirLength+centralDirLength+dirEnd.length);else writer=new StringWriter(localDirLength+
centralDirLength+dirEnd.length);for(i=0;i<zipData.length;i++){writer.append(zipData[i].fileRecord);writer.append(zipData[i].compressedObject.compressedContent)}for(i=0;i<zipData.length;i++)writer.append(zipData[i].dirRecord);writer.append(dirEnd);var zip=writer.finalize();switch(options.type.toLowerCase()){case "uint8array":case "arraybuffer":case "nodebuffer":return utils.transformTo(options.type.toLowerCase(),zip);case "blob":return utils.arrayBuffer2Blob(utils.transformTo("arraybuffer",zip));case "base64":return options.base64?
base64.encode(zip):zip;default:return zip}},crc32:function(input,crc){return crc32(input,crc)},utf8encode:function(string){return utils.transformTo("string",utf8.utf8encode(string))},utf8decode:function(input){return utf8.utf8decode(input)}};module.exports=out},{"./base64":1,"./compressedObject":2,"./compressions":3,"./crc32":4,"./defaults":6,"./nodeBuffer":11,"./signature":14,"./stringWriter":16,"./support":17,"./uint8ArrayWriter":19,"./utf8":20,"./utils":21}],14:[function(_dereq_,module,exports){exports.LOCAL_FILE_HEADER=
"PK\u0003\u0004";exports.CENTRAL_FILE_HEADER="PK\u0001\u0002";exports.CENTRAL_DIRECTORY_END="PK\u0005\u0006";exports.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\u0006\u0007";exports.ZIP64_CENTRAL_DIRECTORY_END="PK\u0006\u0006";exports.DATA_DESCRIPTOR="PK\u0007\b"},{}],15:[function(_dereq_,module,exports){var DataReader=_dereq_("./dataReader");var utils=_dereq_("./utils");function StringReader(data,optimizedBinaryString){this.data=data;if(!optimizedBinaryString)this.data=utils.string2binary(this.data);this.length=
this.data.length;this.index=0}StringReader.prototype=new DataReader;StringReader.prototype.byteAt=function(i){return this.data.charCodeAt(i)};StringReader.prototype.lastIndexOfSignature=function(sig){return this.data.lastIndexOf(sig)};StringReader.prototype.readData=function(size){this.checkOffset(size);var result=this.data.slice(this.index,this.index+size);this.index+=size;return result};module.exports=StringReader},{"./dataReader":5,"./utils":21}],16:[function(_dereq_,module,exports){var utils=
_dereq_("./utils");var StringWriter=function(){this.data=[]};StringWriter.prototype={append:function(input){input=utils.transformTo("string",input);this.data.push(input)},finalize:function(){return this.data.join("")}};module.exports=StringWriter},{"./utils":21}],17:[function(_dereq_,module,exports){(function(Buffer){exports.base64=true;exports.array=true;exports.string=true;exports.arraybuffer=typeof ArrayBuffer!=="undefined"&&typeof Uint8Array!=="undefined";exports.nodebuffer=typeof Buffer!=="undefined";
exports.uint8array=typeof Uint8Array!=="undefined";if(typeof ArrayBuffer==="undefined")exports.blob=false;else{var buffer=new ArrayBuffer(0);try{exports.blob=(new Blob([buffer],{type:"application/zip"})).size===0}catch(e$8){try{var Builder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;var builder=new Builder;builder.append(buffer);exports.blob=builder.getBlob("application/zip").size===0}catch(e){exports.blob=false}}}}).call(this,typeof Buffer!=="undefined"?
Buffer:undefined)},{}],18:[function(_dereq_,module,exports){var DataReader=_dereq_("./dataReader");function Uint8ArrayReader(data){if(data){this.data=data;this.length=this.data.length;this.index=0}}Uint8ArrayReader.prototype=new DataReader;Uint8ArrayReader.prototype.byteAt=function(i){return this.data[i]};Uint8ArrayReader.prototype.lastIndexOfSignature=function(sig){var sig0=sig.charCodeAt(0),sig1=sig.charCodeAt(1),sig2=sig.charCodeAt(2),sig3=sig.charCodeAt(3);for(var i=this.length-4;i>=0;--i)if(this.data[i]===
sig0&&this.data[i+1]===sig1&&this.data[i+2]===sig2&&this.data[i+3]===sig3)return i;return-1};Uint8ArrayReader.prototype.readData=function(size){this.checkOffset(size);if(size===0)return new Uint8Array(0);var result=this.data.subarray(this.index,this.index+size);this.index+=size;return result};module.exports=Uint8ArrayReader},{"./dataReader":5}],19:[function(_dereq_,module,exports){var utils=_dereq_("./utils");var Uint8ArrayWriter=function(length){this.data=new Uint8Array(length);this.index=0};Uint8ArrayWriter.prototype=
{append:function(input){if(input.length!==0){input=utils.transformTo("uint8array",input);this.data.set(input,this.index);this.index+=input.length}},finalize:function(){return this.data}};module.exports=Uint8ArrayWriter},{"./utils":21}],20:[function(_dereq_,module,exports){var utils=_dereq_("./utils");var support=_dereq_("./support");var nodeBuffer=_dereq_("./nodeBuffer");var _utf8len=new Array(256);for(var i=0;i<256;i++)_utf8len[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;_utf8len[254]=_utf8len[254]=
1;var string2buf=function(str){var buf,c,c2,m_pos,i,str_len=str.length,buf_len=0;for(m_pos=0;m_pos<str_len;m_pos++){c=str.charCodeAt(m_pos);if((c&64512)===55296&&m_pos+1<str_len){c2=str.charCodeAt(m_pos+1);if((c2&64512)===56320){c=65536+(c-55296<<10)+(c2-56320);m_pos++}}buf_len+=c<128?1:c<2048?2:c<65536?3:4}if(support.uint8array)buf=new Uint8Array(buf_len);else buf=new Array(buf_len);for(i=0,m_pos=0;i<buf_len;m_pos++){c=str.charCodeAt(m_pos);if((c&64512)===55296&&m_pos+1<str_len){c2=str.charCodeAt(m_pos+
1);if((c2&64512)===56320){c=65536+(c-55296<<10)+(c2-56320);m_pos++}}if(c<128)buf[i++]=c;else if(c<2048){buf[i++]=192|c>>>6;buf[i++]=128|c&63}else if(c<65536){buf[i++]=224|c>>>12;buf[i++]=128|c>>>6&63;buf[i++]=128|c&63}else{buf[i++]=240|c>>>18;buf[i++]=128|c>>>12&63;buf[i++]=128|c>>>6&63;buf[i++]=128|c&63}}return buf};var utf8border=function(buf,max){var pos;max=max||buf.length;if(max>buf.length)max=buf.length;pos=max-1;while(pos>=0&&(buf[pos]&192)===128)pos--;if(pos<0)return max;if(pos===0)return max;
return pos+_utf8len[buf[pos]]>max?pos:max};var buf2string=function(buf){var i,out,c,c_len;var len=buf.length;var utf16buf=new Array(len*2);for(out=0,i=0;i<len;){c=buf[i++];if(c<128){utf16buf[out++]=c;continue}c_len=_utf8len[c];if(c_len>4){utf16buf[out++]=65533;i+=c_len-1;continue}c&=c_len===2?31:c_len===3?15:7;while(c_len>1&&i<len){c=c<<6|buf[i++]&63;c_len--}if(c_len>1){utf16buf[out++]=65533;continue}if(c<65536)utf16buf[out++]=c;else{c-=65536;utf16buf[out++]=55296|c>>10&1023;utf16buf[out++]=56320|
c&1023}}if(utf16buf.length!==out)if(utf16buf.subarray)utf16buf=utf16buf.subarray(0,out);else utf16buf.length=out;return utils.applyFromCharCode(utf16buf)};exports.utf8encode=function utf8encode(str){if(support.nodebuffer)return nodeBuffer(str,"utf-8");return string2buf(str)};exports.utf8decode=function utf8decode(buf){if(support.nodebuffer)return utils.transformTo("nodebuffer",buf).toString("utf-8");buf=utils.transformTo(support.uint8array?"uint8array":"array",buf);var result=[],k=0,len=buf.length,
chunk=65536;while(k<len){var nextBoundary=utf8border(buf,Math.min(k+chunk,len));if(support.uint8array)result.push(buf2string(buf.subarray(k,nextBoundary)));else result.push(buf2string(buf.slice(k,nextBoundary)));k=nextBoundary}return result.join("")}},{"./nodeBuffer":11,"./support":17,"./utils":21}],21:[function(_dereq_,module,exports){var support=_dereq_("./support");var compressions=_dereq_("./compressions");var nodeBuffer=_dereq_("./nodeBuffer");exports.string2binary=function(str){var result="";
for(var i=0;i<str.length;i++)result+=String.fromCharCode(str.charCodeAt(i)&255);return result};exports.arrayBuffer2Blob=function(buffer){exports.checkSupport("blob");try{return new Blob([buffer],{type:"application/zip"})}catch(e$9){try{var Builder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;var builder=new Builder;builder.append(buffer);return builder.getBlob("application/zip")}catch(e){throw new Error("Bug : can't construct the Blob.");}}};function identity(input){return input}
function stringToArrayLike(str,array){for(var i=0;i<str.length;++i)array[i]=str.charCodeAt(i)&255;return array}function arrayLikeToString(array){var chunk=65536;var result=[],len=array.length,type=exports.getTypeOf(array),k=0,canUseApply=true;try{switch(type){case "uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case "nodebuffer":String.fromCharCode.apply(null,nodeBuffer(0));break}}catch(e){canUseApply=false}if(!canUseApply){var resultStr="";for(var i=0;i<array.length;i++)resultStr+=
String.fromCharCode(array[i]);return resultStr}while(k<len&&chunk>1)try{if(type==="array"||type==="nodebuffer")result.push(String.fromCharCode.apply(null,array.slice(k,Math.min(k+chunk,len))));else result.push(String.fromCharCode.apply(null,array.subarray(k,Math.min(k+chunk,len))));k+=chunk}catch(e$10){chunk=Math.floor(chunk/2)}return result.join("")}exports.applyFromCharCode=arrayLikeToString;function arrayLikeToArrayLike(arrayFrom,arrayTo){for(var i=0;i<arrayFrom.length;i++)arrayTo[i]=arrayFrom[i];
return arrayTo}var transform={};transform["string"]={"string":identity,"array":function(input){return stringToArrayLike(input,new Array(input.length))},"arraybuffer":function(input){return transform["string"]["uint8array"](input).buffer},"uint8array":function(input){return stringToArrayLike(input,new Uint8Array(input.length))},"nodebuffer":function(input){return stringToArrayLike(input,nodeBuffer(input.length))}};transform["array"]={"string":arrayLikeToString,"array":identity,"arraybuffer":function(input){return(new Uint8Array(input)).buffer},
"uint8array":function(input){return new Uint8Array(input)},"nodebuffer":function(input){return nodeBuffer(input)}};transform["arraybuffer"]={"string":function(input){return arrayLikeToString(new Uint8Array(input))},"array":function(input){return arrayLikeToArrayLike(new Uint8Array(input),new Array(input.byteLength))},"arraybuffer":identity,"uint8array":function(input){return new Uint8Array(input)},"nodebuffer":function(input){return nodeBuffer(new Uint8Array(input))}};transform["uint8array"]={"string":arrayLikeToString,
"array":function(input){return arrayLikeToArrayLike(input,new Array(input.length))},"arraybuffer":function(input){return input.buffer},"uint8array":identity,"nodebuffer":function(input){return nodeBuffer(input)}};transform["nodebuffer"]={"string":arrayLikeToString,"array":function(input){return arrayLikeToArrayLike(input,new Array(input.length))},"arraybuffer":function(input){return transform["nodebuffer"]["uint8array"](input).buffer},"uint8array":function(input){return arrayLikeToArrayLike(input,
new Uint8Array(input.length))},"nodebuffer":identity};exports.transformTo=function(outputType,input){if(!input)input="";if(!outputType)return input;exports.checkSupport(outputType);var inputType=exports.getTypeOf(input);var result=transform[inputType][outputType](input);return result};exports.getTypeOf=function(input){if(typeof input==="string")return"string";if(Object.prototype.toString.call(input)==="[object Array]")return"array";if(support.nodebuffer&&nodeBuffer.test(input))return"nodebuffer";
if(support.uint8array&&input instanceof Uint8Array)return"uint8array";if(support.arraybuffer&&input instanceof ArrayBuffer)return"arraybuffer"};exports.checkSupport=function(type){var supported=support[type.toLowerCase()];if(!supported)throw new Error(type+" is not supported by this browser");};exports.MAX_VALUE_16BITS=65535;exports.MAX_VALUE_32BITS=-1;exports.pretty=function(str){var res="",code,i;for(i=0;i<(str||"").length;i++){code=str.charCodeAt(i);res+="\\x"+(code<16?"0":"")+code.toString(16).toUpperCase()}return res};
exports.findCompression=function(compressionMethod){for(var method in compressions){if(!compressions.hasOwnProperty(method))continue;if(compressions[method].magic===compressionMethod)return compressions[method]}return null};exports.isRegExp=function(object){return Object.prototype.toString.call(object)==="[object RegExp]"}},{"./compressions":3,"./nodeBuffer":11,"./support":17}],22:[function(_dereq_,module,exports){var StringReader=_dereq_("./stringReader");var NodeBufferReader=_dereq_("./nodeBufferReader");
var Uint8ArrayReader=_dereq_("./uint8ArrayReader");var utils=_dereq_("./utils");var sig=_dereq_("./signature");var ZipEntry=_dereq_("./zipEntry");var support=_dereq_("./support");var jszipProto=_dereq_("./object");function ZipEntries(data,loadOptions){this.files=[];this.loadOptions=loadOptions;if(data)this.load(data)}ZipEntries.prototype={checkSignature:function(expectedSignature){var signature=this.reader.readString(4);if(signature!==expectedSignature)throw new Error("Corrupted zip or bug : unexpected signature "+
"("+utils.pretty(signature)+", expected "+utils.pretty(expectedSignature)+")");},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2);this.diskWithCentralDirStart=this.reader.readInt(2);this.centralDirRecordsOnThisDisk=this.reader.readInt(2);this.centralDirRecords=this.reader.readInt(2);this.centralDirSize=this.reader.readInt(4);this.centralDirOffset=this.reader.readInt(4);this.zipCommentLength=this.reader.readInt(2);this.zipComment=this.reader.readString(this.zipCommentLength);
this.zipComment=jszipProto.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8);this.versionMadeBy=this.reader.readString(2);this.versionNeeded=this.reader.readInt(2);this.diskNumber=this.reader.readInt(4);this.diskWithCentralDirStart=this.reader.readInt(4);this.centralDirRecordsOnThisDisk=this.reader.readInt(8);this.centralDirRecords=this.reader.readInt(8);this.centralDirSize=this.reader.readInt(8);this.centralDirOffset=this.reader.readInt(8);
this.zip64ExtensibleData={};var extraDataSize=this.zip64EndOfCentralSize-44,index=0,extraFieldId,extraFieldLength,extraFieldValue;while(index<extraDataSize){extraFieldId=this.reader.readInt(2);extraFieldLength=this.reader.readInt(4);extraFieldValue=this.reader.readString(extraFieldLength);this.zip64ExtensibleData[extraFieldId]={id:extraFieldId,length:extraFieldLength,value:extraFieldValue}}},readBlockZip64EndOfCentralLocator:function(){this.diskWithZip64CentralDirStart=this.reader.readInt(4);this.relativeOffsetEndOfZip64CentralDir=
this.reader.readInt(8);this.disksCount=this.reader.readInt(4);if(this.disksCount>1)throw new Error("Multi-volumes zip are not supported");},readLocalFiles:function(){var i,file;for(i=0;i<this.files.length;i++){file=this.files[i];this.reader.setIndex(file.localHeaderOffset);this.checkSignature(sig.LOCAL_FILE_HEADER);file.readLocalPart(this.reader);file.handleUTF8()}},readCentralDir:function(){var file;this.reader.setIndex(this.centralDirOffset);while(this.reader.readString(4)===sig.CENTRAL_FILE_HEADER){file=
new ZipEntry({zip64:this.zip64},this.loadOptions);file.readCentralPart(this.reader);this.files.push(file)}},readEndOfCentral:function(){var offset=this.reader.lastIndexOfSignature(sig.CENTRAL_DIRECTORY_END);if(offset===-1)throw new Error("Corrupted zip : can't find end of central directory");this.reader.setIndex(offset);this.checkSignature(sig.CENTRAL_DIRECTORY_END);this.readBlockEndOfCentral();if(this.diskNumber===utils.MAX_VALUE_16BITS||this.diskWithCentralDirStart===utils.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===
utils.MAX_VALUE_16BITS||this.centralDirRecords===utils.MAX_VALUE_16BITS||this.centralDirSize===utils.MAX_VALUE_32BITS||this.centralDirOffset===utils.MAX_VALUE_32BITS){this.zip64=true;offset=this.reader.lastIndexOfSignature(sig.ZIP64_CENTRAL_DIRECTORY_LOCATOR);if(offset===-1)throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(offset);this.checkSignature(sig.ZIP64_CENTRAL_DIRECTORY_LOCATOR);this.readBlockZip64EndOfCentralLocator();this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir);
this.checkSignature(sig.ZIP64_CENTRAL_DIRECTORY_END);this.readBlockZip64EndOfCentral()}},prepareReader:function(data){var type=utils.getTypeOf(data);if(type==="string"&&!support.uint8array)this.reader=new StringReader(data,this.loadOptions.optimizedBinaryString);else if(type==="nodebuffer")this.reader=new NodeBufferReader(data);else this.reader=new Uint8ArrayReader(utils.transformTo("uint8array",data))},load:function(data){this.prepareReader(data);this.readEndOfCentral();this.readCentralDir();this.readLocalFiles()}};
module.exports=ZipEntries},{"./nodeBufferReader":12,"./object":13,"./signature":14,"./stringReader":15,"./support":17,"./uint8ArrayReader":18,"./utils":21,"./zipEntry":23}],23:[function(_dereq_,module,exports){var StringReader=_dereq_("./stringReader");var utils=_dereq_("./utils");var CompressedObject=_dereq_("./compressedObject");var jszipProto=_dereq_("./object");function ZipEntry(options,loadOptions){this.options=options;this.loadOptions=loadOptions}ZipEntry.prototype={isEncrypted:function(){return(this.bitFlag&
1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},prepareCompressedContent:function(reader,from,length){return function(){var previousIndex=reader.index;reader.setIndex(from);var compressedFileData=reader.readData(length);reader.setIndex(previousIndex);return compressedFileData}},prepareContent:function(reader,from,length,compression,uncompressedSize){return function(){var compressedFileData=utils.transformTo(compression.uncompressInputType,this.getCompressedContent());var uncompressedFileData=
compression.uncompress(compressedFileData);if(uncompressedFileData.length!==uncompressedSize)throw new Error("Bug : uncompressed data size mismatch");return uncompressedFileData}},readLocalPart:function(reader){var compression,localExtraFieldsLength;reader.skip(22);this.fileNameLength=reader.readInt(2);localExtraFieldsLength=reader.readInt(2);this.fileName=reader.readString(this.fileNameLength);reader.skip(localExtraFieldsLength);if(this.compressedSize==-1||this.uncompressedSize==-1)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory "+
"(compressedSize == -1 || uncompressedSize == -1)");compression=utils.findCompression(this.compressionMethod);if(compression===null)throw new Error("Corrupted zip : compression "+utils.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");this.decompressed=new CompressedObject;this.decompressed.compressedSize=this.compressedSize;this.decompressed.uncompressedSize=this.uncompressedSize;this.decompressed.crc32=this.crc32;this.decompressed.compressionMethod=this.compressionMethod;
this.decompressed.getCompressedContent=this.prepareCompressedContent(reader,reader.index,this.compressedSize,compression);this.decompressed.getContent=this.prepareContent(reader,reader.index,this.compressedSize,compression,this.uncompressedSize);if(this.loadOptions.checkCRC32){this.decompressed=utils.transformTo("string",this.decompressed.getContent());if(jszipProto.crc32(this.decompressed)!==this.crc32)throw new Error("Corrupted zip : CRC32 mismatch");}},readCentralPart:function(reader){this.versionMadeBy=
reader.readString(2);this.versionNeeded=reader.readInt(2);this.bitFlag=reader.readInt(2);this.compressionMethod=reader.readString(2);this.date=reader.readDate();this.crc32=reader.readInt(4);this.compressedSize=reader.readInt(4);this.uncompressedSize=reader.readInt(4);this.fileNameLength=reader.readInt(2);this.extraFieldsLength=reader.readInt(2);this.fileCommentLength=reader.readInt(2);this.diskNumberStart=reader.readInt(2);this.internalFileAttributes=reader.readInt(2);this.externalFileAttributes=
reader.readInt(4);this.localHeaderOffset=reader.readInt(4);if(this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=reader.readString(this.fileNameLength);this.readExtraFields(reader);this.parseZIP64ExtraField(reader);this.fileComment=reader.readString(this.fileCommentLength);this.dir=this.externalFileAttributes&16?true:false},parseZIP64ExtraField:function(reader){if(!this.extraFields[1])return;var extraReader=new StringReader(this.extraFields[1].value);if(this.uncompressedSize===
utils.MAX_VALUE_32BITS)this.uncompressedSize=extraReader.readInt(8);if(this.compressedSize===utils.MAX_VALUE_32BITS)this.compressedSize=extraReader.readInt(8);if(this.localHeaderOffset===utils.MAX_VALUE_32BITS)this.localHeaderOffset=extraReader.readInt(8);if(this.diskNumberStart===utils.MAX_VALUE_32BITS)this.diskNumberStart=extraReader.readInt(4)},readExtraFields:function(reader){var start=reader.index,extraFieldId,extraFieldLength,extraFieldValue;this.extraFields=this.extraFields||{};while(reader.index<
start+this.extraFieldsLength){extraFieldId=reader.readInt(2);extraFieldLength=reader.readInt(2);extraFieldValue=reader.readString(extraFieldLength);this.extraFields[extraFieldId]={id:extraFieldId,length:extraFieldLength,value:extraFieldValue}}},handleUTF8:function(){if(this.useUTF8()){this.fileName=jszipProto.utf8decode(this.fileName);this.fileComment=jszipProto.utf8decode(this.fileComment)}else{var upath=this.findExtraFieldUnicodePath();if(upath!==null)this.fileName=upath;var ucomment=this.findExtraFieldUnicodeComment();
if(ucomment!==null)this.fileComment=ucomment}},findExtraFieldUnicodePath:function(){var upathField=this.extraFields[28789];if(upathField){var extraReader=new StringReader(upathField.value);if(extraReader.readInt(1)!==1)return null;if(jszipProto.crc32(this.fileName)!==extraReader.readInt(4))return null;return jszipProto.utf8decode(extraReader.readString(upathField.length-5))}return null},findExtraFieldUnicodeComment:function(){var ucommentField=this.extraFields[25461];if(ucommentField){var extraReader=
new StringReader(ucommentField.value);if(extraReader.readInt(1)!==1)return null;if(jszipProto.crc32(this.fileComment)!==extraReader.readInt(4))return null;return jszipProto.utf8decode(extraReader.readString(ucommentField.length-5))}return null}};module.exports=ZipEntry},{"./compressedObject":2,"./object":13,"./stringReader":15,"./utils":21}],24:[function(_dereq_,module,exports){var assign=_dereq_("./lib/utils/common").assign;var deflate=_dereq_("./lib/deflate");var inflate=_dereq_("./lib/inflate");
var constants=_dereq_("./lib/zlib/constants");var pako={};assign(pako,deflate,inflate,constants);module.exports=pako},{"./lib/deflate":25,"./lib/inflate":26,"./lib/utils/common":27,"./lib/zlib/constants":30}],25:[function(_dereq_,module,exports){var zlib_deflate=_dereq_("./zlib/deflate.js");var utils=_dereq_("./utils/common");var strings=_dereq_("./utils/strings");var msg=_dereq_("./zlib/messages");var zstream=_dereq_("./zlib/zstream");var Z_NO_FLUSH=0;var Z_FINISH=4;var Z_OK=0;var Z_STREAM_END=1;
var Z_DEFAULT_COMPRESSION=-1;var Z_DEFAULT_STRATEGY=0;var Z_DEFLATED=8;var Deflate=function(options){this.options=utils.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY,to:""},options||{});var opt=this.options;if(opt.raw&&opt.windowBits>0)opt.windowBits=-opt.windowBits;else if(opt.gzip&&opt.windowBits>0&&opt.windowBits<16)opt.windowBits+=16;this.err=0;this.msg="";this.ended=false;this.chunks=[];this.strm=new zstream;this.strm.avail_out=
0;var status=zlib_deflate.deflateInit2(this.strm,opt.level,opt.method,opt.windowBits,opt.memLevel,opt.strategy);if(status!==Z_OK)throw new Error(msg[status]);if(opt.header)zlib_deflate.deflateSetHeader(this.strm,opt.header)};Deflate.prototype.push=function(data,mode){var strm=this.strm;var chunkSize=this.options.chunkSize;var status,_mode;if(this.ended)return false;_mode=mode===~~mode?mode:mode===true?Z_FINISH:Z_NO_FLUSH;if(typeof data==="string")strm.input=strings.string2buf(data);else strm.input=
data;strm.next_in=0;strm.avail_in=strm.input.length;do{if(strm.avail_out===0){strm.output=new utils.Buf8(chunkSize);strm.next_out=0;strm.avail_out=chunkSize}status=zlib_deflate.deflate(strm,_mode);if(status!==Z_STREAM_END&&status!==Z_OK){this.onEnd(status);this.ended=true;return false}if(strm.avail_out===0||strm.avail_in===0&&_mode===Z_FINISH)if(this.options.to==="string")this.onData(strings.buf2binstring(utils.shrinkBuf(strm.output,strm.next_out)));else this.onData(utils.shrinkBuf(strm.output,strm.next_out))}while((strm.avail_in>
0||strm.avail_out===0)&&status!==Z_STREAM_END);if(_mode===Z_FINISH){status=zlib_deflate.deflateEnd(this.strm);this.onEnd(status);this.ended=true;return status===Z_OK}return true};Deflate.prototype.onData=function(chunk){this.chunks.push(chunk)};Deflate.prototype.onEnd=function(status){if(status===Z_OK)if(this.options.to==="string")this.result=this.chunks.join("");else this.result=utils.flattenChunks(this.chunks);this.chunks=[];this.err=status;this.msg=this.strm.msg};function deflate(input,options){var deflator=
new Deflate(options);deflator.push(input,true);if(deflator.err)throw deflator.msg;return deflator.result}function deflateRaw(input,options){options=options||{};options.raw=true;return deflate(input,options)}function gzip(input,options){options=options||{};options.gzip=true;return deflate(input,options)}exports.Deflate=Deflate;exports.deflate=deflate;exports.deflateRaw=deflateRaw;exports.gzip=gzip},{"./utils/common":27,"./utils/strings":28,"./zlib/deflate.js":32,"./zlib/messages":37,"./zlib/zstream":39}],
26:[function(_dereq_,module,exports){var zlib_inflate=_dereq_("./zlib/inflate.js");var utils=_dereq_("./utils/common");var strings=_dereq_("./utils/strings");var c=_dereq_("./zlib/constants");var msg=_dereq_("./zlib/messages");var zstream=_dereq_("./zlib/zstream");var gzheader=_dereq_("./zlib/gzheader");var Inflate=function(options){this.options=utils.assign({chunkSize:16384,windowBits:0,to:""},options||{});var opt=this.options;if(opt.raw&&opt.windowBits>=0&&opt.windowBits<16){opt.windowBits=-opt.windowBits;
if(opt.windowBits===0)opt.windowBits=-15}if(opt.windowBits>=0&&opt.windowBits<16&&!(options&&options.windowBits))opt.windowBits+=32;if(opt.windowBits>15&&opt.windowBits<48)if((opt.windowBits&15)===0)opt.windowBits|=15;this.err=0;this.msg="";this.ended=false;this.chunks=[];this.strm=new zstream;this.strm.avail_out=0;var status=zlib_inflate.inflateInit2(this.strm,opt.windowBits);if(status!==c.Z_OK)throw new Error(msg[status]);this.header=new gzheader;zlib_inflate.inflateGetHeader(this.strm,this.header)};
Inflate.prototype.push=function(data,mode){var strm=this.strm;var chunkSize=this.options.chunkSize;var status,_mode;var next_out_utf8,tail,utf8str;if(this.ended)return false;_mode=mode===~~mode?mode:mode===true?c.Z_FINISH:c.Z_NO_FLUSH;if(typeof data==="string")strm.input=strings.binstring2buf(data);else strm.input=data;strm.next_in=0;strm.avail_in=strm.input.length;do{if(strm.avail_out===0){strm.output=new utils.Buf8(chunkSize);strm.next_out=0;strm.avail_out=chunkSize}status=zlib_inflate.inflate(strm,
c.Z_NO_FLUSH);if(status!==c.Z_STREAM_END&&status!==c.Z_OK){this.onEnd(status);this.ended=true;return false}if(strm.next_out)if(strm.avail_out===0||status===c.Z_STREAM_END||strm.avail_in===0&&_mode===c.Z_FINISH)if(this.options.to==="string"){next_out_utf8=strings.utf8border(strm.output,strm.next_out);tail=strm.next_out-next_out_utf8;utf8str=strings.buf2string(strm.output,next_out_utf8);strm.next_out=tail;strm.avail_out=chunkSize-tail;if(tail)utils.arraySet(strm.output,strm.output,next_out_utf8,tail,
0);this.onData(utf8str)}else this.onData(utils.shrinkBuf(strm.output,strm.next_out))}while(strm.avail_in>0&&status!==c.Z_STREAM_END);if(status===c.Z_STREAM_END)_mode=c.Z_FINISH;if(_mode===c.Z_FINISH){status=zlib_inflate.inflateEnd(this.strm);this.onEnd(status);this.ended=true;return status===c.Z_OK}return true};Inflate.prototype.onData=function(chunk){this.chunks.push(chunk)};Inflate.prototype.onEnd=function(status){if(status===c.Z_OK)if(this.options.to==="string")this.result=this.chunks.join("");
else this.result=utils.flattenChunks(this.chunks);this.chunks=[];this.err=status;this.msg=this.strm.msg};function inflate(input,options){var inflator=new Inflate(options);inflator.push(input,true);if(inflator.err)throw inflator.msg;return inflator.result}function inflateRaw(input,options){options=options||{};options.raw=true;return inflate(input,options)}exports.Inflate=Inflate;exports.inflate=inflate;exports.inflateRaw=inflateRaw;exports.ungzip=inflate},{"./utils/common":27,"./utils/strings":28,
"./zlib/constants":30,"./zlib/gzheader":33,"./zlib/inflate.js":35,"./zlib/messages":37,"./zlib/zstream":39}],27:[function(_dereq_,module,exports){var TYPED_OK=typeof Uint8Array!=="undefined"&&typeof Uint16Array!=="undefined"&&typeof Int32Array!=="undefined";exports.assign=function(obj){var sources=Array.prototype.slice.call(arguments,1);while(sources.length){var source=sources.shift();if(!source)continue;if(typeof source!=="object")throw new TypeError(source+"must be non-object");for(var p in source)if(source.hasOwnProperty(p))obj[p]=
source[p]}return obj};exports.shrinkBuf=function(buf,size){if(buf.length===size)return buf;if(buf.subarray)return buf.subarray(0,size);buf.length=size;return buf};var fnTyped={arraySet:function(dest,src,src_offs,len,dest_offs){if(src.subarray&&dest.subarray){dest.set(src.subarray(src_offs,src_offs+len),dest_offs);return}for(var i=0;i<len;i++)dest[dest_offs+i]=src[src_offs+i]},flattenChunks:function(chunks){var i,l,len,pos,chunk,result;len=0;for(i=0,l=chunks.length;i<l;i++)len+=chunks[i].length;result=
new Uint8Array(len);pos=0;for(i=0,l=chunks.length;i<l;i++){chunk=chunks[i];result.set(chunk,pos);pos+=chunk.length}return result}};var fnUntyped={arraySet:function(dest,src,src_offs,len,dest_offs){for(var i=0;i<len;i++)dest[dest_offs+i]=src[src_offs+i]},flattenChunks:function(chunks){return[].concat.apply([],chunks)}};exports.setTyped=function(on){if(on){exports.Buf8=Uint8Array;exports.Buf16=Uint16Array;exports.Buf32=Int32Array;exports.assign(exports,fnTyped)}else{exports.Buf8=Array;exports.Buf16=
Array;exports.Buf32=Array;exports.assign(exports,fnUntyped)}};exports.setTyped(TYPED_OK)},{}],28:[function(_dereq_,module,exports){var utils=_dereq_("./common");var STR_APPLY_OK=true;var STR_APPLY_UIA_OK=true;try{String.fromCharCode.apply(null,[0])}catch(__){STR_APPLY_OK=false}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(__$11){STR_APPLY_UIA_OK=false}var _utf8len=new utils.Buf8(256);for(var i=0;i<256;i++)_utf8len[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;_utf8len[254]=_utf8len[254]=
1;exports.string2buf=function(str){var buf,c,c2,m_pos,i,str_len=str.length,buf_len=0;for(m_pos=0;m_pos<str_len;m_pos++){c=str.charCodeAt(m_pos);if((c&64512)===55296&&m_pos+1<str_len){c2=str.charCodeAt(m_pos+1);if((c2&64512)===56320){c=65536+(c-55296<<10)+(c2-56320);m_pos++}}buf_len+=c<128?1:c<2048?2:c<65536?3:4}buf=new utils.Buf8(buf_len);for(i=0,m_pos=0;i<buf_len;m_pos++){c=str.charCodeAt(m_pos);if((c&64512)===55296&&m_pos+1<str_len){c2=str.charCodeAt(m_pos+1);if((c2&64512)===56320){c=65536+(c-55296<<
10)+(c2-56320);m_pos++}}if(c<128)buf[i++]=c;else if(c<2048){buf[i++]=192|c>>>6;buf[i++]=128|c&63}else if(c<65536){buf[i++]=224|c>>>12;buf[i++]=128|c>>>6&63;buf[i++]=128|c&63}else{buf[i++]=240|c>>>18;buf[i++]=128|c>>>12&63;buf[i++]=128|c>>>6&63;buf[i++]=128|c&63}}return buf};function buf2binstring(buf,len){if(len<65537)if(buf.subarray&&STR_APPLY_UIA_OK||!buf.subarray&&STR_APPLY_OK)return String.fromCharCode.apply(null,utils.shrinkBuf(buf,len));var result="";for(var i=0;i<len;i++)result+=String.fromCharCode(buf[i]);
return result}exports.buf2binstring=function(buf){return buf2binstring(buf,buf.length)};exports.binstring2buf=function(str){var buf=new utils.Buf8(str.length);for(var i=0,len=buf.length;i<len;i++)buf[i]=str.charCodeAt(i);return buf};exports.buf2string=function(buf,max){var i,out,c,c_len;var len=max||buf.length;var utf16buf=new Array(len*2);for(out=0,i=0;i<len;){c=buf[i++];if(c<128){utf16buf[out++]=c;continue}c_len=_utf8len[c];if(c_len>4){utf16buf[out++]=65533;i+=c_len-1;continue}c&=c_len===2?31:c_len===
3?15:7;while(c_len>1&&i<len){c=c<<6|buf[i++]&63;c_len--}if(c_len>1){utf16buf[out++]=65533;continue}if(c<65536)utf16buf[out++]=c;else{c-=65536;utf16buf[out++]=55296|c>>10&1023;utf16buf[out++]=56320|c&1023}}return buf2binstring(utf16buf,out)};exports.utf8border=function(buf,max){var pos;max=max||buf.length;if(max>buf.length)max=buf.length;pos=max-1;while(pos>=0&&(buf[pos]&192)===128)pos--;if(pos<0)return max;if(pos===0)return max;return pos+_utf8len[buf[pos]]>max?pos:max}},{"./common":27}],29:[function(_dereq_,
module,exports){function adler32(adler,buf,len,pos){var s1=adler&65535|0,s2=adler>>>16&65535|0,n=0;while(len!==0){n=len>2E3?2E3:len;len-=n;do{s1=s1+buf[pos++]|0;s2=s2+s1|0}while(--n);s1%=65521;s2%=65521}return s1|s2<<16|0}module.exports=adler32},{}],30:[function(_dereq_,module,exports){module.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,
Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],31:[function(_dereq_,module,exports){function makeTable(){var c,table=[];for(var n=0;n<256;n++){c=n;for(var k=0;k<8;k++)c=c&1?3988292384^c>>>1:c>>>1;table[n]=c}return table}var crcTable=makeTable();function crc32(crc,buf,len,pos){var t=crcTable,end=pos+len;crc=crc^-1;for(var i=pos;i<end;i++)crc=crc>>>8^t[(crc^buf[i])&255];
return crc^-1}module.exports=crc32},{}],32:[function(_dereq_,module,exports){var utils=_dereq_("../utils/common");var trees=_dereq_("./trees");var adler32=_dereq_("./adler32");var crc32=_dereq_("./crc32");var msg=_dereq_("./messages");var Z_NO_FLUSH=0;var Z_PARTIAL_FLUSH=1;var Z_FULL_FLUSH=3;var Z_FINISH=4;var Z_BLOCK=5;var Z_OK=0;var Z_STREAM_END=1;var Z_STREAM_ERROR=-2;var Z_DATA_ERROR=-3;var Z_BUF_ERROR=-5;var Z_DEFAULT_COMPRESSION=-1;var Z_FILTERED=1;var Z_HUFFMAN_ONLY=2;var Z_RLE=3;var Z_FIXED=
4;var Z_DEFAULT_STRATEGY=0;var Z_UNKNOWN=2;var Z_DEFLATED=8;var MAX_MEM_LEVEL=9;var MAX_WBITS=15;var DEF_MEM_LEVEL=8;var LENGTH_CODES=29;var LITERALS=256;var L_CODES=LITERALS+1+LENGTH_CODES;var D_CODES=30;var BL_CODES=19;var HEAP_SIZE=2*L_CODES+1;var MAX_BITS=15;var MIN_MATCH=3;var MAX_MATCH=258;var MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1;var PRESET_DICT=32;var INIT_STATE=42;var EXTRA_STATE=69;var NAME_STATE=73;var COMMENT_STATE=91;var HCRC_STATE=103;var BUSY_STATE=113;var FINISH_STATE=666;var BS_NEED_MORE=
1;var BS_BLOCK_DONE=2;var BS_FINISH_STARTED=3;var BS_FINISH_DONE=4;var OS_CODE=3;function err(strm,errorCode){strm.msg=msg[errorCode];return errorCode}function rank(f){return(f<<1)-(f>4?9:0)}function zero(buf){var len=buf.length;while(--len>=0)buf[len]=0}function flush_pending(strm){var s=strm.state;var len=s.pending;if(len>strm.avail_out)len=strm.avail_out;if(len===0)return;utils.arraySet(strm.output,s.pending_buf,s.pending_out,len,strm.next_out);strm.next_out+=len;s.pending_out+=len;strm.total_out+=
len;strm.avail_out-=len;s.pending-=len;if(s.pending===0)s.pending_out=0}function flush_block_only(s,last){trees._tr_flush_block(s,s.block_start>=0?s.block_start:-1,s.strstart-s.block_start,last);s.block_start=s.strstart;flush_pending(s.strm)}function put_byte(s,b){s.pending_buf[s.pending++]=b}function putShortMSB(s,b){s.pending_buf[s.pending++]=b>>>8&255;s.pending_buf[s.pending++]=b&255}function read_buf(strm,buf,start,size){var len=strm.avail_in;if(len>size)len=size;if(len===0)return 0;strm.avail_in-=
len;utils.arraySet(buf,strm.input,strm.next_in,len,start);if(strm.state.wrap===1)strm.adler=adler32(strm.adler,buf,len,start);else if(strm.state.wrap===2)strm.adler=crc32(strm.adler,buf,len,start);strm.next_in+=len;strm.total_in+=len;return len}function longest_match(s,cur_match){var chain_length=s.max_chain_length;var scan=s.strstart;var match;var len;var best_len=s.prev_length;var nice_match=s.nice_match;var limit=s.strstart>s.w_size-MIN_LOOKAHEAD?s.strstart-(s.w_size-MIN_LOOKAHEAD):0;var _win=
s.window;var wmask=s.w_mask;var prev=s.prev;var strend=s.strstart+MAX_MATCH;var scan_end1=_win[scan+best_len-1];var scan_end=_win[scan+best_len];if(s.prev_length>=s.good_match)chain_length>>=2;if(nice_match>s.lookahead)nice_match=s.lookahead;do{match=cur_match;if(_win[match+best_len]!==scan_end||_win[match+best_len-1]!==scan_end1||_win[match]!==_win[scan]||_win[++match]!==_win[scan+1])continue;scan+=2;match++;do;while(_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&
_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&scan<strend);len=MAX_MATCH-(strend-scan);scan=strend-MAX_MATCH;if(len>best_len){s.match_start=cur_match;best_len=len;if(len>=nice_match)break;scan_end1=_win[scan+best_len-1];scan_end=_win[scan+best_len]}}while((cur_match=prev[cur_match&wmask])>limit&&--chain_length!==0);if(best_len<=s.lookahead)return best_len;return s.lookahead}function fill_window(s){var _w_size=
s.w_size;var p,n,m,more,str;do{more=s.window_size-s.lookahead-s.strstart;if(s.strstart>=_w_size+(_w_size-MIN_LOOKAHEAD)){utils.arraySet(s.window,s.window,_w_size,_w_size,0);s.match_start-=_w_size;s.strstart-=_w_size;s.block_start-=_w_size;n=s.hash_size;p=n;do{m=s.head[--p];s.head[p]=m>=_w_size?m-_w_size:0}while(--n);n=_w_size;p=n;do{m=s.prev[--p];s.prev[p]=m>=_w_size?m-_w_size:0}while(--n);more+=_w_size}if(s.strm.avail_in===0)break;n=read_buf(s.strm,s.window,s.strstart+s.lookahead,more);s.lookahead+=
n;if(s.lookahead+s.insert>=MIN_MATCH){str=s.strstart-s.insert;s.ins_h=s.window[str];s.ins_h=(s.ins_h<<s.hash_shift^s.window[str+1])&s.hash_mask;while(s.insert){s.ins_h=(s.ins_h<<s.hash_shift^s.window[str+MIN_MATCH-1])&s.hash_mask;s.prev[str&s.w_mask]=s.head[s.ins_h];s.head[s.ins_h]=str;str++;s.insert--;if(s.lookahead+s.insert<MIN_MATCH)break}}}while(s.lookahead<MIN_LOOKAHEAD&&s.strm.avail_in!==0)}function deflate_stored(s,flush){var max_block_size=65535;if(max_block_size>s.pending_buf_size-5)max_block_size=
s.pending_buf_size-5;for(;;){if(s.lookahead<=1){fill_window(s);if(s.lookahead===0&&flush===Z_NO_FLUSH)return BS_NEED_MORE;if(s.lookahead===0)break}s.strstart+=s.lookahead;s.lookahead=0;var max_start=s.block_start+max_block_size;if(s.strstart===0||s.strstart>=max_start){s.lookahead=s.strstart-max_start;s.strstart=max_start;flush_block_only(s,false);if(s.strm.avail_out===0)return BS_NEED_MORE}if(s.strstart-s.block_start>=s.w_size-MIN_LOOKAHEAD){flush_block_only(s,false);if(s.strm.avail_out===0)return BS_NEED_MORE}}s.insert=
0;if(flush===Z_FINISH){flush_block_only(s,true);if(s.strm.avail_out===0)return BS_FINISH_STARTED;return BS_FINISH_DONE}if(s.strstart>s.block_start){flush_block_only(s,false);if(s.strm.avail_out===0)return BS_NEED_MORE}return BS_NEED_MORE}function deflate_fast(s,flush){var hash_head;var bflush;for(;;){if(s.lookahead<MIN_LOOKAHEAD){fill_window(s);if(s.lookahead<MIN_LOOKAHEAD&&flush===Z_NO_FLUSH)return BS_NEED_MORE;if(s.lookahead===0)break}hash_head=0;if(s.lookahead>=MIN_MATCH){s.ins_h=(s.ins_h<<s.hash_shift^
s.window[s.strstart+MIN_MATCH-1])&s.hash_mask;hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h];s.head[s.ins_h]=s.strstart}if(hash_head!==0&&s.strstart-hash_head<=s.w_size-MIN_LOOKAHEAD)s.match_length=longest_match(s,hash_head);if(s.match_length>=MIN_MATCH){bflush=trees._tr_tally(s,s.strstart-s.match_start,s.match_length-MIN_MATCH);s.lookahead-=s.match_length;if(s.match_length<=s.max_lazy_match&&s.lookahead>=MIN_MATCH){s.match_length--;do{s.strstart++;s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+
MIN_MATCH-1])&s.hash_mask;hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h];s.head[s.ins_h]=s.strstart}while(--s.match_length!==0);s.strstart++}else{s.strstart+=s.match_length;s.match_length=0;s.ins_h=s.window[s.strstart];s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+1])&s.hash_mask}}else{bflush=trees._tr_tally(s,0,s.window[s.strstart]);s.lookahead--;s.strstart++}if(bflush){flush_block_only(s,false);if(s.strm.avail_out===0)return BS_NEED_MORE}}s.insert=s.strstart<MIN_MATCH-1?s.strstart:MIN_MATCH-
1;if(flush===Z_FINISH){flush_block_only(s,true);if(s.strm.avail_out===0)return BS_FINISH_STARTED;return BS_FINISH_DONE}if(s.last_lit){flush_block_only(s,false);if(s.strm.avail_out===0)return BS_NEED_MORE}return BS_BLOCK_DONE}function deflate_slow(s,flush){var hash_head;var bflush;var max_insert;for(;;){if(s.lookahead<MIN_LOOKAHEAD){fill_window(s);if(s.lookahead<MIN_LOOKAHEAD&&flush===Z_NO_FLUSH)return BS_NEED_MORE;if(s.lookahead===0)break}hash_head=0;if(s.lookahead>=MIN_MATCH){s.ins_h=(s.ins_h<<s.hash_shift^
s.window[s.strstart+MIN_MATCH-1])&s.hash_mask;hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h];s.head[s.ins_h]=s.strstart}s.prev_length=s.match_length;s.prev_match=s.match_start;s.match_length=MIN_MATCH-1;if(hash_head!==0&&s.prev_length<s.max_lazy_match&&s.strstart-hash_head<=s.w_size-MIN_LOOKAHEAD){s.match_length=longest_match(s,hash_head);if(s.match_length<=5&&(s.strategy===Z_FILTERED||s.match_length===MIN_MATCH&&s.strstart-s.match_start>4096))s.match_length=MIN_MATCH-1}if(s.prev_length>=MIN_MATCH&&
s.match_length<=s.prev_length){max_insert=s.strstart+s.lookahead-MIN_MATCH;bflush=trees._tr_tally(s,s.strstart-1-s.prev_match,s.prev_length-MIN_MATCH);s.lookahead-=s.prev_length-1;s.prev_length-=2;do if(++s.strstart<=max_insert){s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+MIN_MATCH-1])&s.hash_mask;hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h];s.head[s.ins_h]=s.strstart}while(--s.prev_length!==0);s.match_available=0;s.match_length=MIN_MATCH-1;s.strstart++;if(bflush){flush_block_only(s,
false);if(s.strm.avail_out===0)return BS_NEED_MORE}}else if(s.match_available){bflush=trees._tr_tally(s,0,s.window[s.strstart-1]);if(bflush)flush_block_only(s,false);s.strstart++;s.lookahead--;if(s.strm.avail_out===0)return BS_NEED_MORE}else{s.match_available=1;s.strstart++;s.lookahead--}}if(s.match_available){bflush=trees._tr_tally(s,0,s.window[s.strstart-1]);s.match_available=0}s.insert=s.strstart<MIN_MATCH-1?s.strstart:MIN_MATCH-1;if(flush===Z_FINISH){flush_block_only(s,true);if(s.strm.avail_out===
0)return BS_FINISH_STARTED;return BS_FINISH_DONE}if(s.last_lit){flush_block_only(s,false);if(s.strm.avail_out===0)return BS_NEED_MORE}return BS_BLOCK_DONE}function deflate_rle(s,flush){var bflush;var prev;var scan,strend;var _win=s.window;for(;;){if(s.lookahead<=MAX_MATCH){fill_window(s);if(s.lookahead<=MAX_MATCH&&flush===Z_NO_FLUSH)return BS_NEED_MORE;if(s.lookahead===0)break}s.match_length=0;if(s.lookahead>=MIN_MATCH&&s.strstart>0){scan=s.strstart-1;prev=_win[scan];if(prev===_win[++scan]&&prev===
_win[++scan]&&prev===_win[++scan]){strend=s.strstart+MAX_MATCH;do;while(prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&scan<strend);s.match_length=MAX_MATCH-(strend-scan);if(s.match_length>s.lookahead)s.match_length=s.lookahead}}if(s.match_length>=MIN_MATCH){bflush=trees._tr_tally(s,1,s.match_length-MIN_MATCH);s.lookahead-=s.match_length;s.strstart+=s.match_length;s.match_length=
0}else{bflush=trees._tr_tally(s,0,s.window[s.strstart]);s.lookahead--;s.strstart++}if(bflush){flush_block_only(s,false);if(s.strm.avail_out===0)return BS_NEED_MORE}}s.insert=0;if(flush===Z_FINISH){flush_block_only(s,true);if(s.strm.avail_out===0)return BS_FINISH_STARTED;return BS_FINISH_DONE}if(s.last_lit){flush_block_only(s,false);if(s.strm.avail_out===0)return BS_NEED_MORE}return BS_BLOCK_DONE}function deflate_huff(s,flush){var bflush;for(;;){if(s.lookahead===0){fill_window(s);if(s.lookahead===
0){if(flush===Z_NO_FLUSH)return BS_NEED_MORE;break}}s.match_length=0;bflush=trees._tr_tally(s,0,s.window[s.strstart]);s.lookahead--;s.strstart++;if(bflush){flush_block_only(s,false);if(s.strm.avail_out===0)return BS_NEED_MORE}}s.insert=0;if(flush===Z_FINISH){flush_block_only(s,true);if(s.strm.avail_out===0)return BS_FINISH_STARTED;return BS_FINISH_DONE}if(s.last_lit){flush_block_only(s,false);if(s.strm.avail_out===0)return BS_NEED_MORE}return BS_BLOCK_DONE}var Config=function(good_length,max_lazy,
nice_length,max_chain,func){this.good_length=good_length;this.max_lazy=max_lazy;this.nice_length=nice_length;this.max_chain=max_chain;this.func=func};var configuration_table;configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,
1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)];function lm_init(s){s.window_size=2*s.w_size;zero(s.head);s.max_lazy_match=configuration_table[s.level].max_lazy;s.good_match=configuration_table[s.level].good_length;s.nice_match=configuration_table[s.level].nice_length;s.max_chain_length=configuration_table[s.level].max_chain;s.strstart=0;s.block_start=0;s.lookahead=0;s.insert=0;s.match_length=s.prev_length=MIN_MATCH-1;s.match_available=0;s.ins_h=0}function DeflateState(){this.strm=null;
this.status=0;this.pending_buf=null;this.pending_buf_size=0;this.pending_out=0;this.pending=0;this.wrap=0;this.gzhead=null;this.gzindex=0;this.method=Z_DEFLATED;this.last_flush=-1;this.w_size=0;this.w_bits=0;this.w_mask=0;this.window=null;this.window_size=0;this.prev=null;this.head=null;this.ins_h=0;this.hash_size=0;this.hash_bits=0;this.hash_mask=0;this.hash_shift=0;this.block_start=0;this.match_length=0;this.prev_match=0;this.match_available=0;this.strstart=0;this.match_start=0;this.lookahead=0;
this.prev_length=0;this.max_chain_length=0;this.max_lazy_match=0;this.level=0;this.strategy=0;this.good_match=0;this.nice_match=0;this.dyn_ltree=new utils.Buf16(HEAP_SIZE*2);this.dyn_dtree=new utils.Buf16((2*D_CODES+1)*2);this.bl_tree=new utils.Buf16((2*BL_CODES+1)*2);zero(this.dyn_ltree);zero(this.dyn_dtree);zero(this.bl_tree);this.l_desc=null;this.d_desc=null;this.bl_desc=null;this.bl_count=new utils.Buf16(MAX_BITS+1);this.heap=new utils.Buf16(2*L_CODES+1);zero(this.heap);this.heap_len=0;this.heap_max=
0;this.depth=new utils.Buf16(2*L_CODES+1);zero(this.depth);this.l_buf=0;this.lit_bufsize=0;this.last_lit=0;this.d_buf=0;this.opt_len=0;this.static_len=0;this.matches=0;this.insert=0;this.bi_buf=0;this.bi_valid=0}function deflateResetKeep(strm){var s;if(!strm||!strm.state)return err(strm,Z_STREAM_ERROR);strm.total_in=strm.total_out=0;strm.data_type=Z_UNKNOWN;s=strm.state;s.pending=0;s.pending_out=0;if(s.wrap<0)s.wrap=-s.wrap;s.status=s.wrap?INIT_STATE:BUSY_STATE;strm.adler=s.wrap===2?0:1;s.last_flush=
Z_NO_FLUSH;trees._tr_init(s);return Z_OK}function deflateReset(strm){var ret=deflateResetKeep(strm);if(ret===Z_OK)lm_init(strm.state);return ret}function deflateSetHeader(strm,head){if(!strm||!strm.state)return Z_STREAM_ERROR;if(strm.state.wrap!==2)return Z_STREAM_ERROR;strm.state.gzhead=head;return Z_OK}function deflateInit2(strm,level,method,windowBits,memLevel,strategy){if(!strm)return Z_STREAM_ERROR;var wrap=1;if(level===Z_DEFAULT_COMPRESSION)level=6;if(windowBits<0){wrap=0;windowBits=-windowBits}else if(windowBits>
15){wrap=2;windowBits-=16}if(memLevel<1||memLevel>MAX_MEM_LEVEL||method!==Z_DEFLATED||windowBits<8||windowBits>15||level<0||level>9||strategy<0||strategy>Z_FIXED)return err(strm,Z_STREAM_ERROR);if(windowBits===8)windowBits=9;var s=new DeflateState;strm.state=s;s.strm=strm;s.wrap=wrap;s.gzhead=null;s.w_bits=windowBits;s.w_size=1<<s.w_bits;s.w_mask=s.w_size-1;s.hash_bits=memLevel+7;s.hash_size=1<<s.hash_bits;s.hash_mask=s.hash_size-1;s.hash_shift=~~((s.hash_bits+MIN_MATCH-1)/MIN_MATCH);s.window=new utils.Buf8(s.w_size*
2);s.head=new utils.Buf16(s.hash_size);s.prev=new utils.Buf16(s.w_size);s.lit_bufsize=1<<memLevel+6;s.pending_buf_size=s.lit_bufsize*4;s.pending_buf=new utils.Buf8(s.pending_buf_size);s.d_buf=s.lit_bufsize>>1;s.l_buf=(1+2)*s.lit_bufsize;s.level=level;s.strategy=strategy;s.method=method;return deflateReset(strm)}function deflateInit(strm,level){return deflateInit2(strm,level,Z_DEFLATED,MAX_WBITS,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY)}function deflate(strm,flush){var old_flush,s;var beg,val;if(!strm||!strm.state||
flush>Z_BLOCK||flush<0)return strm?err(strm,Z_STREAM_ERROR):Z_STREAM_ERROR;s=strm.state;if(!strm.output||!strm.input&&strm.avail_in!==0||s.status===FINISH_STATE&&flush!==Z_FINISH)return err(strm,strm.avail_out===0?Z_BUF_ERROR:Z_STREAM_ERROR);s.strm=strm;old_flush=s.last_flush;s.last_flush=flush;if(s.status===INIT_STATE)if(s.wrap===2){strm.adler=0;put_byte(s,31);put_byte(s,139);put_byte(s,8);if(!s.gzhead){put_byte(s,0);put_byte(s,0);put_byte(s,0);put_byte(s,0);put_byte(s,0);put_byte(s,s.level===9?
2:s.strategy>=Z_HUFFMAN_ONLY||s.level<2?4:0);put_byte(s,OS_CODE);s.status=BUSY_STATE}else{put_byte(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(!s.gzhead.extra?0:4)+(!s.gzhead.name?0:8)+(!s.gzhead.comment?0:16));put_byte(s,s.gzhead.time&255);put_byte(s,s.gzhead.time>>8&255);put_byte(s,s.gzhead.time>>16&255);put_byte(s,s.gzhead.time>>24&255);put_byte(s,s.level===9?2:s.strategy>=Z_HUFFMAN_ONLY||s.level<2?4:0);put_byte(s,s.gzhead.os&255);if(s.gzhead.extra&&s.gzhead.extra.length){put_byte(s,s.gzhead.extra.length&
255);put_byte(s,s.gzhead.extra.length>>8&255)}if(s.gzhead.hcrc)strm.adler=crc32(strm.adler,s.pending_buf,s.pending,0);s.gzindex=0;s.status=EXTRA_STATE}}else{var header=Z_DEFLATED+(s.w_bits-8<<4)<<8;var level_flags=-1;if(s.strategy>=Z_HUFFMAN_ONLY||s.level<2)level_flags=0;else if(s.level<6)level_flags=1;else if(s.level===6)level_flags=2;else level_flags=3;header|=level_flags<<6;if(s.strstart!==0)header|=PRESET_DICT;header+=31-header%31;s.status=BUSY_STATE;putShortMSB(s,header);if(s.strstart!==0){putShortMSB(s,
strm.adler>>>16);putShortMSB(s,strm.adler&65535)}strm.adler=1}if(s.status===EXTRA_STATE)if(s.gzhead.extra){beg=s.pending;while(s.gzindex<(s.gzhead.extra.length&65535)){if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>beg)strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg);flush_pending(strm);beg=s.pending;if(s.pending===s.pending_buf_size)break}put_byte(s,s.gzhead.extra[s.gzindex]&255);s.gzindex++}if(s.gzhead.hcrc&&s.pending>beg)strm.adler=crc32(strm.adler,s.pending_buf,s.pending-
beg,beg);if(s.gzindex===s.gzhead.extra.length){s.gzindex=0;s.status=NAME_STATE}}else s.status=NAME_STATE;if(s.status===NAME_STATE)if(s.gzhead.name){beg=s.pending;do{if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>beg)strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg);flush_pending(strm);beg=s.pending;if(s.pending===s.pending_buf_size){val=1;break}}if(s.gzindex<s.gzhead.name.length)val=s.gzhead.name.charCodeAt(s.gzindex++)&255;else val=0;put_byte(s,val)}while(val!==0);if(s.gzhead.hcrc&&
s.pending>beg)strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg);if(val===0){s.gzindex=0;s.status=COMMENT_STATE}}else s.status=COMMENT_STATE;if(s.status===COMMENT_STATE)if(s.gzhead.comment){beg=s.pending;do{if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>beg)strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg);flush_pending(strm);beg=s.pending;if(s.pending===s.pending_buf_size){val=1;break}}if(s.gzindex<s.gzhead.comment.length)val=s.gzhead.comment.charCodeAt(s.gzindex++)&
255;else val=0;put_byte(s,val)}while(val!==0);if(s.gzhead.hcrc&&s.pending>beg)strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg);if(val===0)s.status=HCRC_STATE}else s.status=HCRC_STATE;if(s.status===HCRC_STATE)if(s.gzhead.hcrc){if(s.pending+2>s.pending_buf_size)flush_pending(strm);if(s.pending+2<=s.pending_buf_size){put_byte(s,strm.adler&255);put_byte(s,strm.adler>>8&255);strm.adler=0;s.status=BUSY_STATE}}else s.status=BUSY_STATE;if(s.pending!==0){flush_pending(strm);if(strm.avail_out===
0){s.last_flush=-1;return Z_OK}}else if(strm.avail_in===0&&rank(flush)<=rank(old_flush)&&flush!==Z_FINISH)return err(strm,Z_BUF_ERROR);if(s.status===FINISH_STATE&&strm.avail_in!==0)return err(strm,Z_BUF_ERROR);if(strm.avail_in!==0||s.lookahead!==0||flush!==Z_NO_FLUSH&&s.status!==FINISH_STATE){var bstate=s.strategy===Z_HUFFMAN_ONLY?deflate_huff(s,flush):s.strategy===Z_RLE?deflate_rle(s,flush):configuration_table[s.level].func(s,flush);if(bstate===BS_FINISH_STARTED||bstate===BS_FINISH_DONE)s.status=
FINISH_STATE;if(bstate===BS_NEED_MORE||bstate===BS_FINISH_STARTED){if(strm.avail_out===0)s.last_flush=-1;return Z_OK}if(bstate===BS_BLOCK_DONE){if(flush===Z_PARTIAL_FLUSH)trees._tr_align(s);else if(flush!==Z_BLOCK){trees._tr_stored_block(s,0,0,false);if(flush===Z_FULL_FLUSH){zero(s.head);if(s.lookahead===0){s.strstart=0;s.block_start=0;s.insert=0}}}flush_pending(strm);if(strm.avail_out===0){s.last_flush=-1;return Z_OK}}}if(flush!==Z_FINISH)return Z_OK;if(s.wrap<=0)return Z_STREAM_END;if(s.wrap===
2){put_byte(s,strm.adler&255);put_byte(s,strm.adler>>8&255);put_byte(s,strm.adler>>16&255);put_byte(s,strm.adler>>24&255);put_byte(s,strm.total_in&255);put_byte(s,strm.total_in>>8&255);put_byte(s,strm.total_in>>16&255);put_byte(s,strm.total_in>>24&255)}else{putShortMSB(s,strm.adler>>>16);putShortMSB(s,strm.adler&65535)}flush_pending(strm);if(s.wrap>0)s.wrap=-s.wrap;return s.pending!==0?Z_OK:Z_STREAM_END}function deflateEnd(strm){var status;if(!strm||!strm.state)return Z_STREAM_ERROR;status=strm.state.status;
if(status!==INIT_STATE&&status!==EXTRA_STATE&&status!==NAME_STATE&&status!==COMMENT_STATE&&status!==HCRC_STATE&&status!==BUSY_STATE&&status!==FINISH_STATE)return err(strm,Z_STREAM_ERROR);strm.state=null;return status===BUSY_STATE?err(strm,Z_DATA_ERROR):Z_OK}exports.deflateInit=deflateInit;exports.deflateInit2=deflateInit2;exports.deflateReset=deflateReset;exports.deflateResetKeep=deflateResetKeep;exports.deflateSetHeader=deflateSetHeader;exports.deflate=deflate;exports.deflateEnd=deflateEnd;exports.deflateInfo=
"pako deflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./messages":37,"./trees":38}],33:[function(_dereq_,module,exports){function GZheader(){this.text=0;this.time=0;this.xflags=0;this.os=0;this.extra=null;this.extra_len=0;this.name="";this.comment="";this.hcrc=0;this.done=false}module.exports=GZheader},{}],34:[function(_dereq_,module,exports){var BAD=30;var TYPE=12;module.exports=function inflate_fast(strm,start){var state;var _in;var last;var _out;var beg;var end;
var dmax;var wsize;var whave;var wnext;var window;var hold;var bits;var lcode;var dcode;var lmask;var dmask;var here;var op;var len;var dist;var from;var from_source;var input,output;state=strm.state;_in=strm.next_in;input=strm.input;last=_in+(strm.avail_in-5);_out=strm.next_out;output=strm.output;beg=_out-(start-strm.avail_out);end=_out+(strm.avail_out-257);dmax=state.dmax;wsize=state.wsize;whave=state.whave;wnext=state.wnext;window=state.window;hold=state.hold;bits=state.bits;lcode=state.lencode;
dcode=state.distcode;lmask=(1<<state.lenbits)-1;dmask=(1<<state.distbits)-1;top:do{if(bits<15){hold+=input[_in++]<<bits;bits+=8;hold+=input[_in++]<<bits;bits+=8}here=lcode[hold&lmask];dolen:for(;;){op=here>>>24;hold>>>=op;bits-=op;op=here>>>16&255;if(op===0)output[_out++]=here&65535;else if(op&16){len=here&65535;op&=15;if(op){if(bits<op){hold+=input[_in++]<<bits;bits+=8}len+=hold&(1<<op)-1;hold>>>=op;bits-=op}if(bits<15){hold+=input[_in++]<<bits;bits+=8;hold+=input[_in++]<<bits;bits+=8}here=dcode[hold&
dmask];dodist:for(;;){op=here>>>24;hold>>>=op;bits-=op;op=here>>>16&255;if(op&16){dist=here&65535;op&=15;if(bits<op){hold+=input[_in++]<<bits;bits+=8;if(bits<op){hold+=input[_in++]<<bits;bits+=8}}dist+=hold&(1<<op)-1;if(dist>dmax){strm.msg="invalid distance too far back";state.mode=BAD;break top}hold>>>=op;bits-=op;op=_out-beg;if(dist>op){op=dist-op;if(op>whave)if(state.sane){strm.msg="invalid distance too far back";state.mode=BAD;break top}from=0;from_source=window;if(wnext===0){from+=wsize-op;if(op<
len){len-=op;do output[_out++]=window[from++];while(--op);from=_out-dist;from_source=output}}else if(wnext<op){from+=wsize+wnext-op;op-=wnext;if(op<len){len-=op;do output[_out++]=window[from++];while(--op);from=0;if(wnext<len){op=wnext;len-=op;do output[_out++]=window[from++];while(--op);from=_out-dist;from_source=output}}}else{from+=wnext-op;if(op<len){len-=op;do output[_out++]=window[from++];while(--op);from=_out-dist;from_source=output}}while(len>2){output[_out++]=from_source[from++];output[_out++]=
from_source[from++];output[_out++]=from_source[from++];len-=3}if(len){output[_out++]=from_source[from++];if(len>1)output[_out++]=from_source[from++]}}else{from=_out-dist;do{output[_out++]=output[from++];output[_out++]=output[from++];output[_out++]=output[from++];len-=3}while(len>2);if(len){output[_out++]=output[from++];if(len>1)output[_out++]=output[from++]}}}else if((op&64)===0){here=dcode[(here&65535)+(hold&(1<<op)-1)];continue dodist}else{strm.msg="invalid distance code";state.mode=BAD;break top}break}}else if((op&
64)===0){here=lcode[(here&65535)+(hold&(1<<op)-1)];continue dolen}else if(op&32){state.mode=TYPE;break top}else{strm.msg="invalid literal/length code";state.mode=BAD;break top}break}}while(_in<last&&_out<end);len=bits>>3;_in-=len;bits-=len<<3;hold&=(1<<bits)-1;strm.next_in=_in;strm.next_out=_out;strm.avail_in=_in<last?5+(last-_in):5-(_in-last);strm.avail_out=_out<end?257+(end-_out):257-(_out-end);state.hold=hold;state.bits=bits;return}},{}],35:[function(_dereq_,module,exports){var utils=_dereq_("../utils/common");
var adler32=_dereq_("./adler32");var crc32=_dereq_("./crc32");var inflate_fast=_dereq_("./inffast");var inflate_table=_dereq_("./inftrees");var CODES=0;var LENS=1;var DISTS=2;var Z_FINISH=4;var Z_BLOCK=5;var Z_TREES=6;var Z_OK=0;var Z_STREAM_END=1;var Z_NEED_DICT=2;var Z_STREAM_ERROR=-2;var Z_DATA_ERROR=-3;var Z_MEM_ERROR=-4;var Z_BUF_ERROR=-5;var Z_DEFLATED=8;var HEAD=1;var FLAGS=2;var TIME=3;var OS=4;var EXLEN=5;var EXTRA=6;var NAME=7;var COMMENT=8;var HCRC=9;var DICTID=10;var DICT=11;var TYPE=
12;var TYPEDO=13;var STORED=14;var COPY_=15;var COPY=16;var TABLE=17;var LENLENS=18;var CODELENS=19;var LEN_=20;var LEN=21;var LENEXT=22;var DIST=23;var DISTEXT=24;var MATCH=25;var LIT=26;var CHECK=27;var LENGTH=28;var DONE=29;var BAD=30;var MEM=31;var SYNC=32;var ENOUGH_LENS=852;var ENOUGH_DISTS=592;var MAX_WBITS=15;var DEF_WBITS=MAX_WBITS;function ZSWAP32(q){return(q>>>24&255)+(q>>>8&65280)+((q&65280)<<8)+((q&255)<<24)}function InflateState(){this.mode=0;this.last=false;this.wrap=0;this.havedict=
false;this.flags=0;this.dmax=0;this.check=0;this.total=0;this.head=null;this.wbits=0;this.wsize=0;this.whave=0;this.wnext=0;this.window=null;this.hold=0;this.bits=0;this.length=0;this.offset=0;this.extra=0;this.lencode=null;this.distcode=null;this.lenbits=0;this.distbits=0;this.ncode=0;this.nlen=0;this.ndist=0;this.have=0;this.next=null;this.lens=new utils.Buf16(320);this.work=new utils.Buf16(288);this.lendyn=null;this.distdyn=null;this.sane=0;this.back=0;this.was=0}function inflateResetKeep(strm){var state;
if(!strm||!strm.state)return Z_STREAM_ERROR;state=strm.state;strm.total_in=strm.total_out=state.total=0;strm.msg="";if(state.wrap)strm.adler=state.wrap&1;state.mode=HEAD;state.last=0;state.havedict=0;state.dmax=32768;state.head=null;state.hold=0;state.bits=0;state.lencode=state.lendyn=new utils.Buf32(ENOUGH_LENS);state.distcode=state.distdyn=new utils.Buf32(ENOUGH_DISTS);state.sane=1;state.back=-1;return Z_OK}function inflateReset(strm){var state;if(!strm||!strm.state)return Z_STREAM_ERROR;state=
strm.state;state.wsize=0;state.whave=0;state.wnext=0;return inflateResetKeep(strm)}function inflateReset2(strm,windowBits){var wrap;var state;if(!strm||!strm.state)return Z_STREAM_ERROR;state=strm.state;if(windowBits<0){wrap=0;windowBits=-windowBits}else{wrap=(windowBits>>4)+1;if(windowBits<48)windowBits&=15}if(windowBits&&(windowBits<8||windowBits>15))return Z_STREAM_ERROR;if(state.window!==null&&state.wbits!==windowBits)state.window=null;state.wrap=wrap;state.wbits=windowBits;return inflateReset(strm)}
function inflateInit2(strm,windowBits){var ret;var state;if(!strm)return Z_STREAM_ERROR;state=new InflateState;strm.state=state;state.window=null;ret=inflateReset2(strm,windowBits);if(ret!==Z_OK)strm.state=null;return ret}function inflateInit(strm){return inflateInit2(strm,DEF_WBITS)}var virgin=true;var lenfix,distfix;function fixedtables(state){if(virgin){var sym;lenfix=new utils.Buf32(512);distfix=new utils.Buf32(32);sym=0;while(sym<144)state.lens[sym++]=8;while(sym<256)state.lens[sym++]=9;while(sym<
280)state.lens[sym++]=7;while(sym<288)state.lens[sym++]=8;inflate_table(LENS,state.lens,0,288,lenfix,0,state.work,{bits:9});sym=0;while(sym<32)state.lens[sym++]=5;inflate_table(DISTS,state.lens,0,32,distfix,0,state.work,{bits:5});virgin=false}state.lencode=lenfix;state.lenbits=9;state.distcode=distfix;state.distbits=5}function updatewindow(strm,src,end,copy){var dist;var state=strm.state;if(state.window===null){state.wsize=1<<state.wbits;state.wnext=0;state.whave=0;state.window=new utils.Buf8(state.wsize)}if(copy>=
state.wsize){utils.arraySet(state.window,src,end-state.wsize,state.wsize,0);state.wnext=0;state.whave=state.wsize}else{dist=state.wsize-state.wnext;if(dist>copy)dist=copy;utils.arraySet(state.window,src,end-copy,dist,state.wnext);copy-=dist;if(copy){utils.arraySet(state.window,src,end-copy,copy,0);state.wnext=copy;state.whave=state.wsize}else{state.wnext+=dist;if(state.wnext===state.wsize)state.wnext=0;if(state.whave<state.wsize)state.whave+=dist}}return 0}function inflate(strm,flush){var state;var input,
output;var next;var put;var have,left;var hold;var bits;var _in,_out;var copy;var from;var from_source;var here=0;var here_bits,here_op,here_val;var last_bits,last_op,last_val;var len;var ret;var hbuf=new utils.Buf8(4);var opts;var n;var order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!strm||!strm.state||!strm.output||!strm.input&&strm.avail_in!==0)return Z_STREAM_ERROR;state=strm.state;if(state.mode===TYPE)state.mode=TYPEDO;put=strm.next_out;output=strm.output;left=strm.avail_out;next=
strm.next_in;input=strm.input;have=strm.avail_in;hold=state.hold;bits=state.bits;_in=have;_out=left;ret=Z_OK;inf_leave:for(;;)switch(state.mode){case HEAD:if(state.wrap===0){state.mode=TYPEDO;break}while(bits<16){if(have===0)break inf_leave;have--;hold+=input[next++]<<bits;bits+=8}if(state.wrap&2&&hold===35615){state.check=0;hbuf[0]=hold&255;hbuf[1]=hold>>>8&255;state.check=crc32(state.check,hbuf,2,0);hold=0;bits=0;state.mode=FLAGS;break}state.flags=0;if(state.head)state.head.done=false;if(!(state.wrap&
1)||(((hold&255)<<8)+(hold>>8))%31){strm.msg="incorrect header check";state.mode=BAD;break}if((hold&15)!==Z_DEFLATED){strm.msg="unknown compression method";state.mode=BAD;break}hold>>>=4;bits-=4;len=(hold&15)+8;if(state.wbits===0)state.wbits=len;else if(len>state.wbits){strm.msg="invalid window size";state.mode=BAD;break}state.dmax=1<<len;strm.adler=state.check=1;state.mode=hold&512?DICTID:TYPE;hold=0;bits=0;break;case FLAGS:while(bits<16){if(have===0)break inf_leave;have--;hold+=input[next++]<<bits;
bits+=8}state.flags=hold;if((state.flags&255)!==Z_DEFLATED){strm.msg="unknown compression method";state.mode=BAD;break}if(state.flags&57344){strm.msg="unknown header flags set";state.mode=BAD;break}if(state.head)state.head.text=hold>>8&1;if(state.flags&512){hbuf[0]=hold&255;hbuf[1]=hold>>>8&255;state.check=crc32(state.check,hbuf,2,0)}hold=0;bits=0;state.mode=TIME;case TIME:while(bits<32){if(have===0)break inf_leave;have--;hold+=input[next++]<<bits;bits+=8}if(state.head)state.head.time=hold;if(state.flags&
512){hbuf[0]=hold&255;hbuf[1]=hold>>>8&255;hbuf[2]=hold>>>16&255;hbuf[3]=hold>>>24&255;state.check=crc32(state.check,hbuf,4,0)}hold=0;bits=0;state.mode=OS;case OS:while(bits<16){if(have===0)break inf_leave;have--;hold+=input[next++]<<bits;bits+=8}if(state.head){state.head.xflags=hold&255;state.head.os=hold>>8}if(state.flags&512){hbuf[0]=hold&255;hbuf[1]=hold>>>8&255;state.check=crc32(state.check,hbuf,2,0)}hold=0;bits=0;state.mode=EXLEN;case EXLEN:if(state.flags&1024){while(bits<16){if(have===0)break inf_leave;
have--;hold+=input[next++]<<bits;bits+=8}state.length=hold;if(state.head)state.head.extra_len=hold;if(state.flags&512){hbuf[0]=hold&255;hbuf[1]=hold>>>8&255;state.check=crc32(state.check,hbuf,2,0)}hold=0;bits=0}else if(state.head)state.head.extra=null;state.mode=EXTRA;case EXTRA:if(state.flags&1024){copy=state.length;if(copy>have)copy=have;if(copy){if(state.head){len=state.head.extra_len-state.length;if(!state.head.extra)state.head.extra=new Array(state.head.extra_len);utils.arraySet(state.head.extra,
input,next,copy,len)}if(state.flags&512)state.check=crc32(state.check,input,copy,next);have-=copy;next+=copy;state.length-=copy}if(state.length)break inf_leave}state.length=0;state.mode=NAME;case NAME:if(state.flags&2048){if(have===0)break inf_leave;copy=0;do{len=input[next+copy++];if(state.head&&len&&state.length<65536)state.head.name+=String.fromCharCode(len)}while(len&&copy<have);if(state.flags&512)state.check=crc32(state.check,input,copy,next);have-=copy;next+=copy;if(len)break inf_leave}else if(state.head)state.head.name=
null;state.length=0;state.mode=COMMENT;case COMMENT:if(state.flags&4096){if(have===0)break inf_leave;copy=0;do{len=input[next+copy++];if(state.head&&len&&state.length<65536)state.head.comment+=String.fromCharCode(len)}while(len&&copy<have);if(state.flags&512)state.check=crc32(state.check,input,copy,next);have-=copy;next+=copy;if(len)break inf_leave}else if(state.head)state.head.comment=null;state.mode=HCRC;case HCRC:if(state.flags&512){while(bits<16){if(have===0)break inf_leave;have--;hold+=input[next++]<<
bits;bits+=8}if(hold!==(state.check&65535)){strm.msg="header crc mismatch";state.mode=BAD;break}hold=0;bits=0}if(state.head){state.head.hcrc=state.flags>>9&1;state.head.done=true}strm.adler=state.check=0;state.mode=TYPE;break;case DICTID:while(bits<32){if(have===0)break inf_leave;have--;hold+=input[next++]<<bits;bits+=8}strm.adler=state.check=ZSWAP32(hold);hold=0;bits=0;state.mode=DICT;case DICT:if(state.havedict===0){strm.next_out=put;strm.avail_out=left;strm.next_in=next;strm.avail_in=have;state.hold=
hold;state.bits=bits;return Z_NEED_DICT}strm.adler=state.check=1;state.mode=TYPE;case TYPE:if(flush===Z_BLOCK||flush===Z_TREES)break inf_leave;case TYPEDO:if(state.last){hold>>>=bits&7;bits-=bits&7;state.mode=CHECK;break}while(bits<3){if(have===0)break inf_leave;have--;hold+=input[next++]<<bits;bits+=8}state.last=hold&1;hold>>>=1;bits-=1;switch(hold&3){case 0:state.mode=STORED;break;case 1:fixedtables(state);state.mode=LEN_;if(flush===Z_TREES){hold>>>=2;bits-=2;break inf_leave}break;case 2:state.mode=
TABLE;break;case 3:strm.msg="invalid block type";state.mode=BAD}hold>>>=2;bits-=2;break;case STORED:hold>>>=bits&7;bits-=bits&7;while(bits<32){if(have===0)break inf_leave;have--;hold+=input[next++]<<bits;bits+=8}if((hold&65535)!==(hold>>>16^65535)){strm.msg="invalid stored block lengths";state.mode=BAD;break}state.length=hold&65535;hold=0;bits=0;state.mode=COPY_;if(flush===Z_TREES)break inf_leave;case COPY_:state.mode=COPY;case COPY:copy=state.length;if(copy){if(copy>have)copy=have;if(copy>left)copy=
left;if(copy===0)break inf_leave;utils.arraySet(output,input,next,copy,put);have-=copy;next+=copy;left-=copy;put+=copy;state.length-=copy;break}state.mode=TYPE;break;case TABLE:while(bits<14){if(have===0)break inf_leave;have--;hold+=input[next++]<<bits;bits+=8}state.nlen=(hold&31)+257;hold>>>=5;bits-=5;state.ndist=(hold&31)+1;hold>>>=5;bits-=5;state.ncode=(hold&15)+4;hold>>>=4;bits-=4;if(state.nlen>286||state.ndist>30){strm.msg="too many length or distance symbols";state.mode=BAD;break}state.have=
0;state.mode=LENLENS;case LENLENS:while(state.have<state.ncode){while(bits<3){if(have===0)break inf_leave;have--;hold+=input[next++]<<bits;bits+=8}state.lens[order[state.have++]]=hold&7;hold>>>=3;bits-=3}while(state.have<19)state.lens[order[state.have++]]=0;state.lencode=state.lendyn;state.lenbits=7;opts={bits:state.lenbits};ret=inflate_table(CODES,state.lens,0,19,state.lencode,0,state.work,opts);state.lenbits=opts.bits;if(ret){strm.msg="invalid code lengths set";state.mode=BAD;break}state.have=0;
state.mode=CODELENS;case CODELENS:while(state.have<state.nlen+state.ndist){for(;;){here=state.lencode[hold&(1<<state.lenbits)-1];here_bits=here>>>24;here_op=here>>>16&255;here_val=here&65535;if(here_bits<=bits)break;if(have===0)break inf_leave;have--;hold+=input[next++]<<bits;bits+=8}if(here_val<16){hold>>>=here_bits;bits-=here_bits;state.lens[state.have++]=here_val}else{if(here_val===16){n=here_bits+2;while(bits<n){if(have===0)break inf_leave;have--;hold+=input[next++]<<bits;bits+=8}hold>>>=here_bits;
bits-=here_bits;if(state.have===0){strm.msg="invalid bit length repeat";state.mode=BAD;break}len=state.lens[state.have-1];copy=3+(hold&3);hold>>>=2;bits-=2}else if(here_val===17){n=here_bits+3;while(bits<n){if(have===0)break inf_leave;have--;hold+=input[next++]<<bits;bits+=8}hold>>>=here_bits;bits-=here_bits;len=0;copy=3+(hold&7);hold>>>=3;bits-=3}else{n=here_bits+7;while(bits<n){if(have===0)break inf_leave;have--;hold+=input[next++]<<bits;bits+=8}hold>>>=here_bits;bits-=here_bits;len=0;copy=11+(hold&
127);hold>>>=7;bits-=7}if(state.have+copy>state.nlen+state.ndist){strm.msg="invalid bit length repeat";state.mode=BAD;break}while(copy--)state.lens[state.have++]=len}}if(state.mode===BAD)break;if(state.lens[256]===0){strm.msg="invalid code -- missing end-of-block";state.mode=BAD;break}state.lenbits=9;opts={bits:state.lenbits};ret=inflate_table(LENS,state.lens,0,state.nlen,state.lencode,0,state.work,opts);state.lenbits=opts.bits;if(ret){strm.msg="invalid literal/lengths set";state.mode=BAD;break}state.distbits=
6;state.distcode=state.distdyn;opts={bits:state.distbits};ret=inflate_table(DISTS,state.lens,state.nlen,state.ndist,state.distcode,0,state.work,opts);state.distbits=opts.bits;if(ret){strm.msg="invalid distances set";state.mode=BAD;break}state.mode=LEN_;if(flush===Z_TREES)break inf_leave;case LEN_:state.mode=LEN;case LEN:if(have>=6&&left>=258){strm.next_out=put;strm.avail_out=left;strm.next_in=next;strm.avail_in=have;state.hold=hold;state.bits=bits;inflate_fast(strm,_out);put=strm.next_out;output=
strm.output;left=strm.avail_out;next=strm.next_in;input=strm.input;have=strm.avail_in;hold=state.hold;bits=state.bits;if(state.mode===TYPE)state.back=-1;break}state.back=0;for(;;){here=state.lencode[hold&(1<<state.lenbits)-1];here_bits=here>>>24;here_op=here>>>16&255;here_val=here&65535;if(here_bits<=bits)break;if(have===0)break inf_leave;have--;hold+=input[next++]<<bits;bits+=8}if(here_op&&(here_op&240)===0){last_bits=here_bits;last_op=here_op;last_val=here_val;for(;;){here=state.lencode[last_val+
((hold&(1<<last_bits+last_op)-1)>>last_bits)];here_bits=here>>>24;here_op=here>>>16&255;here_val=here&65535;if(last_bits+here_bits<=bits)break;if(have===0)break inf_leave;have--;hold+=input[next++]<<bits;bits+=8}hold>>>=last_bits;bits-=last_bits;state.back+=last_bits}hold>>>=here_bits;bits-=here_bits;state.back+=here_bits;state.length=here_val;if(here_op===0){state.mode=LIT;break}if(here_op&32){state.back=-1;state.mode=TYPE;break}if(here_op&64){strm.msg="invalid literal/length code";state.mode=BAD;
break}state.extra=here_op&15;state.mode=LENEXT;case LENEXT:if(state.extra){n=state.extra;while(bits<n){if(have===0)break inf_leave;have--;hold+=input[next++]<<bits;bits+=8}state.length+=hold&(1<<state.extra)-1;hold>>>=state.extra;bits-=state.extra;state.back+=state.extra}state.was=state.length;state.mode=DIST;case DIST:for(;;){here=state.distcode[hold&(1<<state.distbits)-1];here_bits=here>>>24;here_op=here>>>16&255;here_val=here&65535;if(here_bits<=bits)break;if(have===0)break inf_leave;have--;hold+=
input[next++]<<bits;bits+=8}if((here_op&240)===0){last_bits=here_bits;last_op=here_op;last_val=here_val;for(;;){here=state.distcode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)];here_bits=here>>>24;here_op=here>>>16&255;here_val=here&65535;if(last_bits+here_bits<=bits)break;if(have===0)break inf_leave;have--;hold+=input[next++]<<bits;bits+=8}hold>>>=last_bits;bits-=last_bits;state.back+=last_bits}hold>>>=here_bits;bits-=here_bits;state.back+=here_bits;if(here_op&64){strm.msg="invalid distance code";
state.mode=BAD;break}state.offset=here_val;state.extra=here_op&15;state.mode=DISTEXT;case DISTEXT:if(state.extra){n=state.extra;while(bits<n){if(have===0)break inf_leave;have--;hold+=input[next++]<<bits;bits+=8}state.offset+=hold&(1<<state.extra)-1;hold>>>=state.extra;bits-=state.extra;state.back+=state.extra}if(state.offset>state.dmax){strm.msg="invalid distance too far back";state.mode=BAD;break}state.mode=MATCH;case MATCH:if(left===0)break inf_leave;copy=_out-left;if(state.offset>copy){copy=state.offset-
copy;if(copy>state.whave)if(state.sane){strm.msg="invalid distance too far back";state.mode=BAD;break}if(copy>state.wnext){copy-=state.wnext;from=state.wsize-copy}else from=state.wnext-copy;if(copy>state.length)copy=state.length;from_source=state.window}else{from_source=output;from=put-state.offset;copy=state.length}if(copy>left)copy=left;left-=copy;state.length-=copy;do output[put++]=from_source[from++];while(--copy);if(state.length===0)state.mode=LEN;break;case LIT:if(left===0)break inf_leave;output[put++]=
state.length;left--;state.mode=LEN;break;case CHECK:if(state.wrap){while(bits<32){if(have===0)break inf_leave;have--;hold|=input[next++]<<bits;bits+=8}_out-=left;strm.total_out+=_out;state.total+=_out;if(_out)strm.adler=state.check=state.flags?crc32(state.check,output,_out,put-_out):adler32(state.check,output,_out,put-_out);_out=left;if((state.flags?hold:ZSWAP32(hold))!==state.check){strm.msg="incorrect data check";state.mode=BAD;break}hold=0;bits=0}state.mode=LENGTH;case LENGTH:if(state.wrap&&state.flags){while(bits<
32){if(have===0)break inf_leave;have--;hold+=input[next++]<<bits;bits+=8}if(hold!==(state.total&4294967295)){strm.msg="incorrect length check";state.mode=BAD;break}hold=0;bits=0}state.mode=DONE;case DONE:ret=Z_STREAM_END;break inf_leave;case BAD:ret=Z_DATA_ERROR;break inf_leave;case MEM:return Z_MEM_ERROR;case SYNC:default:return Z_STREAM_ERROR}strm.next_out=put;strm.avail_out=left;strm.next_in=next;strm.avail_in=have;state.hold=hold;state.bits=bits;if(state.wsize||_out!==strm.avail_out&&state.mode<
BAD&&(state.mode<CHECK||flush!==Z_FINISH))if(updatewindow(strm,strm.output,strm.next_out,_out-strm.avail_out)){state.mode=MEM;return Z_MEM_ERROR}_in-=strm.avail_in;_out-=strm.avail_out;strm.total_in+=_in;strm.total_out+=_out;state.total+=_out;if(state.wrap&&_out)strm.adler=state.check=state.flags?crc32(state.check,output,_out,strm.next_out-_out):adler32(state.check,output,_out,strm.next_out-_out);strm.data_type=state.bits+(state.last?64:0)+(state.mode===TYPE?128:0)+(state.mode===LEN_||state.mode===
COPY_?256:0);if((_in===0&&_out===0||flush===Z_FINISH)&&ret===Z_OK)ret=Z_BUF_ERROR;return ret}function inflateEnd(strm){if(!strm||!strm.state)return Z_STREAM_ERROR;var state=strm.state;if(state.window)state.window=null;strm.state=null;return Z_OK}function inflateGetHeader(strm,head){var state;if(!strm||!strm.state)return Z_STREAM_ERROR;state=strm.state;if((state.wrap&2)===0)return Z_STREAM_ERROR;state.head=head;head.done=false;return Z_OK}exports.inflateReset=inflateReset;exports.inflateReset2=inflateReset2;
exports.inflateResetKeep=inflateResetKeep;exports.inflateInit=inflateInit;exports.inflateInit2=inflateInit2;exports.inflate=inflate;exports.inflateEnd=inflateEnd;exports.inflateGetHeader=inflateGetHeader;exports.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./inffast":34,"./inftrees":36}],36:[function(_dereq_,module,exports){var utils=_dereq_("../utils/common");var MAXBITS=15;var ENOUGH_LENS=852;var ENOUGH_DISTS=592;var CODES=0;var LENS=1;var DISTS=
2;var lbase=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0];var lext=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78];var dbase=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0];var dext=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];module.exports=function inflate_table(type,lens,lens_index,
codes,table,table_index,work,opts){var bits=opts.bits;var len=0;var sym=0;var min=0,max=0;var root=0;var curr=0;var drop=0;var left=0;var used=0;var huff=0;var incr;var fill;var low;var mask;var next;var base=null;var base_index=0;var end;var count=new utils.Buf16(MAXBITS+1);var offs=new utils.Buf16(MAXBITS+1);var extra=null;var extra_index=0;var here_bits,here_op,here_val;for(len=0;len<=MAXBITS;len++)count[len]=0;for(sym=0;sym<codes;sym++)count[lens[lens_index+sym]]++;root=bits;for(max=MAXBITS;max>=
1;max--)if(count[max]!==0)break;if(root>max)root=max;if(max===0){table[table_index++]=1<<24|64<<16|0;table[table_index++]=1<<24|64<<16|0;opts.bits=1;return 0}for(min=1;min<max;min++)if(count[min]!==0)break;if(root<min)root=min;left=1;for(len=1;len<=MAXBITS;len++){left<<=1;left-=count[len];if(left<0)return-1}if(left>0&&(type===CODES||max!==1))return-1;offs[1]=0;for(len=1;len<MAXBITS;len++)offs[len+1]=offs[len]+count[len];for(sym=0;sym<codes;sym++)if(lens[lens_index+sym]!==0)work[offs[lens[lens_index+
sym]]++]=sym;if(type===CODES){base=extra=work;end=19}else if(type===LENS){base=lbase;base_index-=257;extra=lext;extra_index-=257;end=256}else{base=dbase;extra=dext;end=-1}huff=0;sym=0;len=min;next=table_index;curr=root;drop=0;low=-1;used=1<<root;mask=used-1;if(type===LENS&&used>ENOUGH_LENS||type===DISTS&&used>ENOUGH_DISTS)return 1;var i=0;for(;;){i++;here_bits=len-drop;if(work[sym]<end){here_op=0;here_val=work[sym]}else if(work[sym]>end){here_op=extra[extra_index+work[sym]];here_val=base[base_index+
work[sym]]}else{here_op=32+64;here_val=0}incr=1<<len-drop;fill=1<<curr;min=fill;do{fill-=incr;table[next+(huff>>drop)+fill]=here_bits<<24|here_op<<16|here_val|0}while(fill!==0);incr=1<<len-1;while(huff&incr)incr>>=1;if(incr!==0){huff&=incr-1;huff+=incr}else huff=0;sym++;if(--count[len]===0){if(len===max)break;len=lens[lens_index+work[sym]]}if(len>root&&(huff&mask)!==low){if(drop===0)drop=root;next+=min;curr=len-drop;left=1<<curr;while(curr+drop<max){left-=count[curr+drop];if(left<=0)break;curr++;
left<<=1}used+=1<<curr;if(type===LENS&&used>ENOUGH_LENS||type===DISTS&&used>ENOUGH_DISTS)return 1;low=huff&mask;table[low]=root<<24|curr<<16|next-table_index|0}}if(huff!==0)table[next+huff]=len-drop<<24|64<<16|0;opts.bits=root;return 0}},{"../utils/common":27}],37:[function(_dereq_,module,exports){module.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],38:[function(_dereq_,
module,exports){var utils=_dereq_("../utils/common");var Z_FIXED=4;var Z_BINARY=0;var Z_TEXT=1;var Z_UNKNOWN=2;function zero(buf){var len=buf.length;while(--len>=0)buf[len]=0}var STORED_BLOCK=0;var STATIC_TREES=1;var DYN_TREES=2;var MIN_MATCH=3;var MAX_MATCH=258;var LENGTH_CODES=29;var LITERALS=256;var L_CODES=LITERALS+1+LENGTH_CODES;var D_CODES=30;var BL_CODES=19;var HEAP_SIZE=2*L_CODES+1;var MAX_BITS=15;var Buf_size=16;var MAX_BL_BITS=7;var END_BLOCK=256;var REP_3_6=16;var REPZ_3_10=17;var REPZ_11_138=
18;var extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0];var extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];var extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7];var bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var DIST_CODE_LEN=512;var static_ltree=new Array((L_CODES+2)*2);zero(static_ltree);var static_dtree=new Array(D_CODES*2);zero(static_dtree);var _dist_code=new Array(DIST_CODE_LEN);zero(_dist_code);var _length_code=new Array(MAX_MATCH-
MIN_MATCH+1);zero(_length_code);var base_length=new Array(LENGTH_CODES);zero(base_length);var base_dist=new Array(D_CODES);zero(base_dist);var StaticTreeDesc=function(static_tree,extra_bits,extra_base,elems,max_length){this.static_tree=static_tree;this.extra_bits=extra_bits;this.extra_base=extra_base;this.elems=elems;this.max_length=max_length;this.has_stree=static_tree&&static_tree.length};var static_l_desc;var static_d_desc;var static_bl_desc;var TreeDesc=function(dyn_tree,stat_desc){this.dyn_tree=
dyn_tree;this.max_code=0;this.stat_desc=stat_desc};function d_code(dist){return dist<256?_dist_code[dist]:_dist_code[256+(dist>>>7)]}function put_short(s,w){s.pending_buf[s.pending++]=w&255;s.pending_buf[s.pending++]=w>>>8&255}function send_bits(s,value,length){if(s.bi_valid>Buf_size-length){s.bi_buf|=value<<s.bi_valid&65535;put_short(s,s.bi_buf);s.bi_buf=value>>Buf_size-s.bi_valid;s.bi_valid+=length-Buf_size}else{s.bi_buf|=value<<s.bi_valid&65535;s.bi_valid+=length}}function send_code(s,c,tree){send_bits(s,
tree[c*2],tree[c*2+1])}function bi_reverse(code,len){var res=0;do{res|=code&1;code>>>=1;res<<=1}while(--len>0);return res>>>1}function bi_flush(s){if(s.bi_valid===16){put_short(s,s.bi_buf);s.bi_buf=0;s.bi_valid=0}else if(s.bi_valid>=8){s.pending_buf[s.pending++]=s.bi_buf&255;s.bi_buf>>=8;s.bi_valid-=8}}function gen_bitlen(s,desc){var tree=desc.dyn_tree;var max_code=desc.max_code;var stree=desc.stat_desc.static_tree;var has_stree=desc.stat_desc.has_stree;var extra=desc.stat_desc.extra_bits;var base=
desc.stat_desc.extra_base;var max_length=desc.stat_desc.max_length;var h;var n,m;var bits;var xbits;var f;var overflow=0;for(bits=0;bits<=MAX_BITS;bits++)s.bl_count[bits]=0;tree[s.heap[s.heap_max]*2+1]=0;for(h=s.heap_max+1;h<HEAP_SIZE;h++){n=s.heap[h];bits=tree[tree[n*2+1]*2+1]+1;if(bits>max_length){bits=max_length;overflow++}tree[n*2+1]=bits;if(n>max_code)continue;s.bl_count[bits]++;xbits=0;if(n>=base)xbits=extra[n-base];f=tree[n*2];s.opt_len+=f*(bits+xbits);if(has_stree)s.static_len+=f*(stree[n*
2+1]+xbits)}if(overflow===0)return;do{bits=max_length-1;while(s.bl_count[bits]===0)bits--;s.bl_count[bits]--;s.bl_count[bits+1]+=2;s.bl_count[max_length]--;overflow-=2}while(overflow>0);for(bits=max_length;bits!==0;bits--){n=s.bl_count[bits];while(n!==0){m=s.heap[--h];if(m>max_code)continue;if(tree[m*2+1]!==bits){s.opt_len+=(bits-tree[m*2+1])*tree[m*2];tree[m*2+1]=bits}n--}}}function gen_codes(tree,max_code,bl_count){var next_code=new Array(MAX_BITS+1);var code=0;var bits;var n;for(bits=1;bits<=MAX_BITS;bits++)next_code[bits]=
code=code+bl_count[bits-1]<<1;for(n=0;n<=max_code;n++){var len=tree[n*2+1];if(len===0)continue;tree[n*2]=bi_reverse(next_code[len]++,len)}}function tr_static_init(){var n;var bits;var length;var code;var dist;var bl_count=new Array(MAX_BITS+1);length=0;for(code=0;code<LENGTH_CODES-1;code++){base_length[code]=length;for(n=0;n<1<<extra_lbits[code];n++)_length_code[length++]=code}_length_code[length-1]=code;dist=0;for(code=0;code<16;code++){base_dist[code]=dist;for(n=0;n<1<<extra_dbits[code];n++)_dist_code[dist++]=
code}dist>>=7;for(;code<D_CODES;code++){base_dist[code]=dist<<7;for(n=0;n<1<<extra_dbits[code]-7;n++)_dist_code[256+dist++]=code}for(bits=0;bits<=MAX_BITS;bits++)bl_count[bits]=0;n=0;while(n<=143){static_ltree[n*2+1]=8;n++;bl_count[8]++}while(n<=255){static_ltree[n*2+1]=9;n++;bl_count[9]++}while(n<=279){static_ltree[n*2+1]=7;n++;bl_count[7]++}while(n<=287){static_ltree[n*2+1]=8;n++;bl_count[8]++}gen_codes(static_ltree,L_CODES+1,bl_count);for(n=0;n<D_CODES;n++){static_dtree[n*2+1]=5;static_dtree[n*
2]=bi_reverse(n,5)}static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS+1,L_CODES,MAX_BITS);static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES,MAX_BITS);static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES,MAX_BL_BITS)}function init_block(s){var n;for(n=0;n<L_CODES;n++)s.dyn_ltree[n*2]=0;for(n=0;n<D_CODES;n++)s.dyn_dtree[n*2]=0;for(n=0;n<BL_CODES;n++)s.bl_tree[n*2]=0;s.dyn_ltree[END_BLOCK*2]=1;s.opt_len=s.static_len=0;s.last_lit=s.matches=0}function bi_windup(s){if(s.bi_valid>
8)put_short(s,s.bi_buf);else if(s.bi_valid>0)s.pending_buf[s.pending++]=s.bi_buf;s.bi_buf=0;s.bi_valid=0}function copy_block(s,buf,len,header){bi_windup(s);if(header){put_short(s,len);put_short(s,~len)}utils.arraySet(s.pending_buf,s.window,buf,len,s.pending);s.pending+=len}function smaller(tree,n,m,depth){var _n2=n*2;var _m2=m*2;return tree[_n2]<tree[_m2]||tree[_n2]===tree[_m2]&&depth[n]<=depth[m]}function pqdownheap(s,tree,k){var v=s.heap[k];var j=k<<1;while(j<=s.heap_len){if(j<s.heap_len&&smaller(tree,
s.heap[j+1],s.heap[j],s.depth))j++;if(smaller(tree,v,s.heap[j],s.depth))break;s.heap[k]=s.heap[j];k=j;j<<=1}s.heap[k]=v}function compress_block(s,ltree,dtree){var dist;var lc;var lx=0;var code;var extra;if(s.last_lit!==0){do{dist=s.pending_buf[s.d_buf+lx*2]<<8|s.pending_buf[s.d_buf+lx*2+1];lc=s.pending_buf[s.l_buf+lx];lx++;if(dist===0)send_code(s,lc,ltree);else{code=_length_code[lc];send_code(s,code+LITERALS+1,ltree);extra=extra_lbits[code];if(extra!==0){lc-=base_length[code];send_bits(s,lc,extra)}dist--;
code=d_code(dist);send_code(s,code,dtree);extra=extra_dbits[code];if(extra!==0){dist-=base_dist[code];send_bits(s,dist,extra)}}}while(lx<s.last_lit)}send_code(s,END_BLOCK,ltree)}function build_tree(s,desc){var tree=desc.dyn_tree;var stree=desc.stat_desc.static_tree;var has_stree=desc.stat_desc.has_stree;var elems=desc.stat_desc.elems;var n,m;var max_code=-1;var node;s.heap_len=0;s.heap_max=HEAP_SIZE;for(n=0;n<elems;n++)if(tree[n*2]!==0){s.heap[++s.heap_len]=max_code=n;s.depth[n]=0}else tree[n*2+1]=
0;while(s.heap_len<2){node=s.heap[++s.heap_len]=max_code<2?++max_code:0;tree[node*2]=1;s.depth[node]=0;s.opt_len--;if(has_stree)s.static_len-=stree[node*2+1]}desc.max_code=max_code;for(n=s.heap_len>>1;n>=1;n--)pqdownheap(s,tree,n);node=elems;do{n=s.heap[1];s.heap[1]=s.heap[s.heap_len--];pqdownheap(s,tree,1);m=s.heap[1];s.heap[--s.heap_max]=n;s.heap[--s.heap_max]=m;tree[node*2]=tree[n*2]+tree[m*2];s.depth[node]=(s.depth[n]>=s.depth[m]?s.depth[n]:s.depth[m])+1;tree[n*2+1]=tree[m*2+1]=node;s.heap[1]=
node++;pqdownheap(s,tree,1)}while(s.heap_len>=2);s.heap[--s.heap_max]=s.heap[1];gen_bitlen(s,desc);gen_codes(tree,max_code,s.bl_count)}function scan_tree(s,tree,max_code){var n;var prevlen=-1;var curlen;var nextlen=tree[0*2+1];var count=0;var max_count=7;var min_count=4;if(nextlen===0){max_count=138;min_count=3}tree[(max_code+1)*2+1]=65535;for(n=0;n<=max_code;n++){curlen=nextlen;nextlen=tree[(n+1)*2+1];if(++count<max_count&&curlen===nextlen)continue;else if(count<min_count)s.bl_tree[curlen*2]+=count;
else if(curlen!==0){if(curlen!==prevlen)s.bl_tree[curlen*2]++;s.bl_tree[REP_3_6*2]++}else if(count<=10)s.bl_tree[REPZ_3_10*2]++;else s.bl_tree[REPZ_11_138*2]++;count=0;prevlen=curlen;if(nextlen===0){max_count=138;min_count=3}else if(curlen===nextlen){max_count=6;min_count=3}else{max_count=7;min_count=4}}}function send_tree(s,tree,max_code){var n;var prevlen=-1;var curlen;var nextlen=tree[0*2+1];var count=0;var max_count=7;var min_count=4;if(nextlen===0){max_count=138;min_count=3}for(n=0;n<=max_code;n++){curlen=
nextlen;nextlen=tree[(n+1)*2+1];if(++count<max_count&&curlen===nextlen)continue;else if(count<min_count){do send_code(s,curlen,s.bl_tree);while(--count!==0)}else if(curlen!==0){if(curlen!==prevlen){send_code(s,curlen,s.bl_tree);count--}send_code(s,REP_3_6,s.bl_tree);send_bits(s,count-3,2)}else if(count<=10){send_code(s,REPZ_3_10,s.bl_tree);send_bits(s,count-3,3)}else{send_code(s,REPZ_11_138,s.bl_tree);send_bits(s,count-11,7)}count=0;prevlen=curlen;if(nextlen===0){max_count=138;min_count=3}else if(curlen===
nextlen){max_count=6;min_count=3}else{max_count=7;min_count=4}}}function build_bl_tree(s){var max_blindex;scan_tree(s,s.dyn_ltree,s.l_desc.max_code);scan_tree(s,s.dyn_dtree,s.d_desc.max_code);build_tree(s,s.bl_desc);for(max_blindex=BL_CODES-1;max_blindex>=3;max_blindex--)if(s.bl_tree[bl_order[max_blindex]*2+1]!==0)break;s.opt_len+=3*(max_blindex+1)+5+5+4;return max_blindex}function send_all_trees(s,lcodes,dcodes,blcodes){var rank;send_bits(s,lcodes-257,5);send_bits(s,dcodes-1,5);send_bits(s,blcodes-
4,4);for(rank=0;rank<blcodes;rank++)send_bits(s,s.bl_tree[bl_order[rank]*2+1],3);send_tree(s,s.dyn_ltree,lcodes-1);send_tree(s,s.dyn_dtree,dcodes-1)}function detect_data_type(s){var black_mask=4093624447;var n;for(n=0;n<=31;n++,black_mask>>>=1)if(black_mask&1&&s.dyn_ltree[n*2]!==0)return Z_BINARY;if(s.dyn_ltree[9*2]!==0||s.dyn_ltree[10*2]!==0||s.dyn_ltree[13*2]!==0)return Z_TEXT;for(n=32;n<LITERALS;n++)if(s.dyn_ltree[n*2]!==0)return Z_TEXT;return Z_BINARY}var static_init_done=false;function _tr_init(s){if(!static_init_done){tr_static_init();
static_init_done=true}s.l_desc=new TreeDesc(s.dyn_ltree,static_l_desc);s.d_desc=new TreeDesc(s.dyn_dtree,static_d_desc);s.bl_desc=new TreeDesc(s.bl_tree,static_bl_desc);s.bi_buf=0;s.bi_valid=0;init_block(s)}function _tr_stored_block(s,buf,stored_len,last){send_bits(s,(STORED_BLOCK<<1)+(last?1:0),3);copy_block(s,buf,stored_len,true)}function _tr_align(s){send_bits(s,STATIC_TREES<<1,3);send_code(s,END_BLOCK,static_ltree);bi_flush(s)}function _tr_flush_block(s,buf,stored_len,last){var opt_lenb,static_lenb;
var max_blindex=0;if(s.level>0){if(s.strm.data_type===Z_UNKNOWN)s.strm.data_type=detect_data_type(s);build_tree(s,s.l_desc);build_tree(s,s.d_desc);max_blindex=build_bl_tree(s);opt_lenb=s.opt_len+3+7>>>3;static_lenb=s.static_len+3+7>>>3;if(static_lenb<=opt_lenb)opt_lenb=static_lenb}else opt_lenb=static_lenb=stored_len+5;if(stored_len+4<=opt_lenb&&buf!==-1)_tr_stored_block(s,buf,stored_len,last);else if(s.strategy===Z_FIXED||static_lenb===opt_lenb){send_bits(s,(STATIC_TREES<<1)+(last?1:0),3);compress_block(s,
static_ltree,static_dtree)}else{send_bits(s,(DYN_TREES<<1)+(last?1:0),3);send_all_trees(s,s.l_desc.max_code+1,s.d_desc.max_code+1,max_blindex+1);compress_block(s,s.dyn_ltree,s.dyn_dtree)}init_block(s);if(last)bi_windup(s)}function _tr_tally(s,dist,lc){s.pending_buf[s.d_buf+s.last_lit*2]=dist>>>8&255;s.pending_buf[s.d_buf+s.last_lit*2+1]=dist&255;s.pending_buf[s.l_buf+s.last_lit]=lc&255;s.last_lit++;if(dist===0)s.dyn_ltree[lc*2]++;else{s.matches++;dist--;s.dyn_ltree[(_length_code[lc]+LITERALS+1)*2]++;
s.dyn_dtree[d_code(dist)*2]++}return s.last_lit===s.lit_bufsize-1}exports._tr_init=_tr_init;exports._tr_stored_block=_tr_stored_block;exports._tr_flush_block=_tr_flush_block;exports._tr_tally=_tr_tally;exports._tr_align=_tr_align},{"../utils/common":27}],39:[function(_dereq_,module,exports){function ZStream(){this.input=null;this.next_in=0;this.avail_in=0;this.total_in=0;this.output=null;this.next_out=0;this.avail_out=0;this.total_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}module.exports=
ZStream},{}]},{},[9])(9)});
